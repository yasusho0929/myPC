<!DOCTYPE html>
<!-- saved from url=(0163)https://zenn.dev/yamato_snow/articles/00e11d435247b3#1.-%E3%82%B9%E3%82%AF%E3%83%AC%E3%82%A4%E3%83%94%E3%83%B3%E3%82%B0%E5%87%A6%E7%90%86%EF%BC%88suumo.py%EF%BC%89 -->
<html lang="ja" data-theme="light"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta content="width=device-width, initial-scale=1" name="viewport" data-next-head=""><script type="text/javascript" async="" src="./HowToscraping_files/destination" nonce=""></script><script type="text/javascript" async="" src="./HowToscraping_files/js" nonce=""></script><script type="text/javascript" async="" src="./HowToscraping_files/js(1)" nonce=""></script><script async="" src="./HowToscraping_files/gtm.js"></script><script async="" src="./HowToscraping_files/js(2)" nonce=""></script><title data-next-head="">Python + Flask + Selenium で作る SUUMO 物件情報スクレイピングツール</title><link rel="canonical" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3" data-next-head=""><meta name="twitter:card" content="summary_large_image" data-next-head=""><meta property="og:url" content="https://zenn.dev/yamato_snow/articles/00e11d435247b3" data-next-head=""><meta property="og:title" content="Python + Flask + Selenium で作る SUUMO 物件情報スクレイピングツール" data-next-head=""><meta property="og:image" content="https://res.cloudinary.com/zenn/image/upload/s--TSDv_w0w--/c_fit%2Cg_north_west%2Cl_text:notosansjp-medium.otf_55:Python%2520%252B%2520Flask%2520%252B%2520Selenium%2520%25E3%2581%25A7%25E4%25BD%259C%25E3%2582%258B%2520SUUMO%2520%25E7%2589%25A9%25E4%25BB%25B6%25E6%2583%2585%25E5%25A0%25B1%25E3%2582%25B9%25E3%2582%25AF%25E3%2583%25AC%25E3%2582%25A4%25E3%2583%2594%25E3%2583%25B3%25E3%2582%25B0%25E3%2583%2584%25E3%2583%25BC%25E3%2583%25AB%2Cw_1010%2Cx_90%2Cy_100/g_south_west%2Cl_text:notosansjp-medium.otf_37:%25E3%2582%2584%25E3%2581%25BE%25E3%2581%25A8%2Cx_203%2Cy_121/g_south_west%2Ch_90%2Cl_fetch:aHR0cHM6Ly9zdG9yYWdlLmdvb2dsZWFwaXMuY29tL3plbm4tdXNlci11cGxvYWQvYXZhdGFyL2UxMTY0YzRhNDUuanBlZw==%2Cr_max%2Cw_90%2Cx_87%2Cy_95/v1627283836/default/og-base-w1200-v2.png?_a=BACAGSGT" data-next-head=""><meta property="og:type" content="article" data-next-head=""><meta property="og:site_name" content="Zenn" data-next-head=""><meta content="https://storage.googleapis.com/zenn-user-upload/avatar/e1164c4a45.jpeg" name="zenn:image" data-next-head=""><meta content="やまとさんによる記事" name="zenn:description" data-next-head=""><meta content="Zenn" name="apple-mobile-web-app-title"><link href="https://zenn.dev/manifest.json" rel="manifest"><link href="https://static.zenn.studio/images/logo-transparent.png" rel="shortcut icon" type="image/png"><link href="https://static.zenn.studio/images/icon.png" rel="apple-touch-icon-precomposed" type="image/png"><link nonce="" rel="preload" href="./HowToscraping_files/91e01b41aaaac2d2.css" as="style"><link nonce="" rel="preload" href="./HowToscraping_files/97f15a0f8ffd0b81.css" as="style"><link nonce="" rel="preload" href="./HowToscraping_files/a8f93302c6b31b42.css" as="style"><link nonce="" rel="preload" href="./HowToscraping_files/73149e3adcac36b7.css" as="style"><script nonce="">function getSystemTheme() {
          if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            return 'dark-blue';
          }
          return 'light';
        }
        
        function applyTheme(theme) {
          let actualTheme;
          if (theme === 'system') {
            actualTheme = getSystemTheme();
          } else {
            actualTheme = theme;
          }
          window.document.documentElement.dataset.theme = actualTheme;
        }
        
        const storedTheme = localStorage.getItem('theme');
        const theme = storedTheme || 'system';
        applyTheme(theme);
        
        // システムテーマの変更を監視
        if (window.matchMedia) {
          window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', function() {
            const currentTheme = localStorage.getItem('theme') || 'system';
            if (currentTheme === 'system') {
              applyTheme('system');
            }
          });
        }</script><script nonce="">var newDataLayer = {};

        // display_modeを追加
        if (window.matchMedia('(display-mode: standalone)').matches) {
          newDataLayer.display_mode = 'standalone'; // PWA
        } else if (window.navigator.standalone === true) {
          newDataLayer.display_mode = 'standalone'; // PWA on iOS Safari
        } else {
          newDataLayer.display_mode = 'browser'; // Web
        }

        // user_idを追加
        // ページ初期化時に取得したいため、ローカルストレージからcachedUser.idを取得する
        var zennCurrentUserValue = localStorage.getItem('zenn_current_user');
        if (zennCurrentUserValue) {
          try {
            var currentUser = JSON.parse(zennCurrentUserValue);
            if (currentUser.cachedUser) {
              newDataLayer.user_id = currentUser.cachedUser.id;
            }
          } catch {}
        }

        window.dataLayer = window.dataLayer || [];
        window.dataLayer.push(newDataLayer);</script><script nonce="">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-K42DRM8');</script><script nonce="">window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());</script><script src="./HowToscraping_files/listen-embed-event.js" nonce=""></script><style nonce="">
            @font-face {
              font-family: 'Inter';
              font-weight: 600;
              font-display: swap;
              src: local(''), url('https://static.zenn.studio/fonts/inter-v3-latin-600.woff2') format('woff2');
            }
            @font-face {
              font-family: 'Inter';
              font-weight: 700;
              font-display: swap;
              src: local(''), url('https://static.zenn.studio/fonts/inter-v3-latin-700.woff2') format('woff2');
            }</style><link nonce="" rel="stylesheet" href="./HowToscraping_files/91e01b41aaaac2d2.css" data-n-g=""><link nonce="" rel="stylesheet" href="./HowToscraping_files/97f15a0f8ffd0b81.css" data-n-p=""><link nonce="" rel="stylesheet" href="./HowToscraping_files/a8f93302c6b31b42.css" data-n-p=""><link nonce="" rel="stylesheet" href="./HowToscraping_files/73149e3adcac36b7.css"><noscript data-n-css="C2GsIhtN7Ngpg2u4ImWNdZ7uxEccGESIVOUsjJUFDD4="></noscript><script defer="" nonce="" nomodule="" src="./HowToscraping_files/polyfills-42372ed130431b0a.js"></script><script defer="" src="./HowToscraping_files/63209.0a4ea7372e1b7b15.js" nonce=""></script><script src="./HowToscraping_files/webpack-ad3a0169aaeef774.js" nonce="" defer=""></script><script src="./HowToscraping_files/framework-9b1c6026dcec1ba1.js" nonce="" defer=""></script><script src="./HowToscraping_files/main-beb28eccfe32ca10.js" nonce="" defer=""></script><script src="./HowToscraping_files/_app-b378a5808b5c1fa1.js" nonce="" defer=""></script><script src="./HowToscraping_files/31284-46619c0873a73294.js" nonce="" defer=""></script><script src="./HowToscraping_files/44016-d070f7cebaf54b46.js" nonce="" defer=""></script><script src="./HowToscraping_files/52113-e5a069f77974dcdd.js" nonce="" defer=""></script><script src="./HowToscraping_files/31715-dc90fdfd3e87c055.js" nonce="" defer=""></script><script src="./HowToscraping_files/39719-637bbcfce5b3767d.js" nonce="" defer=""></script><script src="./HowToscraping_files/41468-324b6ab3e661146a.js" nonce="" defer=""></script><script src="./HowToscraping_files/32918-bc6dfd11e6db69b2.js" nonce="" defer=""></script><script src="./HowToscraping_files/55971-578b07b2a8c6fe1a.js" nonce="" defer=""></script><script src="./HowToscraping_files/53830-079b1ffc128e459c.js" nonce="" defer=""></script><script src="./HowToscraping_files/48647-1f7cc4d140414737.js" nonce="" defer=""></script><script src="./HowToscraping_files/[slug]-8b05815618f5ee28.js" nonce="" defer=""></script><script src="./HowToscraping_files/_buildManifest.js" nonce="" defer=""></script><script src="./HowToscraping_files/_ssgManifest.js" nonce="" defer=""></script><link rel="stylesheet" type="text/css" href="./HowToscraping_files/7d0a57b66733b83e.css"><link as="script" rel="prefetch" href="./HowToscraping_files/77001-fdb71e7f2de72c30.js"><link as="script" rel="prefetch" href="./HowToscraping_files/[username]-3d574d6cf166e12c.js"><link as="script" rel="prefetch" href="./HowToscraping_files/[slug]-ab55b6f497bfd0c5.js"><link rel="stylesheet" type="text/css" href="./HowToscraping_files/4a91d78f66f6a772.css"><link rel="stylesheet" type="text/css" href="./HowToscraping_files/a6ca826131951d65.css"></head><body data-use-twemoji="true"><script nonce="">const shouldUseTwemoji = !/(googlebot|macintosh|macintel|macppc|mac68k|macos|iphone|ipad)/i.test(window.navigator.userAgent);
        if(shouldUseTwemoji) document.body.setAttribute("data-use-twemoji", "true");</script><link rel="preload" as="image" href="./HowToscraping_files/e1164c4a45.jpeg" referrerpolicy="no-referrer"><link rel="preload" as="image" href="./HowToscraping_files/discussion.png"><div id="__next"><header class="AppHeader_header__54XdE"><div class="Container_wide__ykGLh Container_common__figYY"><div class="AppHeader_inner__CJC4C"><a class="ZennLogo_logoLink__NJS2l" href="https://zenn.dev/"><svg viewBox="0 0 377.4 88.3" aria-label="Zenn | エンジニアのための情報共有コミュニティ" class="ZennLogo_logoSvg__yOhcg" height="22"><g fill="currentColor"><path d="M233 56.8h-39c.5 3.5 2.2 6.8 4.8 9.2 2.7 2.3 6.2 3.5 9.8 3.4 2.8 0 5.6-.5 8.2-1.7 2.5-1.1 4.8-2.8 6.5-5l8.2 9.5c-2.5 3.4-5.7 6.1-9.5 7.9-4.6 2.2-9.6 3.3-14.7 3.2-5.7.1-11.4-1.2-16.5-4-4.5-2.5-8.2-6.3-10.7-10.9s-3.8-9.8-3.7-15.1v-2.2c-.1-5.7 1.1-11.3 3.5-16.5 2.2-4.7 5.7-8.6 10.1-11.3 4.7-2.8 10.1-4.2 15.5-4.1 5.2-.1 10.3 1.1 14.9 3.7 4.1 2.5 7.4 6.2 9.4 10.5 2.2 5.1 3.3 10.5 3.2 16.1V56.8zM216.1 43.9c.1-2.9-.9-5.7-2.8-7.9-1.8-1.9-4.4-2.9-7.9-2.9-2.9-.1-5.8 1.1-7.7 3.2-2 2.6-3.3 5.7-3.6 9h22V43.9zM128.3 67.9h36.1v14.7h-56.9V72l35.8-54.3h-36.2V2.9h56.6v10.4L128.3 67.9zM248.8 50.7c0-19.1 12.7-29.2 28.2-29.2s27.9 10.1 27.9 29.2V82h-16V51.4c0-10.6-4.8-16.1-12-16.1s-12.4 5.5-12.4 16.1v30.7h-15.8L248.8 50.7 248.8 50.7zM320.3 50.7c0-19.1 12.7-29.2 28.2-29.2s27.9 10.1 27.9 29.2V82h-16V51.4c0-10.6-4.8-16.1-12-16.1S336 40.8 336 51.4v30.7h-15.8L320.3 50.7 320.3 50.7z"></path></g><path fill="#3EA8FF" d="M2.4 83.3h17c.9 0 1.7-.5 2.2-1.2L68.4 5.2C69 4.2 68.3 3 67.1 3H51c-.8 0-1.5.4-1.9 1.1L1.6 81.9C1.3 82.5 1.7 83.3 2.4 83.3zM61 82.1l22.1-35.5c.7-1.1-.1-2.5-1.4-2.5H65.7c-.6 0-1.2.3-1.5.8L41.5 81.2c-.6.9.1 2.1 1.2 2.1h16.3C59.8 83.3 60.6 82.9 61 82.1z" class="st0"></path></svg></a><div class="FadeIn_fadeIn__TNBL_ "><div class="AppHeader_actionsArea__3VI_s"><button aria-label="テーマを切り替える" class="AppHeader_themeButton__BQJ80"><svg width="23" height="23" fill="#e3e3e3" viewBox="0 -960 960 960"><path d="M480-360q50 0 85-35t35-85q0-50-35-85t-85-35q-50 0-85 35t-35 85q0 50 35 85t85 35Zm0 80q-83 0-141.5-58.5T280-480q0-83 58.5-141.5T480-680q83 0 141.5 58.5T680-480q0 83-58.5 141.5T480-280ZM200-440H40v-80h160v80Zm720 0H760v-80h160v80ZM440-760v-160h80v160h-80Zm0 720v-160h80v160h-80ZM256-650l-101-97 57-59 96 100-52 56Zm492 496-97-101 53-55 101 97-57 59Zm-98-550 97-101 59 57-100 96-56-52ZM154-212l101-97 55 53-97 101-59-57Zm326-268Z"></path></svg></button><a aria-label="検索" class="AppHeader_searchLink__oNIO_" id="header-search" href="https://zenn.dev/search"><svg viewBox="0 0 27 27" height="23" width="23"><path fill="currentColor" d="M11.56,3.43a8.26,8.26,0,0,0,0,16.52,8.18,8.18,0,0,0,5-1.72l4.7,4.7a1.1,1.1,0,0,0,1.56,0,1.09,1.09,0,0,0,0-1.55l0,0-4.7-4.7a8.18,8.18,0,0,0,1.72-5A8.28,8.28,0,0,0,11.56,3.43Zm0,2.2A6.06,6.06,0,1,1,5.5,11.69,6,6,0,0,1,11.56,5.63Z"></path></svg></a><button class="AppHeader_signInLink__YRa2o">Log in</button></div></div></div></div></header><article class="View_container__VQuzA"><aside class="ContentStickyNavForMobile_container__153a8"><div class="Container_wide__ykGLh Container_common__figYY"><div class="ContentStickyNavForMobile_inner__xJ_fS"><div class="ContentStickyNavForMobile_avatarInner__3_noS"><a class="ContentStickyNavForMobile_principalLink__c15vw" href="https://zenn.dev/yamato_snow"><span class="ContentStickyNavForMobile_avatarContainer__V3P_G"><img alt="やまと" class="AvatarImage_border__pDIjF AvatarImage_plain__Fgp4R " height="38" referrerpolicy="no-referrer" src="./HowToscraping_files/e1164c4a45.jpeg" width="38"></span><span class="ContentStickyNavForMobile_displayName__cmEag">やまと</span></a></div><div class="ContentStickyNavForMobile_actions__a9fMk"><div class="ArticleMobileHeaderToc_toc__zMEkG"><button class="ArticleMobileHeaderToc_tocButton__RC64e">目次<svg viewBox="0 0 27 27" class="ArticleMobileHeaderToc_arrowIcon__VruMz" height="13" width="13"><path fill="currentColor" d="M12.74,20.53,3.48,11.35a.75.75,0,0,1,0-1.07L4.71,9.05a.75.75,0,0,1,1.07,0l7.49,7.41,7.49-7.41a.74.74,0,0,1,1.06,0l1.24,1.23a.77.77,0,0,1,0,1.07L13.8,20.53A.74.74,0,0,1,12.74,20.53Z"></path></svg></button></div></div></div></div></aside><header class="ArticleHeader_header__IRbtk"><div class="Container_wide__ykGLh Container_common__figYY"><div class="ArticleHeader_main__W98WY"><div class="ArticleHeader_emoji__30JiU"><span class="Emoji_twemoji__hcxYF"><span class="Emoji_twemojiImg__Oc6vR" style="background-image:url(https://asia-northeast1-zenn-dev-production.cloudfunctions.net/twemoji/%F0%9F%8F%A0.svg)"></span></span><span class="Emoji_nativeEmoji__GMBzX">🏠</span></div><h1 class="ArticleHeader_title__9jiOv"><span style="font-size:0.8em">Python + Flask + Selenium で作る SUUMO 物件情報スクレイピングツール</span></h1><div class="ArticleHeader_metaContainer__5UzrJ"><div class="ArticleHeader_metaInfo__XrRdh"><span class="ArticleHeader_pubDate__gF_sc"><time class="ArticleHeader_num__7Zpz0" datetime="2025-12-20T09:46:22+00:00">2025/12/20</time>に公開</span></div></div></div></div></header><div class="Container_wide__ykGLh Container_common__figYY"><div class="ContainerUndo_undoInSM__1vdc1"><div class="View_inner__LlCJG"><div class="View_stickyShare__TsaVf"><div class="View_stickyShareInner__FLu2S"><div class="LikeButton_container__YlckE style-large-white count-bottom"><button aria-label="いいね" class="LikeButton_button__ZwdG4" data-pressed="false"><svg class="LikeButton_svgLike__Gl0Sz" viewBox="0 0 110 110"><path class="LikeButton_svgLikeLine__f9txR" d="M73,24a23.78,23.78,0,0,0-15.89,6.19,3.14,3.14,0,0,1-4.18,0A23.81,23.81,0,0,0,37,24a22,22,0,0,0-22,22c0,16.67,19.64,32.82,25.11,37.93,2.84,2.65,6.15,5.64,8.92,8.13a8.9,8.9,0,0,0,11.9,0c2.77-2.49,6.07-5.48,8.91-8.13C75.37,78.81,95,62.66,95,46A22,22,0,0,0,73,24Z" fill="currentColor"></path><path class="LikeButton_svgLikeInner__uiexS" d="M66.25,76.42c-.71.64-1.32,1.2-1.82,1.67-2.51,2.33-5.39,5-7.94,7.25a2.21,2.21,0,0,1-3,0C51,83,48.1,80.42,45.59,78.09c-.5-.47-1.12-1-1.82-1.67C38.09,71.29,23,57.67,23,46A14,14,0,0,1,37,32a15.92,15.92,0,0,1,11.65,5.23l4.73,5a2.2,2.2,0,0,0,3.23,0l4.72-5A16.06,16.06,0,0,1,73,32,14,14,0,0,1,87,46C87,57.67,71.93,71.29,66.25,76.42Z" fill="currentColor"></path><g class="LikeButton_svgLikeDecoration__78UjB"><circle cx="41.5" cy="9.5" fill="#3ea8ff" r="3.5"></circle><circle cx="98.5" cy="26.5" fill="#ffdc6e" r="3.5"></circle><circle cx="13" cy="19" fill="#c067f4" r="5"></circle><circle cx="77" cy="9" fill="#f76685" r="5"></circle><circle cx="26.5" cy="92.5" fill="#f76685" r="3.5"></circle><circle cx="105.5" cy="48.5" fill="#c067f4" r="3.5"></circle><circle cx="4.5" cy="60.5" fill="#3ea8ff" r="3.5"></circle><circle cx="94.5" cy="73.5" fill="#3ea8ff" r="1.5"></circle><circle cx="16.5" cy="75.5" fill="#ffdc6e" r="1.5"></circle><circle cx="78.5" cy="91.5" fill="#ffdc6e" r="1.5"></circle></g></svg></button></div><span style="display:block;height:1rem;flex-shrink:0"></span><div class="BookmarkButton_container__VcKCG style-large-white count-bottom"><button aria-label="ブックマーク" class="BookmarkButton_bookmarkButton__tZ8rb" data-pressed="false"><svg width="32" height="32" fill="none" viewBox="0 0 32 32"><path fill="#ACBCC7" d="M15.9998 24L10.3998 26.4C9.51095 26.7778 8.6665 26.7056 7.8665 26.1833C7.0665 25.6611 6.6665 24.9222 6.6665 23.9667V6.66667C6.6665 5.93333 6.92762 5.30556 7.44984 4.78333C7.97206 4.26111 8.59984 4 9.33317 4H22.6665C23.3998 4 24.0276 4.26111 24.5498 4.78333C25.0721 5.30556 25.3332 5.93333 25.3332 6.66667V23.9667C25.3332 24.9222 24.9332 25.6611 24.1332 26.1833C23.3332 26.7056 22.4887 26.7778 21.5998 26.4L15.9998 24ZM15.9998 21.0667L22.6665 23.9333V6.66667H9.33317V23.9333L15.9998 21.0667Z"></path></svg></button></div><span style="display:block;height:1rem;flex-shrink:0"></span><div class="ShareButtonsExperimental_container__CrtBj" style="flex-direction:column;align-items:stretch"><a aria-label="X(Twitter)にポスト" class="ShareButtonsExperimental_button__d9aXF ShareButtonsExperimental_svgTwitterVertical__NmmfB ShareButtonsExperimental_svgTwitterBase__8FrNq" data-tooltip-for-desktop="true" data-tooltip-position="bottom" href="https://twitter.com/intent/tweet?url=https://zenn.dev/yamato_snow/articles/00e11d435247b3&amp;text=Python%20%2B%20Flask%20%2B%20Selenium%20%E3%81%A7%E4%BD%9C%E3%82%8B%20SUUMO%20%E7%89%A9%E4%BB%B6%E6%83%85%E5%A0%B1%E3%82%B9%E3%82%AF%E3%83%AC%E3%82%A4%E3%83%94%E3%83%B3%E3%82%B0%E3%83%84%E3%83%BC%E3%83%AB%EF%BD%9C%E3%82%84%E3%81%BE%E3%81%A8&amp;hashtags=zenn" id="gtm-article-left-tweet" rel="nofollow noopener noreferrer" role="tooltip" target="_blank"><svg width="27" height="28" fill="none" viewBox="0 0 27 28"><g clip-path="url(#a)"><path fill="currentColor" d="M16.0687 11.7356L26.12 0H23.7382L15.0106 10.1899L8.03988 0H0L10.5411 15.4089L0 27.7155H2.38199L11.5985 16.9546L18.9601 27.7155H27L16.0681 11.7356H16.0687ZM12.8062 15.5447L11.7382 14.0103L3.24025 1.80106H6.89884L13.7568 11.6543L14.8248 13.1887L23.7393 25.9963H20.0807L12.8062 15.5452V15.5447Z"></path></g><defs><clippath id="a"><path fill="#fff" d="M0 0H27V27.73H0z"></path></clippath></defs></svg></a><a aria-label="Facebookに投稿" class="ShareButtonsExperimental_button__d9aXF ShareButtonsExperimental_svgFacebookVertical__3ykb7 ShareButtonsExperimental_svgFacebookBase___gDOW" data-tooltip-for-desktop="true" data-tooltip-position="bottom" href="http://www.facebook.com/sharer.php?u=https://zenn.dev/yamato_snow/articles/00e11d435247b3" id="gtm-article-left-facebook" rel="nofollow noopener noreferrer" role="tooltip" target="_blank"><svg width="28" height="29" fill="none" viewBox="0 0 28 29"><g clip-path="url(#a)"><path fill="currentColor" d="M28 14.7812C28 7.02084 21.7319 0.729736 14 0.729736C6.26808 0.729736 0 7.02084 0 14.7812C0 21.3707 4.52032 26.9002 10.6182 28.4189V19.0753H7.73136V14.7812H10.6182V12.9309C10.6182 8.14833 12.7747 5.93158 17.453 5.93158C18.34 5.93158 19.8705 6.10637 20.4966 6.28061V10.1729C20.1662 10.138 19.5922 10.1206 18.8793 10.1206C16.5838 10.1206 15.6968 10.9935 15.6968 13.2625V14.7812H20.2698L19.4841 19.0753H15.6968V28.7297C22.629 27.8895 28.0006 21.9654 28.0006 14.7812H28Z"></path></g><defs><clippath id="a"><path fill="#fff" d="M0 0H28V28H0z" transform="translate(0 .73)"></path></clippath></defs></svg></a><a aria-label="はてなブックマークに登録" class="ShareButtonsExperimental_button__d9aXF ShareButtonsExperimental_svgHatenaBookmarkVertical__b161J ShareButtonsExperimental_svgHatenaBookmarkBase__VXz6p" data-tooltip-for-desktop="true" data-tooltip-position="bottom" href="https://b.hatena.ne.jp/add?mode=confirm&amp;url=https://zenn.dev/yamato_snow/articles/00e11d435247b3&amp;title=Python%20%2B%20Flask%20%2B%20Selenium%20%E3%81%A7%E4%BD%9C%E3%82%8B%20SUUMO%20%E7%89%A9%E4%BB%B6%E6%83%85%E5%A0%B1%E3%82%B9%E3%82%AF%E3%83%AC%E3%82%A4%E3%83%94%E3%83%B3%E3%82%B0%E3%83%84%E3%83%BC%E3%83%AB%EF%BD%9C%E3%82%84%E3%81%BE%E3%81%A8" id="gtm-article-left-hatena-bookmark" rel="nofollow noopener noreferrer" role="tooltip" target="_blank"><svg width="27" height="28" fill="none" viewBox="0 0 27 28"><path fill="currentColor" fill-rule="evenodd" d="M5.4999 0.729736H21.5001C24.5376 0.729736 27 3.19213 27 6.22964V22.2298C27 25.2673 24.5376 27.7297 21.5001 27.7297H5.4999C2.46239 27.7297 0 25.2673 0 22.2298V6.22964C0 3.19213 2.46239 0.729736 5.4999 0.729736ZM12.98 13.7472C13.8521 13.8136 14.5319 14.1209 15.0212 14.6673V14.6679C15.512 15.2127 15.7572 15.9444 15.7572 16.8543C15.7572 17.5126 15.62 18.0877 15.3436 18.5867C15.0692 19.084 14.6756 19.4712 14.1604 19.7433C13.7441 19.9658 13.2289 20.1278 12.6155 20.2245C12.001 20.3179 10.9966 20.3665 9.6039 20.3665H6.13656V8.09392H9.50184C10.8859 8.09392 11.8503 8.13875 12.4016 8.22623C12.9503 8.31695 13.4206 8.4703 13.8164 8.68792C14.269 8.93902 14.6129 9.27437 14.8527 9.69341C15.0865 10.1151 15.2069 10.6028 15.2069 11.1546C15.2069 11.8512 15.0309 12.4053 14.6761 12.813C14.3197 13.2261 13.756 13.5355 12.98 13.7472ZM9.96192 10.8144H9.24372H9.24318V13.2768H9.91116C10.7352 13.2768 11.2984 13.1856 11.6073 13.0058C11.9124 12.8227 12.0663 12.5273 12.0663 12.0667C12.0663 11.6061 11.9216 11.2821 11.6375 11.0947C11.3497 10.9084 10.7919 10.8144 9.96192 10.8144ZM10.4128 18.1514C11.2028 18.1514 11.7661 18.0531 12.0928 17.8523V17.8528C12.4227 17.653 12.5863 17.3209 12.5863 16.8581C12.5863 16.3408 12.4367 15.9806 12.1338 15.7765C11.8357 15.5724 11.2747 15.4703 10.463 15.4703H9.24372V18.1514H10.4128ZM19.3093 17.257C18.4502 17.257 17.7547 17.9525 17.7547 18.8111C17.7547 19.6697 18.4507 20.3658 19.3093 20.3658C20.1679 20.3658 20.8634 19.6697 20.8634 18.8111C20.8634 17.9525 20.1668 17.257 19.3093 17.257ZM17.9593 8.09318H20.6593V16.2753H17.9593V8.09318Z" clip-rule="evenodd"></path></svg></a></div></div></div><div class="View_columnsContainer__ijfFN"><section class="View_content__OZ_Dc"><div class="View_main__AU6KW"><div class="Container_default__13H8g Container_common__figYY"><div class="View_topics__2sHkl"><a class="TopicList_item___M3DS" style="font-size:0.8rem;padding:2px" href="https://zenn.dev/topics/flask"><div class="TopicList_image__Sqd63"><img class="TopicList_img__qj3KE" height="26" loading="lazy" src="./HowToscraping_files/dabd99d16d.png" width="26"></div><div class="TopicList_name__xMwaW">Flask</div></a><a class="TopicList_item___M3DS" style="font-size:0.8rem;padding:2px" href="https://zenn.dev/topics/python"><div class="TopicList_image__Sqd63"><img class="TopicList_img__qj3KE" height="26" loading="lazy" src="./HowToscraping_files/ebddf7c6bb.png" width="26"></div><div class="TopicList_name__xMwaW">Python</div></a><a class="TopicList_item___M3DS" style="font-size:0.8rem;padding:2px" href="https://zenn.dev/topics/selenium"><div class="TopicList_image__Sqd63"><img class="TopicList_img__qj3KE" height="26" loading="lazy" src="./HowToscraping_files/990b70ad16.jpeg" width="26"></div><div class="TopicList_name__xMwaW">Selenium</div></a><a class="TopicList_item___M3DS" style="font-size:0.8rem;padding:2px" href="https://zenn.dev/topics/beautifulsoup"><div class="TopicList_image__Sqd63"><img class="TopicList_img__qj3KE" height="26" loading="lazy" src="./HowToscraping_files/0e1b3cc2ea.png" width="26"></div><div class="TopicList_name__xMwaW">Beautiful Soup</div></a><a class="TopicList_item___M3DS" style="font-size:0.8rem;padding:2px" href="https://zenn.dev/topics/%E3%82%B9%E3%82%AF%E3%83%AC%E3%82%A4%E3%83%94%E3%83%B3%E3%82%B0"><div class="TopicList_image__Sqd63"><img class="TopicList_img__qj3KE" height="26" loading="lazy" src="./HowToscraping_files/topic.png" width="26"></div><div class="TopicList_name__xMwaW">スクレイピング</div></a><a class="View_topicLink__jdtX_" href="https://zenn.dev/tech-or-idea"><div class="View_topicImage__qMmmw"><img class="View_topicImg__TpkV5" loading="lazy" src="./HowToscraping_files/tech-icon.svg"></div><div class="View_topicName____nYp" style="text-transform:capitalize">tech</div></a></div><div class="znc BodyContentViewer_headingAnchorStyle__qn_OJ useInsertButtonToCodeBlock_insertButtonWrapper__RlhDk"><h2 id="%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB" data-line="0" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB" aria-hidden="true"></a> はじめに</h2>
<p data-line="2" class="code-line">SUUMOの賃貸物件URLから詳細情報を自動抽出し、Excel/CSV/JSON形式でエクスポートするWebアプリケーションを作成しました。複数の物件情報を一括取得し、比較しやすい形式で出力できるツールです。</p>
<p data-line="4" class="code-line"><strong>リポジトリ</strong>: <a href="https://github.com/yamato-snow/2025-12-07_sumo-scraping" target="_blank" rel="nofollow noopener noreferrer">https://github.com/yamato-snow/2025-12-07_sumo-scraping</a></p>
<p data-line="6" class="code-line">この記事では、このツールの技術的なポイントを中心に解説します。BeautifulSoup4によるHTML解析、Seleniumを使ったブラウザ自動化、Server-Sent Events（SSE）によるリアルタイム進捗表示など、実務で役立つ実装パターンを紹介します。</p>
<h2 id="%E3%81%AA%E3%81%9C%E3%81%93%E3%81%AE%E3%83%84%E3%83%BC%E3%83%AB%E3%82%92%E4%BD%9C%E3%81%A3%E3%81%9F%E3%81%AE%E3%81%8B%EF%BC%9F" data-line="8" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E3%81%AA%E3%81%9C%E3%81%93%E3%81%AE%E3%83%84%E3%83%BC%E3%83%AB%E3%82%92%E4%BD%9C%E3%81%A3%E3%81%9F%E3%81%AE%E3%81%8B%EF%BC%9F" aria-hidden="true"></a> なぜこのツールを作ったのか？</h2>
<p data-line="10" class="code-line">引越し先を探すとき、SUUMOで気になる物件を何件も見つけても、比較するのは大変です。</p>
<ul data-line="12" class="code-line">
<li data-line="12" class="code-line">タブを大量に開いて行ったり来たりする</li>
<li data-line="13" class="code-line">手作業でExcelに転記して比較表を作る</li>
<li data-line="14" class="code-line">敷金・礼金・管理費など細かい条件を見落とす</li>
</ul>
<p data-line="16" class="code-line">これらの手間を解消するため、物件URLを入力するだけで必要な情報を自動抽出し、Excel/CSV/JSON形式で出力できるツールを作りました。</p>
<p data-line="18" class="code-line">さらに、SUUMOアカウントでログインして「お気に入り」に保存した物件を一括取得する機能も追加しています。</p>
<h2 id="%E3%81%93%E3%81%AE%E3%83%84%E3%83%BC%E3%83%AB%E3%81%A7%E3%81%A7%E3%81%8D%E3%82%8B%E3%81%93%E3%81%A8" data-line="20" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E3%81%93%E3%81%AE%E3%83%84%E3%83%BC%E3%83%AB%E3%81%A7%E3%81%A7%E3%81%8D%E3%82%8B%E3%81%93%E3%81%A8" aria-hidden="true"></a> このツールでできること</h2>
<h3 id="%E4%B8%BB%E3%81%AA%E6%A9%9F%E8%83%BD" data-line="22" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E4%B8%BB%E3%81%AA%E6%A9%9F%E8%83%BD" aria-hidden="true"></a> 主な機能</h3>
<ol data-line="24" class="code-line">
<li data-line="24" class="code-line">
<strong>物件情報の自動抽出</strong> - SUUMOの物件URLから詳細情報を取得</li>
<li data-line="25" class="code-line">
<strong>お気に入り一括取得</strong> - SUUMOアカウントでログインして保存済み物件を自動取得</li>
<li data-line="26" class="code-line">
<strong>複数フォーマットでエクスポート</strong> - Excel/CSV/JSON 3形式に対応</li>
<li data-line="27" class="code-line">
<strong>リアルタイム進捗表示</strong> - Server-Sent Events で処理状況をリアルタイム表示</li>
</ol>
<h3 id="%E5%8F%96%E5%BE%97%E3%81%A7%E3%81%8D%E3%82%8B%E6%83%85%E5%A0%B1%EF%BC%88%E5%85%A831%E9%A0%85%E7%9B%AE%EF%BC%89" data-line="29" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E5%8F%96%E5%BE%97%E3%81%A7%E3%81%8D%E3%82%8B%E6%83%85%E5%A0%B1%EF%BC%88%E5%85%A831%E9%A0%85%E7%9B%AE%EF%BC%89" aria-hidden="true"></a> 取得できる情報（全31項目）</h3>
<table data-line="31" class="code-line">
<thead data-line="31" class="code-line">
<tr data-line="31" class="code-line">
<th>カテゴリ</th>
<th>取得項目</th>
</tr>
</thead>
<tbody data-line="33" class="code-line">
<tr data-line="33" class="code-line">
<td><strong>基本情報</strong></td>
<td>URL、物件名、所在地</td>
</tr>
<tr data-line="34" class="code-line">
<td><strong>費用</strong></td>
<td>賃料・初期費用、管理費・共益費、敷金、礼金、保証金、敷引・償却</td>
</tr>
<tr data-line="35" class="code-line">
<td><strong>物件詳細</strong></td>
<td>間取り、専有面積、向き、建物種別、築年数</td>
</tr>
<tr data-line="36" class="code-line">
<td><strong>アクセス</strong></td>
<td>最寄り駅（最大3つ）、徒歩時間</td>
</tr>
<tr data-line="37" class="code-line">
<td><strong>その他</strong></td>
<td>損保、駐車場、仲介手数料、保証会社、ほか初期費用、ほか諸費用、備考</td>
</tr>
</tbody>
</table>
<h2 id="%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%A6%E3%81%84%E3%82%8B%E6%8A%80%E8%A1%93%E3%82%B9%E3%82%BF%E3%83%83%E3%82%AF%E3%81%AF%EF%BC%9F" data-line="39" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%A6%E3%81%84%E3%82%8B%E6%8A%80%E8%A1%93%E3%82%B9%E3%82%BF%E3%83%83%E3%82%AF%E3%81%AF%EF%BC%9F" aria-hidden="true"></a> 使用している技術スタックは？</h2>
<table data-line="41" class="code-line">
<thead data-line="41" class="code-line">
<tr data-line="41" class="code-line">
<th>領域</th>
<th>技術</th>
<th>役割</th>
</tr>
</thead>
<tbody data-line="43" class="code-line">
<tr data-line="43" class="code-line">
<td><strong>Backend</strong></td>
<td>Flask 3.x</td>
<td>Webフレームワーク</td>
</tr>
<tr data-line="44" class="code-line">
<td><strong>Frontend</strong></td>
<td>Bootstrap 5 + Vanilla JS</td>
<td>UI</td>
</tr>
<tr data-line="45" class="code-line">
<td><strong>スクレイピング</strong></td>
<td>BeautifulSoup4 + Requests</td>
<td>HTML解析・HTTP通信</td>
</tr>
<tr data-line="46" class="code-line">
<td><strong>ブラウザ自動化</strong></td>
<td>Selenium + webdriver-manager</td>
<td>ログイン処理</td>
</tr>
<tr data-line="47" class="code-line">
<td><strong>データ出力</strong></td>
<td>pandas + openpyxl</td>
<td>Excel/CSV/JSON出力</td>
</tr>
</tbody>
</table>
<h3 id="%E3%81%AA%E3%81%9C%E3%81%93%E3%81%AE%E7%B5%84%E3%81%BF%E5%90%88%E3%82%8F%E3%81%9B%E3%82%92%E9%81%B8%E3%82%93%E3%81%A0%E3%81%AE%E3%81%8B%EF%BC%9F" data-line="49" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E3%81%AA%E3%81%9C%E3%81%93%E3%81%AE%E7%B5%84%E3%81%BF%E5%90%88%E3%82%8F%E3%81%9B%E3%82%92%E9%81%B8%E3%82%93%E3%81%A0%E3%81%AE%E3%81%8B%EF%BC%9F" aria-hidden="true"></a> なぜこの組み合わせを選んだのか？</h3>
<p data-line="51" class="code-line"><strong>Flask</strong> を選んだ理由は、シンプルさです。Djangoのような大規模フレームワークはこの規模のツールにはオーバースペックです。APIエンドポイントの定義、SSEの実装、ファイルダウンロードなど、必要な機能をシンプルに実装できます。</p>
<p data-line="53" class="code-line"><strong>BeautifulSoup4</strong> は、HTMLの解析においてCSSセレクタとDOM操作の両方に対応しており、直感的に記述できます。Scrapy のようなフレームワークは今回のようなシンプルな用途には過剰です。</p>
<p data-line="55" class="code-line"><strong>Selenium</strong> は、ログイン処理に必要です。SUUMOのお気に入り機能を利用するにはログインが必要であり、JavaScriptで動的に生成されるページを扱うにはブラウザ自動化が必要になります。</p>
<h2 id="%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E6%A7%8B%E6%88%90" data-line="57" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E6%A7%8B%E6%88%90" aria-hidden="true"></a> プロジェクト構成</h2>
<div class="code-block-container"><div class="useInsertButtonToCodeBlock_codeBlockWrapper___Qokq"><pre class="shiki github-dark" style="background-color:#151e2c;color:#e1e4e8" data-has-button="true"><code class="code-line" data-line="59"><span class="line"><span>Project_Suumo/</span></span>
<span class="line"><span>├── app/                    # Flaskアプリケーション</span></span>
<span class="line"><span>│   ├── __init__.py         # アプリファクトリ</span></span>
<span class="line"><span>│   ├── routes.py           # APIエンドポイント定義</span></span>
<span class="line"><span>│   ├── scraper/            # スクレイピングモジュール</span></span>
<span class="line"><span>│   │   ├── suumo.py        # 物件情報スクレイパー</span></span>
<span class="line"><span>│   │   └── auth.py         # Selenium認証モジュール</span></span>
<span class="line"><span>│   ├── exporters/          # エクスポートモジュール</span></span>
<span class="line"><span>│   │   └── exporter.py     # Excel/CSV/JSON出力</span></span>
<span class="line"><span>│   ├── templates/          # HTMLテンプレート</span></span>
<span class="line"><span>│   │   ├── base.html</span></span>
<span class="line"><span>│   │   └── index.html</span></span>
<span class="line"><span>│   └── static/css/         # スタイルシート</span></span>
<span class="line"><span>├── config.py               # Flask設定</span></span>
<span class="line"><span>├── run.py                  # エントリーポイント</span></span>
<span class="line"><span>├── requirements.txt        # 依存パッケージ</span></span>
<span class="line"><span>└── tests/                  # テストコード</span></span>
<span class="line"><span></span></span></code></pre><button class="useInsertButtonToCodeBlock_copyButton__8Pk5H" data-tooltip-position="top-left" aria-label="クリップボードにコピー"><img src="./HowToscraping_files/copy-icon.svg" class="useInsertButtonToCodeBlock_copyIcon__ejNn_"></button><button class="useInsertButtonToCodeBlock_wrapButton__XDlEx" data-tooltip-position="top-left" aria-label="右端で折り返す"><img src="./HowToscraping_files/wrap-icon.svg" class="useInsertButtonToCodeBlock_copyIcon__ejNn_"></button></div></div><h2 id="%E3%82%BB%E3%83%83%E3%83%88%E3%82%A2%E3%83%83%E3%83%97%E6%96%B9%E6%B3%95" data-line="79" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E3%82%BB%E3%83%83%E3%83%88%E3%82%A2%E3%83%83%E3%83%97%E6%96%B9%E6%B3%95" aria-hidden="true"></a> セットアップ方法</h2>
<h3 id="%E5%89%8D%E6%8F%90%E6%9D%A1%E4%BB%B6" data-line="81" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E5%89%8D%E6%8F%90%E6%9D%A1%E4%BB%B6" aria-hidden="true"></a> 前提条件</h3>
<ul data-line="83" class="code-line">
<li data-line="83" class="code-line">Python 3.11以上</li>
<li data-line="84" class="code-line">Google Chrome（お気に入り取得機能を使う場合）</li>
</ul>
<h3 id="%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB%E6%89%8B%E9%A0%86" data-line="86" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB%E6%89%8B%E9%A0%86" aria-hidden="true"></a> インストール手順</h3>
<div class="code-block-container"><div class="useInsertButtonToCodeBlock_codeBlockWrapper___Qokq"><pre class="shiki github-dark" style="background-color:#151e2c;color:#e1e4e8" data-has-button="true"><code class="code-line" data-line="88"><span class="line"><span style="color:#a0aab5"># 1. リポジトリをクローン</span></span>
<span class="line"><span style="color:#B392F0">git</span><span style="color:#9ECBFF"> clone</span><span style="color:#9ECBFF"> https://github.com/yamato-snow/2025-12-07_sumo-scraping.git</span></span>
<span class="line"><span style="color:#79B8FF">cd</span><span style="color:#9ECBFF"> 2025-12-07_sumo-scraping</span></span>
<span class="line"></span>
<span class="line"><span style="color:#a0aab5"># 2. 仮想環境をセットアップ</span></span>
<span class="line"><span style="color:#B392F0">python</span><span style="color:#79B8FF"> -m</span><span style="color:#9ECBFF"> venv</span><span style="color:#9ECBFF"> .venv</span></span>
<span class="line"><span style="color:#79B8FF">source</span><span style="color:#9ECBFF"> .venv/bin/activate</span><span style="color:#a0aab5">  # macOS/Linux</span></span>
<span class="line"><span style="color:#a0aab5"># .venv\Scripts\activate   # Windows</span></span>
<span class="line"></span>
<span class="line"><span style="color:#a0aab5"># 3. 依存関係をインストール</span></span>
<span class="line"><span style="color:#B392F0">pip</span><span style="color:#9ECBFF"> install</span><span style="color:#79B8FF"> -r</span><span style="color:#9ECBFF"> requirements.txt</span></span>
<span class="line"></span>
<span class="line"><span style="color:#a0aab5"># 4. アプリを起動</span></span>
<span class="line"><span style="color:#B392F0">python</span><span style="color:#9ECBFF"> run.py</span></span>
<span class="line"></span></code></pre><button class="useInsertButtonToCodeBlock_copyButton__8Pk5H" data-tooltip-position="top-left" aria-label="クリップボードにコピー"><img src="./HowToscraping_files/copy-icon.svg" class="useInsertButtonToCodeBlock_copyIcon__ejNn_"></button><button class="useInsertButtonToCodeBlock_wrapButton__XDlEx" data-tooltip-position="top-left" aria-label="右端で折り返す"><img src="./HowToscraping_files/wrap-icon.svg" class="useInsertButtonToCodeBlock_copyIcon__ejNn_"></button></div></div><p data-line="105" class="code-line">ブラウザで <a href="http://localhost:5001/" target="_blank" rel="nofollow noopener noreferrer">http://localhost:5001</a> にアクセスすると、Webインターフェースが表示されます。</p>
<h3 id="%E4%BE%9D%E5%AD%98%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8" data-line="107" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E4%BE%9D%E5%AD%98%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8" aria-hidden="true"></a> 依存パッケージ</h3>
<div class="code-block-container"><div class="useInsertButtonToCodeBlock_codeBlockWrapper___Qokq"><pre class="shiki github-dark" style="background-color:#151e2c;color:#e1e4e8" data-has-button="true"><code class="code-line" data-line="109"><span class="line"><span># Flask Web Framework</span></span>
<span class="line"><span>flask&gt;=3.0.0</span></span>
<span class="line"><span>flask-cors&gt;=4.0.0</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Data Processing</span></span>
<span class="line"><span>pandas&gt;=2.0.0</span></span>
<span class="line"><span>openpyxl&gt;=3.1.0</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Web Scraping</span></span>
<span class="line"><span>beautifulsoup4&gt;=4.12.0</span></span>
<span class="line"><span>requests&gt;=2.31.0</span></span>
<span class="line"><span>selenium&gt;=4.15.0</span></span>
<span class="line"><span>webdriver-manager&gt;=4.0.0</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Testing</span></span>
<span class="line"><span>pytest&gt;=7.0.0</span></span>
<span class="line"><span></span></span></code></pre><button class="useInsertButtonToCodeBlock_copyButton__8Pk5H" data-tooltip-position="top-left" aria-label="クリップボードにコピー"><img src="./HowToscraping_files/copy-icon.svg" class="useInsertButtonToCodeBlock_copyIcon__ejNn_"></button><button class="useInsertButtonToCodeBlock_wrapButton__XDlEx" data-tooltip-position="top-left" aria-label="右端で折り返す"><img src="./HowToscraping_files/wrap-icon.svg" class="useInsertButtonToCodeBlock_copyIcon__ejNn_"></button></div></div><h2 id="%E4%BD%BF%E3%81%84%E6%96%B9" data-line="128" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E4%BD%BF%E3%81%84%E6%96%B9" aria-hidden="true"></a> 使い方</h2>
<h3 id="%E6%96%B9%E6%B3%951%3A-url%E6%89%8B%E5%8B%95%E5%85%A5%E5%8A%9B%E3%83%A2%E3%83%BC%E3%83%89" data-line="130" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E6%96%B9%E6%B3%951%3A-url%E6%89%8B%E5%8B%95%E5%85%A5%E5%8A%9B%E3%83%A2%E3%83%BC%E3%83%89" aria-hidden="true"></a> 方法1: URL手動入力モード</h3>
<ol data-line="132" class="code-line">
<li data-line="132" class="code-line">テキストエリアにSUUMO物件URLを1行ずつ入力</li>
<li data-line="133" class="code-line">出力形式（Excel/CSV/JSON）を選択</li>
<li data-line="134" class="code-line">「スクレイピング開始」ボタンをクリック</li>
<li data-line="135" class="code-line">処理完了後、ダウンロードボタンから結果を取得</li>
</ol>
<h3 id="%E6%96%B9%E6%B3%952%3A-%E3%81%8A%E6%B0%97%E3%81%AB%E5%85%A5%E3%82%8A%E5%8F%96%E5%BE%97%E3%83%A2%E3%83%BC%E3%83%89" data-line="137" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E6%96%B9%E6%B3%952%3A-%E3%81%8A%E6%B0%97%E3%81%AB%E5%85%A5%E3%82%8A%E5%8F%96%E5%BE%97%E3%83%A2%E3%83%BC%E3%83%89" aria-hidden="true"></a> 方法2: お気に入り取得モード</h3>
<ol data-line="139" class="code-line">
<li data-line="139" class="code-line">「お気に入りから取得」タブを選択</li>
<li data-line="140" class="code-line">SUUMOアカウントのメールアドレスとパスワードを入力</li>
<li data-line="141" class="code-line">「お気に入りを取得」ボタンをクリック</li>
<li data-line="142" class="code-line">取得されたURLが自動でテキストエリアに入力される</li>
<li data-line="143" class="code-line">以降は方法1と同様</li>
</ol>
<h2 id="%E3%82%B9%E3%82%AF%E3%83%AC%E3%82%A4%E3%83%94%E3%83%B3%E3%82%B0%E3%82%92%E5%A7%8B%E3%82%81%E3%82%8B%E5%89%8D%E3%81%AB%E7%9F%A5%E3%81%A3%E3%81%A6%E3%81%8A%E3%81%8F%E3%81%B9%E3%81%8D%E3%81%93%E3%81%A8" data-line="145" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E3%82%B9%E3%82%AF%E3%83%AC%E3%82%A4%E3%83%94%E3%83%B3%E3%82%B0%E3%82%92%E5%A7%8B%E3%82%81%E3%82%8B%E5%89%8D%E3%81%AB%E7%9F%A5%E3%81%A3%E3%81%A6%E3%81%8A%E3%81%8F%E3%81%B9%E3%81%8D%E3%81%93%E3%81%A8" aria-hidden="true"></a> スクレイピングを始める前に知っておくべきこと</h2>
<p data-line="147" class="code-line">スクレイピングは便利な技術ですが、法的リスクや倫理的な問題を理解せずに行うと、トラブルに発展する可能性があります。<strong>必ず以下の内容を理解した上で実行してください。</strong></p>
<h3 id="1.-%E6%B3%95%E7%9A%84%E3%83%AA%E3%82%B9%E3%82%AF%E3%82%92%E7%90%86%E8%A7%A3%E3%81%99%E3%82%8B" data-line="149" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#1.-%E6%B3%95%E7%9A%84%E3%83%AA%E3%82%B9%E3%82%AF%E3%82%92%E7%90%86%E8%A7%A3%E3%81%99%E3%82%8B" aria-hidden="true"></a> 1. 法的リスクを理解する</h3>
<p data-line="151" class="code-line">スクレイピングに関連する主な法律は以下の3つです。</p>
<h4 id="%E4%B8%8D%E6%AD%A3%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E7%A6%81%E6%AD%A2%E6%B3%95" data-line="153" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E4%B8%8D%E6%AD%A3%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E7%A6%81%E6%AD%A2%E6%B3%95" aria-hidden="true"></a> 不正アクセス禁止法</h4>
<p data-line="155" class="code-line">アクセス制限がかけられているシステムに、その制限を回避してアクセスする行為は違法です。</p>
<ul data-line="157" class="code-line">
<li data-line="157" class="code-line">
<strong>ログイン認証の突破</strong>: 本ツールのお気に入り取得機能は、ユーザー自身のアカウントでログインする機能です。他人のアカウントを使用したり、認証を回避する行為は違法です</li>
<li data-line="158" class="code-line">
<strong>CAPTCHA回避</strong>: CAPTCHA（画像認証）を自動的に突破する行為は不正アクセスとみなされる可能性があります</li>
<li data-line="159" class="code-line">
<strong>レート制限の回避</strong>: サーバー側で設定されているアクセス制限を意図的に回避する行為も問題になり得ます</li>
</ul>
<h4 id="%E8%91%97%E4%BD%9C%E6%A8%A9%E6%B3%95" data-line="161" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E8%91%97%E4%BD%9C%E6%A8%A9%E6%B3%95" aria-hidden="true"></a> 著作権法</h4>
<p data-line="163" class="code-line">ウェブサイトのコンテンツは著作物として保護されています。</p>
<ul data-line="165" class="code-line">
<li data-line="165" class="code-line">
<strong>私的利用の範囲</strong>: 個人的に情報を整理・比較する目的であれば、著作権法の「私的使用のための複製」に該当する可能性があります</li>
<li data-line="166" class="code-line">
<strong>再配布・商用利用は禁止</strong>: 取得したデータを第三者に配布したり、商用目的で利用することは著作権侵害になります</li>
<li data-line="167" class="code-line">
<strong>データベースの著作権</strong>: 物件情報の集合体としてのデータベースにも著作権が発生する場合があります</li>
</ul>
<h4 id="%E6%A5%AD%E5%8B%99%E5%A6%A8%E5%AE%B3%E7%BD%AA%EF%BC%88%E5%81%BD%E8%A8%88%E6%A5%AD%E5%8B%99%E5%A6%A8%E5%AE%B3%E3%83%BB%E9%9B%BB%E5%AD%90%E8%A8%88%E7%AE%97%E6%A9%9F%E6%90%8D%E5%A3%8A%E7%AD%89%E6%A5%AD%E5%8B%99%E5%A6%A8%E5%AE%B3%EF%BC%89" data-line="169" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E6%A5%AD%E5%8B%99%E5%A6%A8%E5%AE%B3%E7%BD%AA%EF%BC%88%E5%81%BD%E8%A8%88%E6%A5%AD%E5%8B%99%E5%A6%A8%E5%AE%B3%E3%83%BB%E9%9B%BB%E5%AD%90%E8%A8%88%E7%AE%97%E6%A9%9F%E6%90%8D%E5%A3%8A%E7%AD%89%E6%A5%AD%E5%8B%99%E5%A6%A8%E5%AE%B3%EF%BC%89" aria-hidden="true"></a> 業務妨害罪（偽計業務妨害・電子計算機損壊等業務妨害）</h4>
<p data-line="171" class="code-line">サーバーに過度な負荷をかけ、サービスの運営を妨害する行為は犯罪です。</p>
<ul data-line="173" class="code-line">
<li data-line="173" class="code-line">
<strong>大量リクエスト</strong>: 短時間に大量のリクエストを送信し、サーバーをダウンさせる行為</li>
<li data-line="174" class="code-line">
<strong>継続的な高負荷</strong>: 長時間にわたって高頻度でアクセスし続ける行為</li>
</ul>
<p data-line="176" class="code-line"><strong>過去の判例</strong>: 2010年の岡崎市立中央図書館事件では、図書館のウェブサイトに対する自動アクセスが業務妨害として問題になりました（最終的に不起訴）。技術的には問題のないアクセス頻度でも、相手側のシステムによっては問題視される可能性があります。</p>
<h3 id="2.-%E4%BA%8B%E5%89%8D%E3%81%AB%E7%A2%BA%E8%AA%8D%E3%81%99%E3%81%B9%E3%81%8D%E3%81%93%E3%81%A8" data-line="178" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#2.-%E4%BA%8B%E5%89%8D%E3%81%AB%E7%A2%BA%E8%AA%8D%E3%81%99%E3%81%B9%E3%81%8D%E3%81%93%E3%81%A8" aria-hidden="true"></a> 2. 事前に確認すべきこと</h3>
<p data-line="180" class="code-line">スクレイピングを実行する前に、必ず以下を確認してください。</p>
<h4 id="robots.txt-%E3%81%AE%E7%A2%BA%E8%AA%8D" data-line="182" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#robots.txt-%E3%81%AE%E7%A2%BA%E8%AA%8D" aria-hidden="true"></a> robots.txt の確認</h4>
<p data-line="184" class="code-line"><code>robots.txt</code>は、ウェブサイトがクローラー（自動アクセスプログラム）に対してアクセス可否を示すファイルです。</p>
<p data-line="186" class="code-line">**SUUMOのrobots.txt（<a href="https://suumo.jp/robots.txt%EF%BC%89%E3%81%AE%E4%B8%BB%E3%81%AA%E5%86%85%E5%AE%B9**:" target="_blank" rel="nofollow noopener noreferrer">https://suumo.jp/robots.txt）の主な内容**:</a></p>
<p data-line="188" class="code-line">SUUMOのrobots.txtは非常に詳細で、約200行以上のDisallow指定があります。</p>
<div class="code-block-container"><div class="useInsertButtonToCodeBlock_codeBlockWrapper___Qokq"><pre class="shiki github-dark" style="background-color:#151e2c;color:#e1e4e8" data-has-button="true"><code class="code-line" data-line="190"><span class="line"><span>User-agent: *</span></span>
<span class="line"><span># 編集・管理関連</span></span>
<span class="line"><span>Disallow: /edit/rewrite/</span></span>
<span class="line"><span>Disallow: /edit/include</span></span>
<span class="line"><span>Disallow: /edit/ssi</span></span>
<span class="line"><span>Disallow: /edit/error/error.html</span></span>
<span class="line"><span></span></span>
<span class="line"><span># モバイル</span></span>
<span class="line"><span>Disallow: /mb/</span></span>
<span class="line"><span></span></span>
<span class="line"><span># 内部パーツ（JS/CSS/API）</span></span>
<span class="line"><span>Disallow: /jj/kaisha/top/JJ052FA001/</span></span>
<span class="line"><span>Disallow: /jj/chintai/common/JJ901FI396/</span></span>
<span class="line"><span>Disallow: /jj/common/parts/JJ901FI402/</span></span>
<span class="line"><span># ... 多数のjjパスがDisallow</span></span>
<span class="line"><span></span></span>
<span class="line"><span># 賃貸関連の特定パス</span></span>
<span class="line"><span>Disallow: /chintai/bc_*/printout/          # 印刷ページ</span></span>
<span class="line"><span>Disallow: /chintai/*/__JJ_FR301FC001       # 内部機能</span></span>
<span class="line"><span>Disallow: /chintai/*/__JJ_FR301FC005</span></span>
<span class="line"><span>Disallow: /chintai/*/__JJ_FR301FB001</span></span>
<span class="line"><span>Disallow: /map/chintai/                     # 地図機能</span></span>
<span class="line"><span></span></span>
<span class="line"><span># SP（スマホ）API</span></span>
<span class="line"><span>Disallow: /sp/chintai/api/bukken/count/</span></span>
<span class="line"><span>Disallow: /sp/chintai/api/bukken/ninkido/hankyoCount/</span></span>
<span class="line"><span>Disallow: /sp/chintai/map/bukken/points/</span></span>
<span class="line"><span></span></span>
<span class="line"><span># クエリパラメータ</span></span>
<span class="line"><span>Disallow: /*?*sort=</span></span>
<span class="line"><span>Disallow: /*?rnekTmp=</span></span>
<span class="line"><span>Disallow: /*?rnTmp=</span></span>
<span class="line"><span>Disallow: /*?cinm=</span></span>
<span class="line"><span></span></span>
<span class="line"><span>User-agent: bingbot</span></span>
<span class="line"><span>Crawl-delay: 30        # 30秒の待機を推奨</span></span>
<span class="line"><span>Allow: /journal/</span></span>
<span class="line"><span></span></span>
<span class="line"><span>User-agent: Googlebot</span></span>
<span class="line"><span>Allow: /journal/</span></span>
<span class="line"><span># ... 他は*と同様のDisallow</span></span>
<span class="line"><span></span></span></code></pre><button class="useInsertButtonToCodeBlock_copyButton__8Pk5H" data-tooltip-position="top-left" aria-label="クリップボードにコピー"><img src="./HowToscraping_files/copy-icon.svg" class="useInsertButtonToCodeBlock_copyIcon__ejNn_"></button><button class="useInsertButtonToCodeBlock_wrapButton__XDlEx" data-tooltip-position="top-left" aria-label="右端で折り返す"><img src="./HowToscraping_files/wrap-icon.svg" class="useInsertButtonToCodeBlock_copyIcon__ejNn_"></button></div></div><p data-line="234" class="code-line"><strong>SUUMOのrobots.txtの重要ポイント</strong>:</p>
<table data-line="236" class="code-line">
<thead data-line="236" class="code-line">
<tr data-line="236" class="code-line">
<th>項目</th>
<th>内容</th>
</tr>
</thead>
<tbody data-line="238" class="code-line">
<tr data-line="238" class="code-line">
<td><strong>Disallowされているパス</strong></td>
<td>
<code>/edit/</code>、<code>/mb/</code>、<code>/jj/</code>配下の多数のパス、印刷ページ、API、内部機能</td>
</tr>
<tr data-line="239" class="code-line">
<td><strong>賃貸物件詳細ページ</strong></td>
<td>
<code>/chintai/tokyo/sc_xxxxx/</code>のような通常の物件ページは<strong>明示的にDisallowされていない</strong>
</td>
</tr>
<tr data-line="240" class="code-line">
<td><strong>Crawl-delay</strong></td>
<td>bingbotには<strong>30秒の待機</strong>が指定されている</td>
</tr>
<tr data-line="241" class="code-line">
<td><strong>許可されているパス</strong></td>
<td>
<code>/journal/</code>（Googlebot、bingbot等に許可）</td>
</tr>
</tbody>
</table>
<p data-line="243" class="code-line"><strong>重要な注意点</strong>:</p>
<ol data-line="245" class="code-line">
<li data-line="245" class="code-line">
<p data-line="245" class="code-line"><strong>Crawl-delay: 30</strong> - bingbotには30秒の待機が指定されています。これはSUUMOがクローラーに対して「30秒間隔でアクセスしてほしい」という意思表示です。一般的なスクレイピングでも、この値を参考に十分な間隔を空けるべきです。</p>
</li>
<li data-line="247" class="code-line">
<p data-line="247" class="code-line"><strong>物件詳細ページについて</strong> - 通常の物件詳細ページ（<code>/chintai/tokyo/sc_xxxxx/</code>など）は明示的にDisallowされていませんが、これは「許可されている」という意味ではありません。</p>
</li>
<li data-line="249" class="code-line">
<p data-line="249" class="code-line"><strong>法的拘束力</strong> - <code>robots.txt</code>は法的拘束力はなく、あくまでサイト運営者の意思表示です。ただし、無視してスクレイピングを行うと、利用規約違反やIPブロックの対象になる可能性があります。</p>
</li>
</ol>
<h4 id="%E5%88%A9%E7%94%A8%E8%A6%8F%E7%B4%84%E3%81%AE%E7%A2%BA%E8%AA%8D" data-line="251" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E5%88%A9%E7%94%A8%E8%A6%8F%E7%B4%84%E3%81%AE%E7%A2%BA%E8%AA%8D" aria-hidden="true"></a> 利用規約の確認</h4>
<p data-line="253" class="code-line">SUUMOの<a href="https://suumo.jp/edit/kiyaku/" target="_blank" rel="nofollow noopener noreferrer">利用規約</a>では、以下の点が明記されています。</p>
<p data-line="255" class="code-line"><strong>第2条（著作権）</strong>:</p>
<blockquote data-line="256" class="code-line">
<p data-line="256" class="code-line">本サイトを通じて提供されるすべてのコンテンツについて、当社の事前の承諾なく<strong>著作権法で定めるユーザー個人の私的利用の範囲を超える使用をしてはならない</strong></p>
</blockquote>
<p data-line="258" class="code-line"><strong>第3条（禁止行為）</strong>:</p>
<blockquote data-line="259" class="code-line">
<p data-line="259" class="code-line">(2) 他のユーザーまたは第三者の著作権、肖像権、その他知的財産権を侵害する行為<br>
(7) <strong>商業目的で利用する行為</strong>（当社が認める場合を除く）</p>
</blockquote>
<p data-line="262" class="code-line"><strong>SUUMOの利用規約のポイント</strong>:</p>
<ul data-line="263" class="code-line">
<li data-line="263" class="code-line">スクレイピング自体を明示的に禁止する条項は見当たらない</li>
<li data-line="264" class="code-line">ただし「<strong>私的利用の範囲を超える使用</strong>」は禁止されている</li>
<li data-line="265" class="code-line">「<strong>商業目的での利用</strong>」は明確に禁止されている</li>
<li data-line="266" class="code-line">著作権侵害となる行為は禁止されている</li>
</ul>
<p data-line="268" class="code-line">つまり、<strong>個人的な物件比較のために数件〜数十件の情報を取得する程度であれば「私的利用の範囲」と解釈できる可能性がありますが、大量のデータ収集や商用利用は明確に利用規約違反</strong>となります</p>
<aside class="msg alert"><span class="msg-symbol">!</span><div class="msg-content">
<p data-line="271" class="code-line"><strong>免責事項</strong>: 本ツールは技術的な学習・研究目的で作成されています。実際にスクレイピングを行う場合は、必ずご自身で利用規約を確認し、自己責任で判断してください。利用規約に違反した場合のトラブルについて、作者は一切の責任を負いません。</p>
</div></aside>
<h3 id="3.-%E3%82%B9%E3%82%AF%E3%83%AC%E3%82%A4%E3%83%94%E3%83%B3%E3%82%B0%E3%81%AE%E3%83%9E%E3%83%8A%E3%83%BC%EF%BC%88%E3%83%99%E3%82%B9%E3%83%88%E3%83%97%E3%83%A9%E3%82%AF%E3%83%86%E3%82%A3%E3%82%B9%EF%BC%89" data-line="274" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#3.-%E3%82%B9%E3%82%AF%E3%83%AC%E3%82%A4%E3%83%94%E3%83%B3%E3%82%B0%E3%81%AE%E3%83%9E%E3%83%8A%E3%83%BC%EF%BC%88%E3%83%99%E3%82%B9%E3%83%88%E3%83%97%E3%83%A9%E3%82%AF%E3%83%86%E3%82%A3%E3%82%B9%EF%BC%89" aria-hidden="true"></a> 3. スクレイピングのマナー（ベストプラクティス）</h3>
<p data-line="276" class="code-line">法的・倫理的に問題のないスクレイピングを行うためのガイドラインです。</p>
<h4 id="%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E9%96%93%E9%9A%94%E3%82%92%E5%8D%81%E5%88%86%E3%81%AB%E7%A9%BA%E3%81%91%E3%82%8B" data-line="278" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E9%96%93%E9%9A%94%E3%82%92%E5%8D%81%E5%88%86%E3%81%AB%E7%A9%BA%E3%81%91%E3%82%8B" aria-hidden="true"></a> アクセス間隔を十分に空ける</h4>
<div class="code-block-container"><div class="useInsertButtonToCodeBlock_codeBlockWrapper___Qokq"><pre class="shiki github-dark" style="background-color:#151e2c;color:#e1e4e8" data-has-button="true"><code class="code-line" data-line="280"><span class="line"><span style="color:#a0aab5"># 悪い例：待機なし</span></span>
<span class="line"><span style="color:#F97583">for</span><span style="color:#E1E4E8"> url </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> urls:</span></span>
<span class="line"><span style="color:#E1E4E8">    scrape(url)  </span><span style="color:#a0aab5"># サーバーに過大な負荷</span></span>
<span class="line"></span>
<span class="line"><span style="color:#a0aab5"># 良い例：十分な間隔を空ける</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> time</span></span>
<span class="line"><span style="color:#F97583">for</span><span style="color:#E1E4E8"> url </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> urls:</span></span>
<span class="line"><span style="color:#E1E4E8">    scrape(url)</span></span>
<span class="line"><span style="color:#E1E4E8">    time.sleep(</span><span style="color:#79B8FF">5</span><span style="color:#E1E4E8">)  </span><span style="color:#a0aab5"># 5秒以上待機を推奨</span></span>
<span class="line"></span></code></pre><button class="useInsertButtonToCodeBlock_copyButton__8Pk5H" data-tooltip-position="top-left" aria-label="クリップボードにコピー"><img src="./HowToscraping_files/copy-icon.svg" class="useInsertButtonToCodeBlock_copyIcon__ejNn_"></button><button class="useInsertButtonToCodeBlock_wrapButton__XDlEx" data-tooltip-position="top-left" aria-label="右端で折り返す"><img src="./HowToscraping_files/wrap-icon.svg" class="useInsertButtonToCodeBlock_copyIcon__ejNn_"></button></div></div><p data-line="292" class="code-line"><strong>推奨間隔の目安</strong>:</p>
<table data-line="294" class="code-line">
<thead data-line="294" class="code-line">
<tr data-line="294" class="code-line">
<th>サイトの指定</th>
<th>推奨間隔</th>
</tr>
</thead>
<tbody data-line="296" class="code-line">
<tr data-line="296" class="code-line">
<td>Crawl-delay指定あり</td>
<td>指定値以上（SUUMOは30秒）</td>
</tr>
<tr data-line="297" class="code-line">
<td>Crawl-delay指定なし</td>
<td>最低5秒以上</td>
</tr>
<tr data-line="298" class="code-line">
<td>保守的に運用する場合</td>
<td>10〜30秒</td>
</tr>
</tbody>
</table>
<aside class="msg message"><span class="msg-symbol">!</span><div class="msg-content">
<p data-line="301" class="code-line"><strong>SUUMOの場合</strong>: robots.txtでbingbotに対して<code>Crawl-delay: 30</code>が指定されています。これはSUUMOがクローラーに「30秒間隔でアクセスしてほしい」と明示している値です。本ツールでは最低2秒の間隔を設定していますが、より安全に運用する場合は<strong>10〜30秒の間隔</strong>を推奨します。</p>
</div></aside>
<h4 id="%E5%90%8C%E6%99%82%E6%8E%A5%E7%B6%9A%E6%95%B0%E3%82%92%E5%88%B6%E9%99%90%E3%81%99%E3%82%8B" data-line="304" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E5%90%8C%E6%99%82%E6%8E%A5%E7%B6%9A%E6%95%B0%E3%82%92%E5%88%B6%E9%99%90%E3%81%99%E3%82%8B" aria-hidden="true"></a> 同時接続数を制限する</h4>
<p data-line="306" class="code-line">複数スレッドで同時にアクセスする場合は、同時接続数を制限してください。</p>
<div class="code-block-container"><div class="useInsertButtonToCodeBlock_codeBlockWrapper___Qokq"><pre class="shiki github-dark" style="background-color:#151e2c;color:#e1e4e8" data-has-button="true"><code class="code-line" data-line="308"><span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> concurrent.futures </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> ThreadPoolExecutor</span></span>
<span class="line"></span>
<span class="line"><span style="color:#a0aab5"># 同時接続数を2〜4に制限</span></span>
<span class="line"><span style="color:#E1E4E8">executor </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ThreadPoolExecutor(</span><span style="color:#FFAB70">max_workers</span><span style="color:#F97583">=</span><span style="color:#79B8FF">2</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span></code></pre><button class="useInsertButtonToCodeBlock_copyButton__8Pk5H" data-tooltip-position="top-left" aria-label="クリップボードにコピー"><img src="./HowToscraping_files/copy-icon.svg" class="useInsertButtonToCodeBlock_copyIcon__ejNn_"></button><button class="useInsertButtonToCodeBlock_wrapButton__XDlEx" data-tooltip-position="top-left" aria-label="右端で折り返す"><img src="./HowToscraping_files/wrap-icon.svg" class="useInsertButtonToCodeBlock_copyIcon__ejNn_"></button></div></div><h4 id="%E9%81%A9%E5%88%87%E3%81%AAuser-agent%E3%82%92%E8%A8%AD%E5%AE%9A%E3%81%99%E3%82%8B" data-line="315" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E9%81%A9%E5%88%87%E3%81%AAuser-agent%E3%82%92%E8%A8%AD%E5%AE%9A%E3%81%99%E3%82%8B" aria-hidden="true"></a> 適切なUser-Agentを設定する</h4>
<p data-line="317" class="code-line">自分が何者かを明示することは、最低限のマナーです。</p>
<div class="code-block-container"><div class="useInsertButtonToCodeBlock_codeBlockWrapper___Qokq"><pre class="shiki github-dark" style="background-color:#151e2c;color:#e1e4e8" data-has-button="true"><code class="code-line" data-line="319"><span class="line"><span style="color:#E1E4E8">headers </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#9ECBFF">    'User-Agent'</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">'Mozilla/5.0 (compatible; MyBot/1.0; +http://example.com/bot)'</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"></span></code></pre><button class="useInsertButtonToCodeBlock_copyButton__8Pk5H" data-tooltip-position="top-left" aria-label="クリップボードにコピー"><img src="./HowToscraping_files/copy-icon.svg" class="useInsertButtonToCodeBlock_copyIcon__ejNn_"></button><button class="useInsertButtonToCodeBlock_wrapButton__XDlEx" data-tooltip-position="top-left" aria-label="右端で折り返す"><img src="./HowToscraping_files/wrap-icon.svg" class="useInsertButtonToCodeBlock_copyIcon__ejNn_"></button></div></div><h4 id="%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E6%99%82%E9%96%93%E5%B8%AF%E3%81%AB%E9%85%8D%E6%85%AE%E3%81%99%E3%82%8B" data-line="325" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E6%99%82%E9%96%93%E5%B8%AF%E3%81%AB%E9%85%8D%E6%85%AE%E3%81%99%E3%82%8B" aria-hidden="true"></a> アクセス時間帯に配慮する</h4>
<ul data-line="327" class="code-line">
<li data-line="327" class="code-line">深夜〜早朝（サーバー負荷が低い時間帯）にアクセスする</li>
<li data-line="328" class="code-line">サービスの繁忙期（引越しシーズンなど）は避ける</li>
</ul>
<h4 id="%E5%BF%85%E8%A6%81%E6%9C%80%E5%B0%8F%E9%99%90%E3%81%AE%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E3%81%BF%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B" data-line="330" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E5%BF%85%E8%A6%81%E6%9C%80%E5%B0%8F%E9%99%90%E3%81%AE%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E3%81%BF%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B" aria-hidden="true"></a> 必要最小限のデータのみ取得する</h4>
<ul data-line="332" class="code-line">
<li data-line="332" class="code-line">不要なページにはアクセスしない</li>
<li data-line="333" class="code-line">一度取得したデータはキャッシュして再利用する</li>
<li data-line="334" class="code-line">全ページを網羅的に取得するような行為は避ける</li>
</ul>
<h3 id="4.-suumo%E3%81%A7%E3%82%B9%E3%82%AF%E3%83%AC%E3%82%A4%E3%83%94%E3%83%B3%E3%82%B0%E3%82%92%E8%A1%8C%E3%81%86%E9%9A%9B%E3%81%AE%E6%B3%A8%E6%84%8F" data-line="336" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#4.-suumo%E3%81%A7%E3%82%B9%E3%82%AF%E3%83%AC%E3%82%A4%E3%83%94%E3%83%B3%E3%82%B0%E3%82%92%E8%A1%8C%E3%81%86%E9%9A%9B%E3%81%AE%E6%B3%A8%E6%84%8F" aria-hidden="true"></a> 4. SUUMOでスクレイピングを行う際の注意</h3>
<h4 id="%E6%9C%AC%E3%83%84%E3%83%BC%E3%83%AB%E3%81%AE%E6%83%B3%E5%AE%9A%E3%83%A6%E3%83%BC%E3%82%B9%E3%82%B1%E3%83%BC%E3%82%B9" data-line="338" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E6%9C%AC%E3%83%84%E3%83%BC%E3%83%AB%E3%81%AE%E6%83%B3%E5%AE%9A%E3%83%A6%E3%83%BC%E3%82%B9%E3%82%B1%E3%83%BC%E3%82%B9" aria-hidden="true"></a> 本ツールの想定ユースケース</h4>
<ol data-line="340" class="code-line">
<li data-line="340" class="code-line">
<strong>個人的な物件比較</strong>: 自分が検討している数件〜数十件の物件情報を整理する</li>
<li data-line="341" class="code-line">
<strong>お気に入り物件の一括管理</strong>: 自分のアカウントに保存した物件を一括でダウンロードする</li>
</ol>
<h4 id="%E4%BB%A5%E4%B8%8B%E3%81%AE%E8%A1%8C%E7%82%BA%E3%81%AF%E7%B5%B6%E5%AF%BE%E3%81%AB%E9%81%BF%E3%81%91%E3%81%A6%E3%81%8F%E3%81%A0%E3%81%95%E3%81%84" data-line="343" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E4%BB%A5%E4%B8%8B%E3%81%AE%E8%A1%8C%E7%82%BA%E3%81%AF%E7%B5%B6%E5%AF%BE%E3%81%AB%E9%81%BF%E3%81%91%E3%81%A6%E3%81%8F%E3%81%A0%E3%81%95%E3%81%84" aria-hidden="true"></a> 以下の行為は絶対に避けてください</h4>
<ul data-line="345" class="code-line">
<li data-line="345" class="code-line">全物件データの網羅的な収集</li>
<li data-line="346" class="code-line">取得したデータの第三者への販売・配布</li>
<li data-line="347" class="code-line">競合サービスの構築を目的としたデータ収集</li>
<li data-line="348" class="code-line">大量のアカウントを作成しての自動アクセス</li>
<li data-line="349" class="code-line">IPアドレスを偽装しての大量アクセス</li>
</ul>
<h2 id="%E4%B8%BB%E8%A6%81%E3%81%AA%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88" data-line="351" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E4%B8%BB%E8%A6%81%E3%81%AA%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88" aria-hidden="true"></a> 主要なコードのポイント</h2>
<p data-line="353" class="code-line">ここからは、実装の詳細を解説します。</p>
<h3 id="1.-%E3%82%B9%E3%82%AF%E3%83%AC%E3%82%A4%E3%83%94%E3%83%B3%E3%82%B0%E5%87%A6%E7%90%86%EF%BC%88suumo.py%EF%BC%89" data-line="355" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#1.-%E3%82%B9%E3%82%AF%E3%83%AC%E3%82%A4%E3%83%94%E3%83%B3%E3%82%B0%E5%87%A6%E7%90%86%EF%BC%88suumo.py%EF%BC%89" aria-hidden="true"></a> 1. スクレイピング処理（suumo.py）</h3>
<p data-line="357" class="code-line">物件情報のスクレイピングを担当するモジュールです。</p>
<h4 id="propertydata-%E3%83%87%E3%83%BC%E3%82%BF%E3%82%AF%E3%83%A9%E3%82%B9" data-line="359" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#propertydata-%E3%83%87%E3%83%BC%E3%82%BF%E3%82%AF%E3%83%A9%E3%82%B9" aria-hidden="true"></a> PropertyData データクラス</h4>
<p data-line="361" class="code-line"><code>dataclass</code>を使って、物件情報を型安全に管理しています。</p>
<div class="code-block-container"><div class="useInsertButtonToCodeBlock_codeBlockWrapper___Qokq"><pre class="shiki github-dark" style="background-color:#151e2c;color:#e1e4e8" data-has-button="true"><code class="code-line" data-line="363"><span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> dataclasses </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> dataclass, field</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> typing </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> Dict, Any, List</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">@dataclass</span></span>
<span class="line"><span style="color:#F97583">class</span><span style="color:#B392F0"> PropertyData</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#9ECBFF">    """Data class for property information"""</span></span>
<span class="line"><span style="color:#E1E4E8">    url: </span><span style="color:#79B8FF">str</span><span style="color:#F97583"> =</span><span style="color:#9ECBFF"> ""</span></span>
<span class="line"><span style="color:#E1E4E8">    property_name: </span><span style="color:#79B8FF">str</span><span style="color:#F97583"> =</span><span style="color:#9ECBFF"> ""</span></span>
<span class="line"><span style="color:#E1E4E8">    rent_cost: </span><span style="color:#79B8FF">str</span><span style="color:#F97583"> =</span><span style="color:#9ECBFF"> ""</span></span>
<span class="line"><span style="color:#E1E4E8">    management_fee: </span><span style="color:#79B8FF">str</span><span style="color:#F97583"> =</span><span style="color:#9ECBFF"> ""</span></span>
<span class="line"><span style="color:#E1E4E8">    deposit: </span><span style="color:#79B8FF">str</span><span style="color:#F97583"> =</span><span style="color:#9ECBFF"> ""</span><span style="color:#a0aab5">      # 敷金</span></span>
<span class="line"><span style="color:#E1E4E8">    key_money: </span><span style="color:#79B8FF">str</span><span style="color:#F97583"> =</span><span style="color:#9ECBFF"> ""</span><span style="color:#a0aab5">    # 礼金</span></span>
<span class="line"><span style="color:#E1E4E8">    guarantee_money: </span><span style="color:#79B8FF">str</span><span style="color:#F97583"> =</span><span style="color:#9ECBFF"> ""</span></span>
<span class="line"><span style="color:#E1E4E8">    depreciation: </span><span style="color:#79B8FF">str</span><span style="color:#F97583"> =</span><span style="color:#9ECBFF"> ""</span></span>
<span class="line"><span style="color:#E1E4E8">    layout: </span><span style="color:#79B8FF">str</span><span style="color:#F97583"> =</span><span style="color:#9ECBFF"> ""</span></span>
<span class="line"><span style="color:#E1E4E8">    area: </span><span style="color:#79B8FF">str</span><span style="color:#F97583"> =</span><span style="color:#9ECBFF"> ""</span></span>
<span class="line"><span style="color:#E1E4E8">    direction: </span><span style="color:#79B8FF">str</span><span style="color:#F97583"> =</span><span style="color:#9ECBFF"> ""</span></span>
<span class="line"><span style="color:#E1E4E8">    building_type: </span><span style="color:#79B8FF">str</span><span style="color:#F97583"> =</span><span style="color:#9ECBFF"> ""</span></span>
<span class="line"><span style="color:#E1E4E8">    age: </span><span style="color:#79B8FF">str</span><span style="color:#F97583"> =</span><span style="color:#9ECBFF"> ""</span></span>
<span class="line"><span style="color:#E1E4E8">    access_info: List[</span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> field(</span><span style="color:#FFAB70">default_factory</span><span style="color:#F97583">=</span><span style="color:#79B8FF">list</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">    location: </span><span style="color:#79B8FF">str</span><span style="color:#F97583"> =</span><span style="color:#9ECBFF"> ""</span></span>
<span class="line"><span style="color:#E1E4E8">    features: </span><span style="color:#79B8FF">str</span><span style="color:#F97583"> =</span><span style="color:#9ECBFF"> ""</span></span>
<span class="line"><span style="color:#E1E4E8">    table_data: Dict[</span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> field(</span><span style="color:#FFAB70">default_factory</span><span style="color:#F97583">=</span><span style="color:#79B8FF">dict</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    def</span><span style="color:#B392F0"> to_dict</span><span style="color:#E1E4E8">(self) -&gt; Dict[</span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">, Any]:</span></span>
<span class="line"><span style="color:#9ECBFF">        """Convert to dictionary for Excel export"""</span></span>
<span class="line"><span style="color:#F97583">        return</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#9ECBFF">            'URL'</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">self</span><span style="color:#E1E4E8">.url,</span></span>
<span class="line"><span style="color:#9ECBFF">            '物件名'</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">self</span><span style="color:#E1E4E8">.property_name,</span></span>
<span class="line"><span style="color:#9ECBFF">            '賃料・初期費用'</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">self</span><span style="color:#E1E4E8">.rent_cost,</span></span>
<span class="line"><span style="color:#9ECBFF">            '管理費・共益費'</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">self</span><span style="color:#E1E4E8">.management_fee,</span></span>
<span class="line"><span style="color:#9ECBFF">            '敷金'</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">self</span><span style="color:#E1E4E8">.deposit,</span></span>
<span class="line"><span style="color:#9ECBFF">            '礼金'</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">self</span><span style="color:#E1E4E8">.key_money,</span></span>
<span class="line"><span style="color:#a0aab5">            # ... 以下省略</span></span>
<span class="line"><span style="color:#E1E4E8">        }</span></span>
<span class="line"></span></code></pre><button class="useInsertButtonToCodeBlock_copyButton__8Pk5H" data-tooltip-position="top-left" aria-label="クリップボードにコピー"><img src="./HowToscraping_files/copy-icon.svg" class="useInsertButtonToCodeBlock_copyIcon__ejNn_"></button><button class="useInsertButtonToCodeBlock_wrapButton__XDlEx" data-tooltip-position="top-left" aria-label="右端で折り返す"><img src="./HowToscraping_files/wrap-icon.svg" class="useInsertButtonToCodeBlock_copyIcon__ejNn_"></button></div></div><p data-line="401" class="code-line"><code>dataclass</code>を使うメリットは以下の通りです。</p>
<ul data-line="403" class="code-line">
<li data-line="403" class="code-line">
<code>__init__</code>、<code>__repr__</code>、<code>__eq__</code>が自動生成される</li>
<li data-line="404" class="code-line">型ヒントによりIDEの補完が効く</li>
<li data-line="405" class="code-line">デフォルト値の設定が簡単</li>
</ul>
<h4 id="url%E6%A4%9C%E8%A8%BC" data-line="407" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#url%E6%A4%9C%E8%A8%BC" aria-hidden="true"></a> URL検証</h4>
<p data-line="409" class="code-line">SUUMOのURLかどうかを正規表現でチェックしています。</p>
<div class="code-block-container"><div class="useInsertButtonToCodeBlock_codeBlockWrapper___Qokq"><pre class="shiki github-dark" style="background-color:#151e2c;color:#e1e4e8" data-has-button="true"><code class="code-line" data-line="411"><span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> re</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">class</span><span style="color:#B392F0"> SuumoScraper</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#79B8FF">    SUUMO_URL_PATTERN</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> re.compile(</span><span style="color:#F97583">r</span><span style="color:#9ECBFF">'</span><span style="color:#79B8FF">^</span><span style="color:#DBEDFF">https</span><span style="color:#F97583">?</span><span style="color:#DBEDFF">://suumo</span><span style="color:#85E89D;font-weight:bold">\.</span><span style="color:#DBEDFF">jp/</span><span style="color:#79B8FF">(?:</span><span style="color:#DBEDFF">chintai</span><span style="color:#F97583">|</span><span style="color:#DBEDFF">juhan</span><span style="color:#79B8FF">)</span><span style="color:#DBEDFF">/</span><span style="color:#79B8FF">.</span><span style="color:#F97583">*</span><span style="color:#9ECBFF">'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">    @</span><span style="color:#79B8FF">staticmethod</span></span>
<span class="line"><span style="color:#F97583">    def</span><span style="color:#B392F0"> validate_url</span><span style="color:#E1E4E8">(url: </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">) -&gt; </span><span style="color:#79B8FF">bool</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#9ECBFF">        """Validate if URL is a SUUMO property URL"""</span></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#F97583"> not</span><span style="color:#E1E4E8"> url:</span></span>
<span class="line"><span style="color:#F97583">            return</span><span style="color:#79B8FF"> False</span></span>
<span class="line"><span style="color:#F97583">        return</span><span style="color:#79B8FF"> bool</span><span style="color:#E1E4E8">(SuumoScraper.</span><span style="color:#79B8FF">SUUMO_URL_PATTERN</span><span style="color:#E1E4E8">.match(url))</span></span>
<span class="line"></span></code></pre><button class="useInsertButtonToCodeBlock_copyButton__8Pk5H" data-tooltip-position="top-left" aria-label="クリップボードにコピー"><img src="./HowToscraping_files/copy-icon.svg" class="useInsertButtonToCodeBlock_copyIcon__ejNn_"></button><button class="useInsertButtonToCodeBlock_wrapButton__XDlEx" data-tooltip-position="top-left" aria-label="右端で折り返す"><img src="./HowToscraping_files/wrap-icon.svg" class="useInsertButtonToCodeBlock_copyIcon__ejNn_"></button></div></div><p data-line="425" class="code-line"><code>chintai</code>（賃貸）と<code>juhan</code>（中古住宅）の両方に対応しています。</p>
<h4 id="html%E8%A7%A3%E6%9E%90%E3%81%AE%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88" data-line="427" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#html%E8%A7%A3%E6%9E%90%E3%81%AE%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88" aria-hidden="true"></a> HTML解析のポイント</h4>
<p data-line="429" class="code-line">BeautifulSoup4を使ったHTML解析の実装例です。</p>
<div class="code-block-container"><div class="useInsertButtonToCodeBlock_codeBlockWrapper___Qokq"><pre class="shiki github-dark" style="background-color:#151e2c;color:#e1e4e8" data-has-button="true"><code class="code-line" data-line="431"><span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> bs4 </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> BeautifulSoup</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> requests</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">class</span><span style="color:#B392F0"> SuumoScraper</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#79B8FF">    DEFAULT_HEADERS</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#9ECBFF">        'User-Agent'</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36'</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#79B8FF">    REQUEST_TIMEOUT</span><span style="color:#F97583"> =</span><span style="color:#79B8FF"> 10</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    def</span><span style="color:#79B8FF"> __init__</span><span style="color:#E1E4E8">(self):</span></span>
<span class="line"><span style="color:#79B8FF">        self</span><span style="color:#E1E4E8">.session </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> requests.Session()</span></span>
<span class="line"><span style="color:#79B8FF">        self</span><span style="color:#E1E4E8">.session.headers.update(</span><span style="color:#79B8FF">self</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">DEFAULT_HEADERS</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    def</span><span style="color:#B392F0"> scrape_property</span><span style="color:#E1E4E8">(self, url: </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">) -&gt; Optional[PropertyData]:</span></span>
<span class="line"><span style="color:#9ECBFF">        """Extract property information from a single URL"""</span></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#F97583"> not</span><span style="color:#79B8FF"> self</span><span style="color:#E1E4E8">.validate_url(url):</span></span>
<span class="line"><span style="color:#F97583">            return</span><span style="color:#79B8FF"> None</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">        response </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> self</span><span style="color:#E1E4E8">.session.get(url, </span><span style="color:#FFAB70">timeout</span><span style="color:#F97583">=</span><span style="color:#79B8FF">self</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">REQUEST_TIMEOUT</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#E1E4E8"> response.status_code </span><span style="color:#F97583">!=</span><span style="color:#79B8FF"> 200</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#F97583">            return</span><span style="color:#79B8FF"> None</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">        soup </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> BeautifulSoup(response.content, </span><span style="color:#9ECBFF">'html.parser'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#a0aab5">        # 各情報を抽出</span></span>
<span class="line"><span style="color:#E1E4E8">        property_data </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> PropertyData(</span></span>
<span class="line"><span style="color:#FFAB70">            url</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">url,</span></span>
<span class="line"><span style="color:#FFAB70">            property_name</span><span style="color:#F97583">=</span><span style="color:#79B8FF">self</span><span style="color:#E1E4E8">._extract_property_name(soup),</span></span>
<span class="line"><span style="color:#FFAB70">            rent_cost</span><span style="color:#F97583">=</span><span style="color:#79B8FF">self</span><span style="color:#E1E4E8">._extract_rent_cost(soup),</span></span>
<span class="line"><span style="color:#a0aab5">            # ... 以下省略</span></span>
<span class="line"><span style="color:#E1E4E8">        )</span></span>
<span class="line"><span style="color:#F97583">        return</span><span style="color:#E1E4E8"> property_data</span></span>
<span class="line"></span></code></pre><button class="useInsertButtonToCodeBlock_copyButton__8Pk5H" data-tooltip-position="top-left" aria-label="クリップボードにコピー"><img src="./HowToscraping_files/copy-icon.svg" class="useInsertButtonToCodeBlock_copyIcon__ejNn_"></button><button class="useInsertButtonToCodeBlock_wrapButton__XDlEx" data-tooltip-position="top-left" aria-label="右端で折り返す"><img src="./HowToscraping_files/wrap-icon.svg" class="useInsertButtonToCodeBlock_copyIcon__ejNn_"></button></div></div><p data-line="466" class="code-line"><strong>ポイント</strong>:</p>
<ul data-line="468" class="code-line">
<li data-line="468" class="code-line">
<code>requests.Session()</code>を使うことで、接続の再利用やCookieの維持が可能</li>
<li data-line="469" class="code-line">
<code>User-Agent</code>を設定しないとブロックされる場合がある</li>
<li data-line="470" class="code-line">タイムアウトを設定してハングアップを防止</li>
</ul>
<h4 id="%E6%83%85%E5%A0%B1%E6%8A%BD%E5%87%BA%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89" data-line="472" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E6%83%85%E5%A0%B1%E6%8A%BD%E5%87%BA%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89" aria-hidden="true"></a> 情報抽出メソッド</h4>
<p data-line="474" class="code-line">SUUMOのHTML構造に合わせてCSSセレクタで情報を抽出します。</p>
<div class="code-block-container"><div class="useInsertButtonToCodeBlock_codeBlockWrapper___Qokq"><pre class="shiki github-dark" style="background-color:#151e2c;color:#e1e4e8" data-has-button="true"><code class="code-line" data-line="476"><span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> _extract_property_name</span><span style="color:#E1E4E8">(self, soup: BeautifulSoup) -&gt; </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#9ECBFF">    """Extract property name"""</span></span>
<span class="line"><span style="color:#E1E4E8">    tag </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> soup.find(</span><span style="color:#9ECBFF">'h1'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">class_</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'section_h1-header-title'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">    return</span><span style="color:#79B8FF"> self</span><span style="color:#E1E4E8">.clean_text(tag.text) </span><span style="color:#F97583">if</span><span style="color:#E1E4E8"> tag </span><span style="color:#F97583">else</span><span style="color:#9ECBFF"> '物件名が見つかりません'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> _extract_deposit_key_money</span><span style="color:#E1E4E8">(self, soup: BeautifulSoup) -&gt; </span><span style="color:#79B8FF">tuple</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#9ECBFF">    """Extract deposit and key money separately"""</span></span>
<span class="line"><span style="color:#E1E4E8">    tag </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> soup.find(</span><span style="color:#9ECBFF">'div'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">class_</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'property_data-title'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">string</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'敷金/礼金'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> tag:</span></span>
<span class="line"><span style="color:#E1E4E8">        body_tag </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> tag.find_next(</span><span style="color:#9ECBFF">'div'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">class_</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'property_data-body'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#E1E4E8"> body_tag:</span></span>
<span class="line"><span style="color:#E1E4E8">            text </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> self</span><span style="color:#E1E4E8">.clean_text(body_tag.text)</span></span>
<span class="line"><span style="color:#a0aab5">            # "敷金 / 礼金" 形式をパース（例: "- / 6.45万円"）</span></span>
<span class="line"><span style="color:#F97583">            if</span><span style="color:#9ECBFF"> '/'</span><span style="color:#F97583"> in</span><span style="color:#E1E4E8"> text:</span></span>
<span class="line"><span style="color:#E1E4E8">                parts </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> text.split(</span><span style="color:#9ECBFF">'/'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">                deposit </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> parts[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">].strip() </span><span style="color:#F97583">if</span><span style="color:#79B8FF"> len</span><span style="color:#E1E4E8">(parts) </span><span style="color:#F97583">&gt;</span><span style="color:#79B8FF"> 0</span><span style="color:#F97583"> else</span><span style="color:#9ECBFF"> '-'</span></span>
<span class="line"><span style="color:#E1E4E8">                key_money </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> parts[</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">].strip() </span><span style="color:#F97583">if</span><span style="color:#79B8FF"> len</span><span style="color:#E1E4E8">(parts) </span><span style="color:#F97583">&gt;</span><span style="color:#79B8FF"> 1</span><span style="color:#F97583"> else</span><span style="color:#9ECBFF"> '-'</span></span>
<span class="line"><span style="color:#F97583">                return</span><span style="color:#E1E4E8"> (deposit, key_money)</span></span>
<span class="line"><span style="color:#F97583">    return</span><span style="color:#E1E4E8"> (</span><span style="color:#9ECBFF">'情報なし'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'情報なし'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span></code></pre><button class="useInsertButtonToCodeBlock_copyButton__8Pk5H" data-tooltip-position="top-left" aria-label="クリップボードにコピー"><img src="./HowToscraping_files/copy-icon.svg" class="useInsertButtonToCodeBlock_copyIcon__ejNn_"></button><button class="useInsertButtonToCodeBlock_wrapButton__XDlEx" data-tooltip-position="top-left" aria-label="右端で折り返す"><img src="./HowToscraping_files/wrap-icon.svg" class="useInsertButtonToCodeBlock_copyIcon__ejNn_"></button></div></div><p data-line="498" class="code-line"><code>find_next()</code>を使って、特定のラベル要素の次にある値要素を取得するパターンは、HTMLテーブルの解析でよく使います。</p>
<h4 id="%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E6%B1%8E%E7%94%A8%E6%8A%BD%E5%87%BA" data-line="500" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E6%B1%8E%E7%94%A8%E6%8A%BD%E5%87%BA" aria-hidden="true"></a> テーブルデータの汎用抽出</h4>
<p data-line="502" class="code-line">SUUMOの物件ページには複数のテーブルがあり、それらを汎用的に抽出するメソッドです。</p>
<div class="code-block-container"><div class="useInsertButtonToCodeBlock_codeBlockWrapper___Qokq"><pre class="shiki github-dark" style="background-color:#151e2c;color:#e1e4e8" data-has-button="true"><code class="code-line" data-line="504"><span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> _extract_table_data</span><span style="color:#E1E4E8">(self, soup: BeautifulSoup) -&gt; Dict[</span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">]:</span></span>
<span class="line"><span style="color:#9ECBFF">    """Extract table data"""</span></span>
<span class="line"><span style="color:#E1E4E8">    extracted_data: Dict[</span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> {}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    for</span><span style="color:#E1E4E8"> row </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> soup.select(</span><span style="color:#9ECBFF">'tr'</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#E1E4E8">        headers </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> row.find_all(</span><span style="color:#9ECBFF">'th'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">        values </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> row.find_all(</span><span style="color:#9ECBFF">'td'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#79B8FF"> len</span><span style="color:#E1E4E8">(headers) </span><span style="color:#F97583">==</span><span style="color:#79B8FF"> 2</span><span style="color:#F97583"> and</span><span style="color:#79B8FF"> len</span><span style="color:#E1E4E8">(values) </span><span style="color:#F97583">&gt;=</span><span style="color:#79B8FF"> 2</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#a0aab5">            # 2列テーブルの場合</span></span>
<span class="line"><span style="color:#E1E4E8">            key1 </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> headers[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">].get_text(</span><span style="color:#FFAB70">strip</span><span style="color:#F97583">=</span><span style="color:#79B8FF">True</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">            key2 </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> headers[</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">].get_text(</span><span style="color:#FFAB70">strip</span><span style="color:#F97583">=</span><span style="color:#79B8FF">True</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">            value1 </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> values[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">].get_text(</span><span style="color:#FFAB70">strip</span><span style="color:#F97583">=</span><span style="color:#79B8FF">True</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">            value2 </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> values[</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">].get_text(</span><span style="color:#FFAB70">strip</span><span style="color:#F97583">=</span><span style="color:#79B8FF">True</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">            extracted_data[key1] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> value1</span></span>
<span class="line"><span style="color:#E1E4E8">            extracted_data[key2] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> value2</span></span>
<span class="line"><span style="color:#F97583">        elif</span><span style="color:#79B8FF"> len</span><span style="color:#E1E4E8">(headers) </span><span style="color:#F97583">==</span><span style="color:#79B8FF"> 1</span><span style="color:#F97583"> and</span><span style="color:#79B8FF"> len</span><span style="color:#E1E4E8">(values) </span><span style="color:#F97583">&gt;=</span><span style="color:#79B8FF"> 1</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#a0aab5">            # 1列テーブルの場合</span></span>
<span class="line"><span style="color:#E1E4E8">            key </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> headers[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">].get_text(</span><span style="color:#FFAB70">strip</span><span style="color:#F97583">=</span><span style="color:#79B8FF">True</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">            if</span><span style="color:#E1E4E8"> values[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">].find(</span><span style="color:#9ECBFF">'li'</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#a0aab5">                # リスト形式の場合は結合</span></span>
<span class="line"><span style="color:#E1E4E8">                value </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> ' '</span><span style="color:#E1E4E8">.join(li.get_text(</span><span style="color:#FFAB70">strip</span><span style="color:#F97583">=</span><span style="color:#79B8FF">True</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> li </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> values[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">].find_all(</span><span style="color:#9ECBFF">'li'</span><span style="color:#E1E4E8">))</span></span>
<span class="line"><span style="color:#F97583">            else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">                value </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> values[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">].get_text(</span><span style="color:#FFAB70">strip</span><span style="color:#F97583">=</span><span style="color:#79B8FF">True</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">            extracted_data[key] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> value</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    return</span><span style="color:#E1E4E8"> extracted_data</span></span>
<span class="line"></span></code></pre><button class="useInsertButtonToCodeBlock_copyButton__8Pk5H" data-tooltip-position="top-left" aria-label="クリップボードにコピー"><img src="./HowToscraping_files/copy-icon.svg" class="useInsertButtonToCodeBlock_copyIcon__ejNn_"></button><button class="useInsertButtonToCodeBlock_wrapButton__XDlEx" data-tooltip-position="top-left" aria-label="右端で折り返す"><img src="./HowToscraping_files/wrap-icon.svg" class="useInsertButtonToCodeBlock_copyIcon__ejNn_"></button></div></div><p data-line="534" class="code-line">このメソッドにより、テーブル形式で表示されている情報（損保、駐車場、仲介手数料など）を一括で取得できます。</p>
<h3 id="2.-selenium%E8%AA%8D%E8%A8%BC%E3%83%A2%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%AB%EF%BC%88auth.py%EF%BC%89" data-line="536" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#2.-selenium%E8%AA%8D%E8%A8%BC%E3%83%A2%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%AB%EF%BC%88auth.py%EF%BC%89" aria-hidden="true"></a> 2. Selenium認証モジュール（auth.py）</h3>
<p data-line="538" class="code-line">SUUMOへのログインとお気に入り物件の取得を担当します。</p>
<h4 id="webdriver%E3%81%AE%E8%A8%AD%E5%AE%9A" data-line="540" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#webdriver%E3%81%AE%E8%A8%AD%E5%AE%9A" aria-hidden="true"></a> WebDriverの設定</h4>
<div class="code-block-container"><div class="useInsertButtonToCodeBlock_codeBlockWrapper___Qokq"><pre class="shiki github-dark" style="background-color:#151e2c;color:#e1e4e8" data-has-button="true"><code class="code-line" data-line="542"><span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> selenium </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> webdriver</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> selenium.webdriver.chrome.options </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> Options</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> selenium.webdriver.chrome.service </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> Service</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> webdriver_manager.chrome </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> ChromeDriverManager</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">class</span><span style="color:#B392F0"> SuumoAuth</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#F97583">    def</span><span style="color:#B392F0"> _create_driver</span><span style="color:#E1E4E8">(self) -&gt; webdriver.Chrome:</span></span>
<span class="line"><span style="color:#9ECBFF">        """Create WebDriver"""</span></span>
<span class="line"><span style="color:#E1E4E8">        options </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> Options()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#79B8FF"> self</span><span style="color:#E1E4E8">.headless:</span></span>
<span class="line"><span style="color:#E1E4E8">            options.add_argument(</span><span style="color:#9ECBFF">"--headless=new"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">        options.add_argument(</span><span style="color:#9ECBFF">"--incognito"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">        options.add_argument(</span><span style="color:#9ECBFF">"--no-sandbox"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">        options.add_argument(</span><span style="color:#9ECBFF">"--disable-dev-shm-usage"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">        options.add_argument(</span><span style="color:#9ECBFF">"--disable-gpu"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">        options.add_argument(</span><span style="color:#9ECBFF">"--window-size=1920,1080"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">        options.add_argument(</span></span>
<span class="line"><span style="color:#9ECBFF">            "--user-agent=Mozilla/5.0 (Windows NT 10.0; Win64; x64) "</span></span>
<span class="line"><span style="color:#9ECBFF">            "AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36"</span></span>
<span class="line"><span style="color:#E1E4E8">        )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">        service </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> Service(ChromeDriverManager().install())</span></span>
<span class="line"><span style="color:#F97583">        return</span><span style="color:#E1E4E8"> webdriver.Chrome(</span><span style="color:#FFAB70">service</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">service, </span><span style="color:#FFAB70">options</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">options)</span></span>
<span class="line"></span></code></pre><button class="useInsertButtonToCodeBlock_copyButton__8Pk5H" data-tooltip-position="top-left" aria-label="クリップボードにコピー"><img src="./HowToscraping_files/copy-icon.svg" class="useInsertButtonToCodeBlock_copyIcon__ejNn_"></button><button class="useInsertButtonToCodeBlock_wrapButton__XDlEx" data-tooltip-position="top-left" aria-label="右端で折り返す"><img src="./HowToscraping_files/wrap-icon.svg" class="useInsertButtonToCodeBlock_copyIcon__ejNn_"></button></div></div><p data-line="570" class="code-line"><strong>設定のポイント</strong>:</p>
<ul data-line="572" class="code-line">
<li data-line="572" class="code-line">
<code>--headless=new</code>: 新しいヘッドレスモード（Chrome 112以降）</li>
<li data-line="573" class="code-line">
<code>--no-sandbox</code>: Docker環境などで必要</li>
<li data-line="574" class="code-line">
<code>--disable-dev-shm-usage</code>: 共有メモリ問題の回避</li>
<li data-line="575" class="code-line">
<code>webdriver-manager</code>: ChromeDriverのバージョン管理を自動化</li>
</ul>
<h4 id="%E3%83%AD%E3%82%B0%E3%82%A4%E3%83%B3%E5%87%A6%E7%90%86" data-line="577" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E3%83%AD%E3%82%B0%E3%82%A4%E3%83%B3%E5%87%A6%E7%90%86" aria-hidden="true"></a> ログイン処理</h4>
<div class="code-block-container"><div class="useInsertButtonToCodeBlock_codeBlockWrapper___Qokq"><pre class="shiki github-dark" style="background-color:#151e2c;color:#e1e4e8" data-has-button="true"><code class="code-line" data-line="579"><span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> selenium.webdriver.common.by </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> By</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> selenium.webdriver.common.keys </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> Keys</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> selenium.webdriver.support.ui </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> WebDriverWait</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> selenium.webdriver.support </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> expected_conditions </span><span style="color:#F97583">as</span><span style="color:#79B8FF"> EC</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> login</span><span style="color:#E1E4E8">(self, email: </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">, password: </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">) -&gt; </span><span style="color:#79B8FF">bool</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#9ECBFF">    """Login to SUUMO"""</span></span>
<span class="line"><span style="color:#79B8FF">    self</span><span style="color:#E1E4E8">.driver </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> self</span><span style="color:#E1E4E8">._create_driver()</span></span>
<span class="line"><span style="color:#79B8FF">    self</span><span style="color:#E1E4E8">.driver.get(</span><span style="color:#79B8FF">self</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">LOGIN_URL</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#a0aab5">    # メールアドレスを入力</span></span>
<span class="line"><span style="color:#E1E4E8">    email_input </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> WebDriverWait(</span><span style="color:#79B8FF">self</span><span style="color:#E1E4E8">.driver, </span><span style="color:#79B8FF">self</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">ELEMENT_TIMEOUT</span><span style="color:#E1E4E8">).until(</span></span>
<span class="line"><span style="color:#79B8FF">        EC</span><span style="color:#E1E4E8">.presence_of_element_located((By.</span><span style="color:#79B8FF">ID</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"mainEmail"</span><span style="color:#E1E4E8">))</span></span>
<span class="line"><span style="color:#E1E4E8">    )</span></span>
<span class="line"><span style="color:#E1E4E8">    email_input.clear()</span></span>
<span class="line"><span style="color:#E1E4E8">    email_input.send_keys(email)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#a0aab5">    # パスワードを入力してログイン</span></span>
<span class="line"><span style="color:#E1E4E8">    password_input </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> WebDriverWait(</span><span style="color:#79B8FF">self</span><span style="color:#E1E4E8">.driver, </span><span style="color:#79B8FF">self</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">ELEMENT_TIMEOUT</span><span style="color:#E1E4E8">).until(</span></span>
<span class="line"><span style="color:#79B8FF">        EC</span><span style="color:#E1E4E8">.presence_of_element_located((By.</span><span style="color:#79B8FF">ID</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"passwordText"</span><span style="color:#E1E4E8">))</span></span>
<span class="line"><span style="color:#E1E4E8">    )</span></span>
<span class="line"><span style="color:#E1E4E8">    password_input.clear()</span></span>
<span class="line"><span style="color:#E1E4E8">    password_input.send_keys(password)</span></span>
<span class="line"><span style="color:#E1E4E8">    password_input.send_keys(Keys.</span><span style="color:#79B8FF">RETURN</span><span style="color:#E1E4E8">)  </span><span style="color:#a0aab5"># Enterキーでログイン</span></span>
<span class="line"></span>
<span class="line"><span style="color:#a0aab5">    # ログイン完了を待機</span></span>
<span class="line"><span style="color:#E1E4E8">    time.sleep(</span><span style="color:#79B8FF">self</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">LOGIN_WAIT_TIME</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#a0aab5">    # ログイン成功の確認</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#9ECBFF"> "login"</span><span style="color:#F97583"> in</span><span style="color:#79B8FF"> self</span><span style="color:#E1E4E8">.driver.current_url.lower():</span></span>
<span class="line"><span style="color:#a0aab5">        # まだログインページにいる場合はエラー</span></span>
<span class="line"><span style="color:#E1E4E8">        error_elements </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> self</span><span style="color:#E1E4E8">.driver.find_elements(By.</span><span style="color:#79B8FF">CLASS_NAME</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"error"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#E1E4E8"> error_elements:</span></span>
<span class="line"><span style="color:#F97583">            raise</span><span style="color:#E1E4E8"> SuumoAuthError(</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"Login failed: </span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">error_elements[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">].text</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    return</span><span style="color:#79B8FF"> True</span></span>
<span class="line"></span></code></pre><button class="useInsertButtonToCodeBlock_copyButton__8Pk5H" data-tooltip-position="top-left" aria-label="クリップボードにコピー"><img src="./HowToscraping_files/copy-icon.svg" class="useInsertButtonToCodeBlock_copyIcon__ejNn_"></button><button class="useInsertButtonToCodeBlock_wrapButton__XDlEx" data-tooltip-position="top-left" aria-label="右端で折り返す"><img src="./HowToscraping_files/wrap-icon.svg" class="useInsertButtonToCodeBlock_copyIcon__ejNn_"></button></div></div><p data-line="618" class="code-line"><strong>ポイント</strong>:</p>
<ul data-line="620" class="code-line">
<li data-line="620" class="code-line">
<code>WebDriverWait</code>と<code>expected_conditions</code>を使った明示的な待機</li>
<li data-line="621" class="code-line">
<code>time.sleep()</code>は避けたいところですが、ログイン処理後のリダイレクト待機には必要な場合がある</li>
<li data-line="622" class="code-line">エラーハンドリングで失敗時の原因を明確に</li>
</ul>
<h4 id="context-manager%E5%AF%BE%E5%BF%9C" data-line="624" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#context-manager%E5%AF%BE%E5%BF%9C" aria-hidden="true"></a> Context Manager対応</h4>
<p data-line="626" class="code-line"><code>with</code>文で使えるようにすることで、リソースの確実な解放を保証します。</p>
<div class="code-block-container"><div class="useInsertButtonToCodeBlock_codeBlockWrapper___Qokq"><pre class="shiki github-dark" style="background-color:#151e2c;color:#e1e4e8" data-has-button="true"><code class="code-line" data-line="628"><span class="line"><span style="color:#F97583">def</span><span style="color:#79B8FF"> __enter__</span><span style="color:#E1E4E8">(self):</span></span>
<span class="line"><span style="color:#F97583">    return</span><span style="color:#79B8FF"> self</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#79B8FF"> __exit__</span><span style="color:#E1E4E8">(self, exc_type, exc_val, exc_tb):</span></span>
<span class="line"><span style="color:#79B8FF">    self</span><span style="color:#E1E4E8">.close()</span></span>
<span class="line"><span style="color:#F97583">    return</span><span style="color:#79B8FF"> False</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> close</span><span style="color:#E1E4E8">(self):</span></span>
<span class="line"><span style="color:#9ECBFF">    """Close WebDriver"""</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#79B8FF"> self</span><span style="color:#E1E4E8">.driver:</span></span>
<span class="line"><span style="color:#F97583">        try</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#79B8FF">            self</span><span style="color:#E1E4E8">.driver.quit()</span></span>
<span class="line"><span style="color:#F97583">        finally</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#79B8FF">            self</span><span style="color:#E1E4E8">.driver </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> None</span></span>
<span class="line"></span></code></pre><button class="useInsertButtonToCodeBlock_copyButton__8Pk5H" data-tooltip-position="top-left" aria-label="クリップボードにコピー"><img src="./HowToscraping_files/copy-icon.svg" class="useInsertButtonToCodeBlock_copyIcon__ejNn_"></button><button class="useInsertButtonToCodeBlock_wrapButton__XDlEx" data-tooltip-position="top-left" aria-label="右端で折り返す"><img src="./HowToscraping_files/wrap-icon.svg" class="useInsertButtonToCodeBlock_copyIcon__ejNn_"></button></div></div><p data-line="645" class="code-line">使用例:</p>
<div class="code-block-container"><div class="useInsertButtonToCodeBlock_codeBlockWrapper___Qokq"><pre class="shiki github-dark" style="background-color:#151e2c;color:#e1e4e8" data-has-button="true"><code class="code-line" data-line="647"><span class="line"><span style="color:#F97583">with</span><span style="color:#E1E4E8"> SuumoAuth(</span><span style="color:#FFAB70">headless</span><span style="color:#F97583">=</span><span style="color:#79B8FF">True</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">as</span><span style="color:#E1E4E8"> auth:</span></span>
<span class="line"><span style="color:#E1E4E8">    auth.login(email, password)</span></span>
<span class="line"><span style="color:#E1E4E8">    urls </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> auth.get_favorite_urls()</span></span>
<span class="line"><span style="color:#a0aab5"># 自動的にWebDriverが閉じられる</span></span>
<span class="line"></span></code></pre><button class="useInsertButtonToCodeBlock_copyButton__8Pk5H" data-tooltip-position="top-left" aria-label="クリップボードにコピー"><img src="./HowToscraping_files/copy-icon.svg" class="useInsertButtonToCodeBlock_copyIcon__ejNn_"></button><button class="useInsertButtonToCodeBlock_wrapButton__XDlEx" data-tooltip-position="top-left" aria-label="右端で折り返す"><img src="./HowToscraping_files/wrap-icon.svg" class="useInsertButtonToCodeBlock_copyIcon__ejNn_"></button></div></div><h3 id="3.-%E3%82%A8%E3%82%AF%E3%82%B9%E3%83%9D%E3%83%BC%E3%83%88%E5%87%A6%E7%90%86%EF%BC%88exporter.py%EF%BC%89" data-line="654" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#3.-%E3%82%A8%E3%82%AF%E3%82%B9%E3%83%9D%E3%83%BC%E3%83%88%E5%87%A6%E7%90%86%EF%BC%88exporter.py%EF%BC%89" aria-hidden="true"></a> 3. エクスポート処理（exporter.py）</h3>
<p data-line="656" class="code-line">pandas を使ったデータ出力の実装です。</p>
<div class="code-block-container"><div class="useInsertButtonToCodeBlock_codeBlockWrapper___Qokq"><pre class="shiki github-dark" style="background-color:#151e2c;color:#e1e4e8" data-has-button="true"><code class="code-line" data-line="658"><span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> io</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> json</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> enum </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> Enum</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> pandas </span><span style="color:#F97583">as</span><span style="color:#E1E4E8"> pd</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">class</span><span style="color:#B392F0"> ExportFormat</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">Enum</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#9ECBFF">    """Export format enum"""</span></span>
<span class="line"><span style="color:#79B8FF">    EXCEL</span><span style="color:#F97583"> =</span><span style="color:#9ECBFF"> "excel"</span></span>
<span class="line"><span style="color:#79B8FF">    CSV</span><span style="color:#F97583"> =</span><span style="color:#9ECBFF"> "csv"</span></span>
<span class="line"><span style="color:#79B8FF">    JSON</span><span style="color:#F97583"> =</span><span style="color:#9ECBFF"> "json"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">class</span><span style="color:#B392F0"> DataExporter</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#B392F0">    @</span><span style="color:#79B8FF">staticmethod</span></span>
<span class="line"><span style="color:#F97583">    def</span><span style="color:#B392F0"> export_to_excel</span><span style="color:#E1E4E8">(data: List[Dict[</span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">, Any]]) -&gt; io.BytesIO:</span></span>
<span class="line"><span style="color:#9ECBFF">        """Export data to Excel format"""</span></span>
<span class="line"><span style="color:#E1E4E8">        df </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> pd.DataFrame(data)</span></span>
<span class="line"><span style="color:#E1E4E8">        output </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> io.BytesIO()</span></span>
<span class="line"><span style="color:#F97583">        with</span><span style="color:#E1E4E8"> pd.ExcelWriter(output, </span><span style="color:#FFAB70">engine</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'openpyxl'</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">as</span><span style="color:#E1E4E8"> writer:</span></span>
<span class="line"><span style="color:#E1E4E8">            df.to_excel(writer, </span><span style="color:#FFAB70">index</span><span style="color:#F97583">=</span><span style="color:#79B8FF">False</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">sheet_name</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'Property Data'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">        output.seek(</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">        return</span><span style="color:#E1E4E8"> output</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">    @</span><span style="color:#79B8FF">staticmethod</span></span>
<span class="line"><span style="color:#F97583">    def</span><span style="color:#B392F0"> export_to_csv</span><span style="color:#E1E4E8">(data: List[Dict[</span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">, Any]], encoding: </span><span style="color:#79B8FF">str</span><span style="color:#F97583"> =</span><span style="color:#9ECBFF"> 'utf-8-sig'</span><span style="color:#E1E4E8">) -&gt; io.BytesIO:</span></span>
<span class="line"><span style="color:#9ECBFF">        """Export data to CSV format"""</span></span>
<span class="line"><span style="color:#E1E4E8">        df </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> pd.DataFrame(data)</span></span>
<span class="line"><span style="color:#E1E4E8">        output </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> io.BytesIO()</span></span>
<span class="line"><span style="color:#E1E4E8">        df.to_csv(output, </span><span style="color:#FFAB70">index</span><span style="color:#F97583">=</span><span style="color:#79B8FF">False</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">encoding</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">encoding)</span></span>
<span class="line"><span style="color:#E1E4E8">        output.seek(</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">        return</span><span style="color:#E1E4E8"> output</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">    @</span><span style="color:#79B8FF">staticmethod</span></span>
<span class="line"><span style="color:#F97583">    def</span><span style="color:#B392F0"> export_to_json</span><span style="color:#E1E4E8">(data: List[Dict[</span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">, Any]], indent: </span><span style="color:#79B8FF">int</span><span style="color:#F97583"> =</span><span style="color:#79B8FF"> 2</span><span style="color:#E1E4E8">) -&gt; io.BytesIO:</span></span>
<span class="line"><span style="color:#9ECBFF">        """Export data to JSON format"""</span></span>
<span class="line"><span style="color:#E1E4E8">        output </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> io.BytesIO()</span></span>
<span class="line"><span style="color:#E1E4E8">        json_str </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> json.dumps(data, </span><span style="color:#FFAB70">ensure_ascii</span><span style="color:#F97583">=</span><span style="color:#79B8FF">False</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">indent</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">indent)</span></span>
<span class="line"><span style="color:#E1E4E8">        output.write(json_str.encode(</span><span style="color:#9ECBFF">'utf-8'</span><span style="color:#E1E4E8">))</span></span>
<span class="line"><span style="color:#E1E4E8">        output.seek(</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">        return</span><span style="color:#E1E4E8"> output</span></span>
<span class="line"></span></code></pre><button class="useInsertButtonToCodeBlock_copyButton__8Pk5H" data-tooltip-position="top-left" aria-label="クリップボードにコピー"><img src="./HowToscraping_files/copy-icon.svg" class="useInsertButtonToCodeBlock_copyIcon__ejNn_"></button><button class="useInsertButtonToCodeBlock_wrapButton__XDlEx" data-tooltip-position="top-left" aria-label="右端で折り返す"><img src="./HowToscraping_files/wrap-icon.svg" class="useInsertButtonToCodeBlock_copyIcon__ejNn_"></button></div></div><p data-line="700" class="code-line"><strong>ポイント</strong>:</p>
<ul data-line="702" class="code-line">
<li data-line="702" class="code-line">
<code>io.BytesIO</code>を使うことで、一時ファイルを作成せずにメモリ上でファイルを生成</li>
<li data-line="703" class="code-line">CSVは<code>utf-8-sig</code>（BOM付きUTF-8）でExcelでの文字化けを防止</li>
<li data-line="704" class="code-line">JSONは<code>ensure_ascii=False</code>で日本語をそのまま出力</li>
</ul>
<h3 id="4.-server-sent-events%EF%BC%88sse%EF%BC%89%E3%81%AB%E3%82%88%E3%82%8B%E9%80%B2%E6%8D%97%E8%A1%A8%E7%A4%BA" data-line="706" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#4.-server-sent-events%EF%BC%88sse%EF%BC%89%E3%81%AB%E3%82%88%E3%82%8B%E9%80%B2%E6%8D%97%E8%A1%A8%E7%A4%BA" aria-hidden="true"></a> 4. Server-Sent Events（SSE）による進捗表示</h3>
<p data-line="708" class="code-line">リアルタイム進捗表示の実装です。WebSocketよりも実装がシンプルで、一方向の通知に適しています。</p>
<h4 id="%E3%83%90%E3%83%83%E3%82%AF%E3%82%A8%E3%83%B3%E3%83%89%E5%AE%9F%E8%A3%85%EF%BC%88routes.py%EF%BC%89" data-line="710" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E3%83%90%E3%83%83%E3%82%AF%E3%82%A8%E3%83%B3%E3%83%89%E5%AE%9F%E8%A3%85%EF%BC%88routes.py%EF%BC%89" aria-hidden="true"></a> バックエンド実装（routes.py）</h4>
<div class="code-block-container"><div class="useInsertButtonToCodeBlock_codeBlockWrapper___Qokq"><pre class="shiki github-dark" style="background-color:#151e2c;color:#e1e4e8" data-has-button="true"><code class="code-line" data-line="712"><span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> concurrent.futures </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> ThreadPoolExecutor</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> flask </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> Response, jsonify</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> threading</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> json</span></span>
<span class="line"></span>
<span class="line"><span style="color:#a0aab5"># タスク管理</span></span>
<span class="line"><span style="color:#E1E4E8">tasks: Dict[</span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">, Dict[</span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">, Any]] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> {}</span></span>
<span class="line"><span style="color:#E1E4E8">tasks_lock </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> threading.Lock()</span></span>
<span class="line"><span style="color:#E1E4E8">executor </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ThreadPoolExecutor(</span><span style="color:#FFAB70">max_workers</span><span style="color:#F97583">=</span><span style="color:#79B8FF">4</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">@api_bp.route</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'/scrape'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">methods</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">[</span><span style="color:#9ECBFF">'POST'</span><span style="color:#E1E4E8">])</span></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> start_scrape</span><span style="color:#E1E4E8">():</span></span>
<span class="line"><span style="color:#9ECBFF">    """Start scraping"""</span></span>
<span class="line"><span style="color:#a0aab5">    # ... URL検証等の処理 ...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#a0aab5">    # タスクIDを生成</span></span>
<span class="line"><span style="color:#E1E4E8">    task_id </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> str</span><span style="color:#E1E4E8">(uuid.uuid4())</span></span>
<span class="line"></span>
<span class="line"><span style="color:#a0aab5">    # タスク情報を初期化</span></span>
<span class="line"><span style="color:#E1E4E8">    tasks[task_id] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#9ECBFF">        'status'</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">'pending'</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">        'urls'</span><span style="color:#E1E4E8">: urls,</span></span>
<span class="line"><span style="color:#9ECBFF">        'progress'</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">        'total'</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">len</span><span style="color:#E1E4E8">(urls),</span></span>
<span class="line"><span style="color:#9ECBFF">        'current_url'</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">''</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">        'results'</span><span style="color:#E1E4E8">: [],</span></span>
<span class="line"><span style="color:#9ECBFF">        'errors'</span><span style="color:#E1E4E8">: [],</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#a0aab5">    # バックグラウンドでスクレイピング実行</span></span>
<span class="line"><span style="color:#E1E4E8">    executor.submit(run_scraping_task, task_id)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    return</span><span style="color:#E1E4E8"> jsonify({</span><span style="color:#9ECBFF">'task_id'</span><span style="color:#E1E4E8">: task_id, </span><span style="color:#9ECBFF">'total'</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">len</span><span style="color:#E1E4E8">(urls)})</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0">@api_bp.route</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'/scrape/stream/&lt;task_id&gt;'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> scrape_stream</span><span style="color:#E1E4E8">(task_id: </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#9ECBFF">    """Server-Sent Events for scraping progress"""</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> task_id </span><span style="color:#F97583">not</span><span style="color:#F97583"> in</span><span style="color:#E1E4E8"> tasks:</span></span>
<span class="line"><span style="color:#F97583">        return</span><span style="color:#E1E4E8"> jsonify({</span><span style="color:#9ECBFF">'error'</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">'Task not found'</span><span style="color:#E1E4E8">}), </span><span style="color:#79B8FF">404</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    def</span><span style="color:#B392F0"> generate</span><span style="color:#E1E4E8">() -&gt; Generator[</span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">None</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">None</span><span style="color:#E1E4E8">]:</span></span>
<span class="line"><span style="color:#E1E4E8">        last_progress </span><span style="color:#F97583">=</span><span style="color:#F97583"> -</span><span style="color:#79B8FF">1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">        while</span><span style="color:#79B8FF"> True</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">            task </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> tasks.get(task_id)</span></span>
<span class="line"><span style="color:#F97583">            if</span><span style="color:#F97583"> not</span><span style="color:#E1E4E8"> task:</span></span>
<span class="line"><span style="color:#F97583">                yield</span><span style="color:#E1E4E8"> format_sse({</span><span style="color:#9ECBFF">'type'</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">'error'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'message'</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">'Task not found'</span><span style="color:#E1E4E8">})</span></span>
<span class="line"><span style="color:#F97583">                break</span></span>
<span class="line"></span>
<span class="line"><span style="color:#a0aab5">            # 進捗が更新されたら送信</span></span>
<span class="line"><span style="color:#F97583">            if</span><span style="color:#E1E4E8"> task[</span><span style="color:#9ECBFF">'progress'</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">!=</span><span style="color:#E1E4E8"> last_progress </span><span style="color:#F97583">or</span><span style="color:#E1E4E8"> task[</span><span style="color:#9ECBFF">'status'</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> [</span><span style="color:#9ECBFF">'completed'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'error'</span><span style="color:#E1E4E8">]:</span></span>
<span class="line"><span style="color:#E1E4E8">                last_progress </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> task[</span><span style="color:#9ECBFF">'progress'</span><span style="color:#E1E4E8">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">                data </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#9ECBFF">                    'type'</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">'progress'</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">                    'status'</span><span style="color:#E1E4E8">: task[</span><span style="color:#9ECBFF">'status'</span><span style="color:#E1E4E8">],</span></span>
<span class="line"><span style="color:#9ECBFF">                    'progress'</span><span style="color:#E1E4E8">: task[</span><span style="color:#9ECBFF">'progress'</span><span style="color:#E1E4E8">],</span></span>
<span class="line"><span style="color:#9ECBFF">                    'total'</span><span style="color:#E1E4E8">: task[</span><span style="color:#9ECBFF">'total'</span><span style="color:#E1E4E8">],</span></span>
<span class="line"><span style="color:#9ECBFF">                    'current_url'</span><span style="color:#E1E4E8">: task[</span><span style="color:#9ECBFF">'current_url'</span><span style="color:#E1E4E8">],</span></span>
<span class="line"><span style="color:#9ECBFF">                    'errors'</span><span style="color:#E1E4E8">: task[</span><span style="color:#9ECBFF">'errors'</span><span style="color:#E1E4E8">]</span></span>
<span class="line"><span style="color:#E1E4E8">                }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">                yield</span><span style="color:#E1E4E8"> format_sse(data)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">                if</span><span style="color:#E1E4E8"> task[</span><span style="color:#9ECBFF">'status'</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> [</span><span style="color:#9ECBFF">'completed'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'error'</span><span style="color:#E1E4E8">]:</span></span>
<span class="line"><span style="color:#F97583">                    break</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">            time.sleep(</span><span style="color:#79B8FF">0.5</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    return</span><span style="color:#E1E4E8"> Response(</span></span>
<span class="line"><span style="color:#E1E4E8">        generate(),</span></span>
<span class="line"><span style="color:#FFAB70">        mimetype</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'text/event-stream'</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#FFAB70">        headers</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{</span></span>
<span class="line"><span style="color:#9ECBFF">            'Cache-Control'</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">'no-cache'</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">            'Connection'</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">'keep-alive'</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">            'X-Accel-Buffering'</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">'no'</span><span style="color:#a0aab5">  # Nginx用</span></span>
<span class="line"><span style="color:#E1E4E8">        }</span></span>
<span class="line"><span style="color:#E1E4E8">    )</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> format_sse</span><span style="color:#E1E4E8">(data: Dict[</span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">, Any]) -&gt; </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#9ECBFF">    """Format data for SSE"""</span></span>
<span class="line"><span style="color:#F97583">    return</span><span style="color:#F97583"> f</span><span style="color:#9ECBFF">"data: </span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">json.dumps(data, </span><span style="color:#FFAB70">ensure_ascii</span><span style="color:#F97583">=</span><span style="color:#79B8FF">False</span><span style="color:#E1E4E8">)</span><span style="color:#79B8FF">}\n\n</span><span style="color:#9ECBFF">"</span></span>
<span class="line"></span></code></pre><button class="useInsertButtonToCodeBlock_copyButton__8Pk5H" data-tooltip-position="top-left" aria-label="クリップボードにコピー"><img src="./HowToscraping_files/copy-icon.svg" class="useInsertButtonToCodeBlock_copyIcon__ejNn_"></button><button class="useInsertButtonToCodeBlock_wrapButton__XDlEx" data-tooltip-position="top-left" aria-label="右端で折り返す"><img src="./HowToscraping_files/wrap-icon.svg" class="useInsertButtonToCodeBlock_copyIcon__ejNn_"></button></div></div><p data-line="799" class="code-line"><strong>SSEのポイント</strong>:</p>
<ul data-line="801" class="code-line">
<li data-line="801" class="code-line">
<code>Content-Type: text/event-stream</code>で接続を維持</li>
<li data-line="802" class="code-line">データは<code>data: </code>プレフィックスと<code>\n\n</code>（2つの改行）で区切る</li>
<li data-line="803" class="code-line">
<code>X-Accel-Buffering: no</code>でNginxのバッファリングを無効化</li>
</ul>
<h4 id="%E3%83%95%E3%83%AD%E3%83%B3%E3%83%88%E3%82%A8%E3%83%B3%E3%83%89%E5%AE%9F%E8%A3%85" data-line="805" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E3%83%95%E3%83%AD%E3%83%B3%E3%83%88%E3%82%A8%E3%83%B3%E3%83%89%E5%AE%9F%E8%A3%85" aria-hidden="true"></a> フロントエンド実装</h4>
<div class="code-block-container"><div class="useInsertButtonToCodeBlock_codeBlockWrapper___Qokq"><pre class="shiki github-dark" style="background-color:#151e2c;color:#e1e4e8" data-has-button="true"><code class="code-line" data-line="807"><span class="line"><span style="color:#F97583">const</span><span style="color:#79B8FF"> eventSource</span><span style="color:#F97583"> =</span><span style="color:#F97583"> new</span><span style="color:#B392F0"> EventSource</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">`/api/scrape/stream/${</span><span style="color:#E1E4E8">taskId</span><span style="color:#9ECBFF">}`</span><span style="color:#E1E4E8">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">eventSource.</span><span style="color:#B392F0">onmessage</span><span style="color:#F97583"> =</span><span style="color:#F97583"> function</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">event</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#F97583">    const</span><span style="color:#79B8FF"> data</span><span style="color:#F97583"> =</span><span style="color:#79B8FF"> JSON</span><span style="color:#E1E4E8">.</span><span style="color:#B392F0">parse</span><span style="color:#E1E4E8">(event.data);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> (data.type </span><span style="color:#F97583">===</span><span style="color:#9ECBFF"> 'progress'</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#a0aab5">        // プログレスバーを更新</span></span>
<span class="line"><span style="color:#F97583">        const</span><span style="color:#79B8FF"> percentage</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> (data.progress </span><span style="color:#F97583">/</span><span style="color:#E1E4E8"> data.total) </span><span style="color:#F97583">*</span><span style="color:#79B8FF"> 100</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">        progressBar.style.width </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> `${</span><span style="color:#E1E4E8">percentage</span><span style="color:#9ECBFF">}%`</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">        progressBar.textContent </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> `${</span><span style="color:#E1E4E8">data</span><span style="color:#9ECBFF">.</span><span style="color:#E1E4E8">progress</span><span style="color:#9ECBFF">}/${</span><span style="color:#E1E4E8">data</span><span style="color:#9ECBFF">.</span><span style="color:#E1E4E8">total</span><span style="color:#9ECBFF">}`</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#a0aab5">        // 現在処理中のURLを表示</span></span>
<span class="line"><span style="color:#E1E4E8">        currentUrlText.textContent </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> data.current_url;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#E1E4E8"> (data.status </span><span style="color:#F97583">===</span><span style="color:#9ECBFF"> 'completed'</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#E1E4E8">            eventSource.</span><span style="color:#B392F0">close</span><span style="color:#E1E4E8">();</span></span>
<span class="line"><span style="color:#a0aab5">            // ダウンロードボタンを有効化</span></span>
<span class="line"><span style="color:#E1E4E8">        }</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#E1E4E8">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">eventSource.</span><span style="color:#B392F0">onerror</span><span style="color:#F97583"> =</span><span style="color:#F97583"> function</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">error</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#E1E4E8">    eventSource.</span><span style="color:#B392F0">close</span><span style="color:#E1E4E8">();</span></span>
<span class="line"><span style="color:#a0aab5">    // エラー処理</span></span>
<span class="line"><span style="color:#E1E4E8">};</span></span>
<span class="line"></span></code></pre><button class="useInsertButtonToCodeBlock_copyButton__8Pk5H" data-tooltip-position="top-left" aria-label="クリップボードにコピー"><img src="./HowToscraping_files/copy-icon.svg" class="useInsertButtonToCodeBlock_copyIcon__ejNn_"></button><button class="useInsertButtonToCodeBlock_wrapButton__XDlEx" data-tooltip-position="top-left" aria-label="右端で折り返す"><img src="./HowToscraping_files/wrap-icon.svg" class="useInsertButtonToCodeBlock_copyIcon__ejNn_"></button></div></div><h3 id="5.-%E3%82%B9%E3%82%AF%E3%83%AC%E3%82%A4%E3%83%94%E3%83%B3%E3%82%B0%E3%82%BF%E3%82%B9%E3%82%AF%E3%81%AE%E4%B8%A6%E5%88%97%E5%AE%9F%E8%A1%8C" data-line="835" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#5.-%E3%82%B9%E3%82%AF%E3%83%AC%E3%82%A4%E3%83%94%E3%83%B3%E3%82%B0%E3%82%BF%E3%82%B9%E3%82%AF%E3%81%AE%E4%B8%A6%E5%88%97%E5%AE%9F%E8%A1%8C" aria-hidden="true"></a> 5. スクレイピングタスクの並列実行</h3>
<div class="code-block-container"><div class="useInsertButtonToCodeBlock_codeBlockWrapper___Qokq"><pre class="shiki github-dark" style="background-color:#151e2c;color:#e1e4e8" data-has-button="true"><code class="code-line" data-line="837"><span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> concurrent.futures </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> ThreadPoolExecutor</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">executor </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ThreadPoolExecutor(</span><span style="color:#FFAB70">max_workers</span><span style="color:#F97583">=</span><span style="color:#79B8FF">4</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> run_scraping_task</span><span style="color:#E1E4E8">(task_id: </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">) -&gt; </span><span style="color:#79B8FF">None</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#9ECBFF">    """Run scraping in background"""</span></span>
<span class="line"><span style="color:#E1E4E8">    task </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> tasks.get(task_id)</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#F97583"> not</span><span style="color:#E1E4E8"> task:</span></span>
<span class="line"><span style="color:#F97583">        return</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">    task[</span><span style="color:#9ECBFF">'status'</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> 'running'</span></span>
<span class="line"><span style="color:#E1E4E8">    scraper </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> SuumoScraper()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    for</span><span style="color:#E1E4E8"> i, url </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> enumerate</span><span style="color:#E1E4E8">(task[</span><span style="color:#9ECBFF">'urls'</span><span style="color:#E1E4E8">]):</span></span>
<span class="line"><span style="color:#E1E4E8">        task[</span><span style="color:#9ECBFF">'current_url'</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> url</span></span>
<span class="line"><span style="color:#E1E4E8">        task[</span><span style="color:#9ECBFF">'progress'</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> i</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">        try</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">            result </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> scraper.scrape_property(url)</span></span>
<span class="line"><span style="color:#F97583">            if</span><span style="color:#E1E4E8"> result:</span></span>
<span class="line"><span style="color:#E1E4E8">                task[</span><span style="color:#9ECBFF">'results'</span><span style="color:#E1E4E8">].append(result)</span></span>
<span class="line"><span style="color:#F97583">            else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">                task[</span><span style="color:#9ECBFF">'errors'</span><span style="color:#E1E4E8">].append({</span></span>
<span class="line"><span style="color:#9ECBFF">                    'url'</span><span style="color:#E1E4E8">: url,</span></span>
<span class="line"><span style="color:#9ECBFF">                    'error'</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">'Could not get property info'</span></span>
<span class="line"><span style="color:#E1E4E8">                })</span></span>
<span class="line"><span style="color:#F97583">        except</span><span style="color:#E1E4E8"> SuumoScraperError </span><span style="color:#F97583">as</span><span style="color:#E1E4E8"> e:</span></span>
<span class="line"><span style="color:#E1E4E8">            task[</span><span style="color:#9ECBFF">'errors'</span><span style="color:#E1E4E8">].append({</span></span>
<span class="line"><span style="color:#9ECBFF">                'url'</span><span style="color:#E1E4E8">: url,</span></span>
<span class="line"><span style="color:#9ECBFF">                'error'</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">(e)</span></span>
<span class="line"><span style="color:#E1E4E8">            })</span></span>
<span class="line"></span>
<span class="line"><span style="color:#a0aab5">        # 最後のURL以外は待機（スクレイピングマナー）</span></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">&lt;</span><span style="color:#79B8FF"> len</span><span style="color:#E1E4E8">(task[</span><span style="color:#9ECBFF">'urls'</span><span style="color:#E1E4E8">]) </span><span style="color:#F97583">-</span><span style="color:#79B8FF"> 1</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">            time.sleep(task[</span><span style="color:#9ECBFF">'delay'</span><span style="color:#E1E4E8">])</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">    task[</span><span style="color:#9ECBFF">'status'</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> 'completed'</span></span>
<span class="line"><span style="color:#E1E4E8">    task[</span><span style="color:#9ECBFF">'progress'</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> len</span><span style="color:#E1E4E8">(task[</span><span style="color:#9ECBFF">'urls'</span><span style="color:#E1E4E8">])</span></span>
<span class="line"></span></code></pre><button class="useInsertButtonToCodeBlock_copyButton__8Pk5H" data-tooltip-position="top-left" aria-label="クリップボードにコピー"><img src="./HowToscraping_files/copy-icon.svg" class="useInsertButtonToCodeBlock_copyIcon__ejNn_"></button><button class="useInsertButtonToCodeBlock_wrapButton__XDlEx" data-tooltip-position="top-left" aria-label="右端で折り返す"><img src="./HowToscraping_files/wrap-icon.svg" class="useInsertButtonToCodeBlock_copyIcon__ejNn_"></button></div></div><p data-line="878" class="code-line"><strong>ポイント</strong>:</p>
<ul data-line="880" class="code-line">
<li data-line="880" class="code-line">
<code>ThreadPoolExecutor</code>で複数タスクを並列管理</li>
<li data-line="881" class="code-line">各URL処理間に2秒のディレイを設けてサーバー負荷を軽減</li>
<li data-line="882" class="code-line">エラーが発生しても処理を継続し、最終的にまとめてレポート</li>
</ul>
<h2 id="%E5%AE%9F%E8%A3%85%E3%81%A7%E5%B7%A5%E5%A4%AB%E3%81%97%E3%81%9F%E7%82%B9%E3%83%BB%E6%B3%A8%E6%84%8F%E7%82%B9" data-line="884" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E5%AE%9F%E8%A3%85%E3%81%A7%E5%B7%A5%E5%A4%AB%E3%81%97%E3%81%9F%E7%82%B9%E3%83%BB%E6%B3%A8%E6%84%8F%E7%82%B9" aria-hidden="true"></a> 実装で工夫した点・注意点</h2>
<h3 id="%E3%82%B9%E3%82%AF%E3%83%AC%E3%82%A4%E3%83%94%E3%83%B3%E3%82%B0%E3%83%9E%E3%83%8A%E3%83%BC" data-line="886" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E3%82%B9%E3%82%AF%E3%83%AC%E3%82%A4%E3%83%94%E3%83%B3%E3%82%B0%E3%83%9E%E3%83%8A%E3%83%BC" aria-hidden="true"></a> スクレイピングマナー</h3>
<ul data-line="888" class="code-line">
<li data-line="888" class="code-line">各URL処理間に2秒の待機時間を設定（設定で1〜10秒に変更可能）</li>
<li data-line="889" class="code-line">同時リクエスト数を制限</li>
<li data-line="890" class="code-line">適切なUser-Agentを設定</li>
</ul>
<div class="code-block-container"><div class="useInsertButtonToCodeBlock_codeBlockWrapper___Qokq"><pre class="shiki github-dark" style="background-color:#151e2c;color:#e1e4e8" data-has-button="true"><code class="code-line" data-line="892"><span class="line"><span style="color:#a0aab5"># routes.py</span></span>
<span class="line"><span style="color:#79B8FF">MIN_DELAY</span><span style="color:#F97583"> =</span><span style="color:#79B8FF"> 1</span></span>
<span class="line"><span style="color:#79B8FF">MAX_DELAY</span><span style="color:#F97583"> =</span><span style="color:#79B8FF"> 10</span></span>
<span class="line"></span>
<span class="line"><span style="color:#a0aab5"># 待機時間のバリデーション</span></span>
<span class="line"><span style="color:#F97583">try</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">    delay </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> int</span><span style="color:#E1E4E8">(delay)</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> delay </span><span style="color:#F97583">&lt;</span><span style="color:#79B8FF"> MIN_DELAY</span><span style="color:#F97583"> or</span><span style="color:#E1E4E8"> delay </span><span style="color:#F97583">&gt;</span><span style="color:#79B8FF"> MAX_DELAY</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#F97583">        return</span><span style="color:#E1E4E8"> jsonify({</span></span>
<span class="line"><span style="color:#9ECBFF">            'error'</span><span style="color:#E1E4E8">: </span><span style="color:#F97583">f</span><span style="color:#9ECBFF">'Delay must be between </span><span style="color:#79B8FF">{MIN_DELAY}</span><span style="color:#9ECBFF"> and </span><span style="color:#79B8FF">{MAX_DELAY}</span><span style="color:#9ECBFF"> seconds'</span></span>
<span class="line"><span style="color:#E1E4E8">        }), </span><span style="color:#79B8FF">400</span></span>
<span class="line"><span style="color:#F97583">except</span><span style="color:#E1E4E8"> (</span><span style="color:#79B8FF">TypeError</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">ValueError</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#E1E4E8">    delay </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> 2</span><span style="color:#a0aab5">  # デフォルト値</span></span>
<span class="line"></span></code></pre><button class="useInsertButtonToCodeBlock_copyButton__8Pk5H" data-tooltip-position="top-left" aria-label="クリップボードにコピー"><img src="./HowToscraping_files/copy-icon.svg" class="useInsertButtonToCodeBlock_copyIcon__ejNn_"></button><button class="useInsertButtonToCodeBlock_wrapButton__XDlEx" data-tooltip-position="top-left" aria-label="右端で折り返す"><img src="./HowToscraping_files/wrap-icon.svg" class="useInsertButtonToCodeBlock_copyIcon__ejNn_"></button></div></div><h3 id="%E3%82%A8%E3%83%A9%E3%83%BC%E3%83%8F%E3%83%B3%E3%83%89%E3%83%AA%E3%83%B3%E3%82%B0" data-line="908" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E3%82%A8%E3%83%A9%E3%83%BC%E3%83%8F%E3%83%B3%E3%83%89%E3%83%AA%E3%83%B3%E3%82%B0" aria-hidden="true"></a> エラーハンドリング</h3>
<p data-line="910" class="code-line">カスタム例外を定義して、エラーの種類を明確にしています。</p>
<div class="code-block-container"><div class="useInsertButtonToCodeBlock_codeBlockWrapper___Qokq"><pre class="shiki github-dark" style="background-color:#151e2c;color:#e1e4e8" data-has-button="true"><code class="code-line" data-line="912"><span class="line"><span style="color:#F97583">class</span><span style="color:#B392F0"> SuumoScraperError</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">Exception</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#9ECBFF">    """Custom exception for scraping errors"""</span></span>
<span class="line"><span style="color:#F97583">    pass</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">class</span><span style="color:#B392F0"> SuumoAuthError</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">Exception</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#9ECBFF">    """Custom exception for authentication errors"""</span></span>
<span class="line"><span style="color:#F97583">    pass</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">class</span><span style="color:#B392F0"> ExportError</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">Exception</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#9ECBFF">    """Custom exception for export errors"""</span></span>
<span class="line"><span style="color:#F97583">    pass</span></span>
<span class="line"></span></code></pre><button class="useInsertButtonToCodeBlock_copyButton__8Pk5H" data-tooltip-position="top-left" aria-label="クリップボードにコピー"><img src="./HowToscraping_files/copy-icon.svg" class="useInsertButtonToCodeBlock_copyIcon__ejNn_"></button><button class="useInsertButtonToCodeBlock_wrapButton__XDlEx" data-tooltip-position="top-left" aria-label="右端で折り返す"><img src="./HowToscraping_files/wrap-icon.svg" class="useInsertButtonToCodeBlock_copyIcon__ejNn_"></button></div></div><p data-line="926" class="code-line">これにより、APIレスポンスで適切なHTTPステータスコードを返せます。</p>
<div class="code-block-container"><div class="useInsertButtonToCodeBlock_codeBlockWrapper___Qokq"><pre class="shiki github-dark" style="background-color:#151e2c;color:#e1e4e8" data-has-button="true"><code class="code-line" data-line="928"><span class="line"><span style="color:#F97583">try</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">    urls </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> get_favorites_with_login(email, password, </span><span style="color:#FFAB70">headless</span><span style="color:#F97583">=</span><span style="color:#79B8FF">True</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">    return</span><span style="color:#E1E4E8"> jsonify({</span><span style="color:#9ECBFF">'urls'</span><span style="color:#E1E4E8">: urls, </span><span style="color:#9ECBFF">'count'</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">len</span><span style="color:#E1E4E8">(urls)})</span></span>
<span class="line"><span style="color:#F97583">except</span><span style="color:#E1E4E8"> SuumoAuthError </span><span style="color:#F97583">as</span><span style="color:#E1E4E8"> e:</span></span>
<span class="line"><span style="color:#F97583">    return</span><span style="color:#E1E4E8"> jsonify({</span><span style="color:#9ECBFF">'error'</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">str</span><span style="color:#E1E4E8">(e)}), </span><span style="color:#79B8FF">401</span><span style="color:#a0aab5">  # 認証エラー</span></span>
<span class="line"><span style="color:#F97583">except</span><span style="color:#79B8FF"> Exception</span><span style="color:#F97583"> as</span><span style="color:#E1E4E8"> e:</span></span>
<span class="line"><span style="color:#F97583">    return</span><span style="color:#E1E4E8"> jsonify({</span><span style="color:#9ECBFF">'error'</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">'Failed to get favorites'</span><span style="color:#E1E4E8">}), </span><span style="color:#79B8FF">500</span><span style="color:#a0aab5">  # サーバーエラー</span></span>
<span class="line"></span></code></pre><button class="useInsertButtonToCodeBlock_copyButton__8Pk5H" data-tooltip-position="top-left" aria-label="クリップボードにコピー"><img src="./HowToscraping_files/copy-icon.svg" class="useInsertButtonToCodeBlock_copyIcon__ejNn_"></button><button class="useInsertButtonToCodeBlock_wrapButton__XDlEx" data-tooltip-position="top-left" aria-label="右端で折り返す"><img src="./HowToscraping_files/wrap-icon.svg" class="useInsertButtonToCodeBlock_copyIcon__ejNn_"></button></div></div><h3 id="%E3%82%BF%E3%82%B9%E3%82%AF%E3%81%AE%E6%9C%89%E5%8A%B9%E6%9C%9F%E9%99%90%E7%AE%A1%E7%90%86" data-line="938" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E3%82%BF%E3%82%B9%E3%82%AF%E3%81%AE%E6%9C%89%E5%8A%B9%E6%9C%9F%E9%99%90%E7%AE%A1%E7%90%86" aria-hidden="true"></a> タスクの有効期限管理</h3>
<p data-line="940" class="code-line">長時間放置されたタスクを自動削除してメモリリークを防止します。</p>
<div class="code-block-container"><div class="useInsertButtonToCodeBlock_codeBlockWrapper___Qokq"><pre class="shiki github-dark" style="background-color:#151e2c;color:#e1e4e8" data-has-button="true"><code class="code-line" data-line="942"><span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> datetime </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> datetime, timedelta</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF">TASK_EXPIRY_HOURS</span><span style="color:#F97583"> =</span><span style="color:#79B8FF"> 1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> cleanup_old_tasks</span><span style="color:#E1E4E8">():</span></span>
<span class="line"><span style="color:#9ECBFF">    """Remove tasks older than TASK_EXPIRY_HOURS"""</span></span>
<span class="line"><span style="color:#E1E4E8">    expiry_time </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> datetime.now() </span><span style="color:#F97583">-</span><span style="color:#E1E4E8"> timedelta(</span><span style="color:#FFAB70">hours</span><span style="color:#F97583">=</span><span style="color:#79B8FF">TASK_EXPIRY_HOURS</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">    with</span><span style="color:#E1E4E8"> tasks_lock:</span></span>
<span class="line"><span style="color:#E1E4E8">        expired </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span></span>
<span class="line"><span style="color:#E1E4E8">            task_id </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> task_id, task </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> tasks.items()</span></span>
<span class="line"><span style="color:#F97583">            if</span><span style="color:#E1E4E8"> task.get(</span><span style="color:#9ECBFF">'completed_at'</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">and</span></span>
<span class="line"><span style="color:#E1E4E8">            datetime.fromisoformat(task[</span><span style="color:#9ECBFF">'completed_at'</span><span style="color:#E1E4E8">]) </span><span style="color:#F97583">&lt;</span><span style="color:#E1E4E8"> expiry_time</span></span>
<span class="line"><span style="color:#E1E4E8">        ]</span></span>
<span class="line"><span style="color:#F97583">        for</span><span style="color:#E1E4E8"> task_id </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> expired:</span></span>
<span class="line"><span style="color:#F97583">            del</span><span style="color:#E1E4E8"> tasks[task_id]</span></span>
<span class="line"></span></code></pre><button class="useInsertButtonToCodeBlock_copyButton__8Pk5H" data-tooltip-position="top-left" aria-label="クリップボードにコピー"><img src="./HowToscraping_files/copy-icon.svg" class="useInsertButtonToCodeBlock_copyIcon__ejNn_"></button><button class="useInsertButtonToCodeBlock_wrapButton__XDlEx" data-tooltip-position="top-left" aria-label="右端で折り返す"><img src="./HowToscraping_files/wrap-icon.svg" class="useInsertButtonToCodeBlock_copyIcon__ejNn_"></button></div></div><h2 id="%E3%81%BE%E3%81%A8%E3%82%81" data-line="960" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E3%81%BE%E3%81%A8%E3%82%81" aria-hidden="true"></a> まとめ</h2>
<p data-line="962" class="code-line">このツールを通じて、以下の技術を実践的に学べます。</p>
<ul data-line="964" class="code-line">
<li data-line="964" class="code-line">
<strong>BeautifulSoup4</strong> によるHTML解析とCSSセレクタの活用</li>
<li data-line="965" class="code-line">
<strong>Selenium</strong> を使ったブラウザ自動化とログイン処理</li>
<li data-line="966" class="code-line">
<strong>Flask</strong> でのAPIエンドポイント設計</li>
<li data-line="967" class="code-line">
<strong>Server-Sent Events</strong> によるリアルタイム通信</li>
<li data-line="968" class="code-line">
<strong>ThreadPoolExecutor</strong> を使った並列処理</li>
<li data-line="969" class="code-line">
<strong>pandas</strong> によるデータ出力</li>
</ul>
<p data-line="971" class="code-line">実際に動くコードを読みながら、ぜひ自分のプロジェクトにも応用してみてください。</p>
<p data-line="973" class="code-line"><strong>リポジトリ</strong>: <a href="https://github.com/yamato-snow/2025-12-07_sumo-scraping" target="_blank" rel="nofollow noopener noreferrer">https://github.com/yamato-snow/2025-12-07_sumo-scraping</a></p>
<h3 id="%E9%87%8D%E8%A6%81%E3%81%AA%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A0%85" data-line="975" class="code-line">
<a class="header-anchor-link" href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E9%87%8D%E8%A6%81%E3%81%AA%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A0%85" aria-hidden="true"></a> 重要な注意事項</h3>
<aside class="msg alert"><span class="msg-symbol">!</span><div class="msg-content">
<p data-line="978" class="code-line"><strong>法的リスクについて</strong></p>
<p data-line="980" class="code-line">スクレイピングは、やり方によっては法律に抵触する可能性があります。本ツールを使用する前に、必ず「スクレイピングを始める前に知っておくべきこと」セクションを熟読してください。</p>
<ul data-line="982" class="code-line">
<li data-line="982" class="code-line">
<strong>不正アクセス禁止法</strong>: アクセス制限の回避は違法です</li>
<li data-line="983" class="code-line">
<strong>著作権法</strong>: 取得データの再配布・商用利用は著作権侵害です</li>
<li data-line="984" class="code-line">
<strong>業務妨害罪</strong>: サーバーへの過度な負荷は犯罪になり得ます</li>
</ul>
</div></aside>
<p data-line="987" class="code-line"><strong>利用上の注意</strong>:</p>
<ul data-line="989" class="code-line">
<li data-line="989" class="code-line">
<strong>利用規約の遵守</strong>: SUUMOの利用規約を必ず確認し、遵守してください</li>
<li data-line="990" class="code-line">
<strong>robots.txt の確認</strong>: <code>https://suumo.jp/robots.txt</code> を確認してください</li>
<li data-line="991" class="code-line">
<strong>スクレイピングマナー</strong>: 各リクエスト間に最低2秒以上の間隔を空けてください</li>
<li data-line="992" class="code-line">
<strong>HTML構造変更</strong>: SUUMOのHTML構造が変更された場合、セレクタの更新が必要になる可能性があります</li>
<li data-line="993" class="code-line">
<strong>利用目的</strong>: 本ツールは個人的な物件比較・学習目的での使用を想定しています</li>
<li data-line="994" class="code-line">
<strong>自己責任</strong>: 本ツールの使用によって生じたいかなる損害についても、作者は責任を負いません</li>
</ul>
<p data-line="996" class="code-line"><strong>このツールを使用してはいけない場合</strong>:</p>
<ul data-line="998" class="code-line">
<li data-line="998" class="code-line">商用目的でのデータ収集</li>
<li data-line="999" class="code-line">大量のデータを網羅的に収集する目的</li>
<li data-line="1000" class="code-line">取得したデータを第三者に提供・販売する目的</li>
<li data-line="1001" class="code-line">SUUMOの利用規約に違反する行為</li>
</ul>
</div><div class="View_actions__s_UJk" id="share"><div class="LikeButton_container__YlckE style-large"><button aria-label="いいね" class="LikeButton_button__ZwdG4" data-pressed="false"><svg class="LikeButton_svgLike__Gl0Sz" viewBox="0 0 110 110"><path class="LikeButton_svgLikeLine__f9txR" d="M73,24a23.78,23.78,0,0,0-15.89,6.19,3.14,3.14,0,0,1-4.18,0A23.81,23.81,0,0,0,37,24a22,22,0,0,0-22,22c0,16.67,19.64,32.82,25.11,37.93,2.84,2.65,6.15,5.64,8.92,8.13a8.9,8.9,0,0,0,11.9,0c2.77-2.49,6.07-5.48,8.91-8.13C75.37,78.81,95,62.66,95,46A22,22,0,0,0,73,24Z" fill="currentColor"></path><path class="LikeButton_svgLikeInner__uiexS" d="M66.25,76.42c-.71.64-1.32,1.2-1.82,1.67-2.51,2.33-5.39,5-7.94,7.25a2.21,2.21,0,0,1-3,0C51,83,48.1,80.42,45.59,78.09c-.5-.47-1.12-1-1.82-1.67C38.09,71.29,23,57.67,23,46A14,14,0,0,1,37,32a15.92,15.92,0,0,1,11.65,5.23l4.73,5a2.2,2.2,0,0,0,3.23,0l4.72-5A16.06,16.06,0,0,1,73,32,14,14,0,0,1,87,46C87,57.67,71.93,71.29,66.25,76.42Z" fill="currentColor"></path><g class="LikeButton_svgLikeDecoration__78UjB"><circle cx="41.5" cy="9.5" fill="#3ea8ff" r="3.5"></circle><circle cx="98.5" cy="26.5" fill="#ffdc6e" r="3.5"></circle><circle cx="13" cy="19" fill="#c067f4" r="5"></circle><circle cx="77" cy="9" fill="#f76685" r="5"></circle><circle cx="26.5" cy="92.5" fill="#f76685" r="3.5"></circle><circle cx="105.5" cy="48.5" fill="#c067f4" r="3.5"></circle><circle cx="4.5" cy="60.5" fill="#3ea8ff" r="3.5"></circle><circle cx="94.5" cy="73.5" fill="#3ea8ff" r="1.5"></circle><circle cx="16.5" cy="75.5" fill="#ffdc6e" r="1.5"></circle><circle cx="78.5" cy="91.5" fill="#ffdc6e" r="1.5"></circle></g></svg></button></div><div class="BookmarkButton_container__VcKCG style-large"><button aria-label="ブックマーク" class="BookmarkButton_bookmarkButton__tZ8rb" data-pressed="false"><svg width="32" height="32" fill="none" viewBox="0 0 32 32"><path fill="#ACBCC7" d="M15.9998 24L10.3998 26.4C9.51095 26.7778 8.6665 26.7056 7.8665 26.1833C7.0665 25.6611 6.6665 24.9222 6.6665 23.9667V6.66667C6.6665 5.93333 6.92762 5.30556 7.44984 4.78333C7.97206 4.26111 8.59984 4 9.33317 4H22.6665C23.3998 4 24.0276 4.26111 24.5498 4.78333C25.0721 5.30556 25.3332 5.93333 25.3332 6.66667V23.9667C25.3332 24.9222 24.9332 25.6611 24.1332 26.1833C23.3332 26.7056 22.4887 26.7778 21.5998 26.4L15.9998 24ZM15.9998 21.0667L22.6665 23.9333V6.66667H9.33317V23.9333L15.9998 21.0667Z"></path></svg></button></div><div class="View_menuAndShareButtonsContainer__PMtHU"><div class="View_menu__wgMxq"><button aria-label="その他の操作" class="PopoverMenuButton_menuButton__hKCa_"><svg viewBox="0 0 27 27" height="16" width="16"><path fill="currentColor" d="M12.74,20.53,3.48,11.35a.75.75,0,0,1,0-1.07L4.71,9.05a.75.75,0,0,1,1.07,0l7.49,7.41,7.49-7.41a.74.74,0,0,1,1.06,0l1.24,1.23a.77.77,0,0,1,0,1.07L13.8,20.53A.74.74,0,0,1,12.74,20.53Z"></path></svg></button></div><div class="ShareButtonsExperimental_container__CrtBj" style="flex-direction:row;align-items:center"><a aria-label="X(Twitter)にポスト" class="ShareButtonsExperimental_button__d9aXF ShareButtonsExperimental_svgTwitterHorizontal__5xDGM ShareButtonsExperimental_svgTwitterBase__8FrNq" data-tooltip-for-desktop="true" data-tooltip-position="bottom" href="https://twitter.com/intent/tweet?url=https://zenn.dev/yamato_snow/articles/00e11d435247b3&amp;text=Python%20%2B%20Flask%20%2B%20Selenium%20%E3%81%A7%E4%BD%9C%E3%82%8B%20SUUMO%20%E7%89%A9%E4%BB%B6%E6%83%85%E5%A0%B1%E3%82%B9%E3%82%AF%E3%83%AC%E3%82%A4%E3%83%94%E3%83%B3%E3%82%B0%E3%83%84%E3%83%BC%E3%83%AB%EF%BD%9C%E3%82%84%E3%81%BE%E3%81%A8&amp;hashtags=zenn" id="gtm-article-footer-tweet" rel="nofollow noopener noreferrer" role="tooltip" target="_blank"><svg width="27" height="28" fill="none" viewBox="0 0 27 28"><g clip-path="url(#a)"><path fill="currentColor" d="M16.0687 11.7356L26.12 0H23.7382L15.0106 10.1899L8.03988 0H0L10.5411 15.4089L0 27.7155H2.38199L11.5985 16.9546L18.9601 27.7155H27L16.0681 11.7356H16.0687ZM12.8062 15.5447L11.7382 14.0103L3.24025 1.80106H6.89884L13.7568 11.6543L14.8248 13.1887L23.7393 25.9963H20.0807L12.8062 15.5452V15.5447Z"></path></g><defs><clippath id="a"><path fill="#fff" d="M0 0H27V27.73H0z"></path></clippath></defs></svg></a><a aria-label="Facebookに投稿" class="ShareButtonsExperimental_button__d9aXF ShareButtonsExperimental_svgFacebookHorizontal__MpfBm ShareButtonsExperimental_svgFacebookBase___gDOW" data-tooltip-for-desktop="true" data-tooltip-position="bottom" href="http://www.facebook.com/sharer.php?u=https://zenn.dev/yamato_snow/articles/00e11d435247b3" id="gtm-article-footer-facebook" rel="nofollow noopener noreferrer" role="tooltip" target="_blank"><svg width="28" height="29" fill="none" viewBox="0 0 28 29"><g clip-path="url(#a)"><path fill="currentColor" d="M28 14.7812C28 7.02084 21.7319 0.729736 14 0.729736C6.26808 0.729736 0 7.02084 0 14.7812C0 21.3707 4.52032 26.9002 10.6182 28.4189V19.0753H7.73136V14.7812H10.6182V12.9309C10.6182 8.14833 12.7747 5.93158 17.453 5.93158C18.34 5.93158 19.8705 6.10637 20.4966 6.28061V10.1729C20.1662 10.138 19.5922 10.1206 18.8793 10.1206C16.5838 10.1206 15.6968 10.9935 15.6968 13.2625V14.7812H20.2698L19.4841 19.0753H15.6968V28.7297C22.629 27.8895 28.0006 21.9654 28.0006 14.7812H28Z"></path></g><defs><clippath id="a"><path fill="#fff" d="M0 0H28V28H0z" transform="translate(0 .73)"></path></clippath></defs></svg></a><a aria-label="はてなブックマークに登録" class="ShareButtonsExperimental_button__d9aXF ShareButtonsExperimental_svgHatenaBookmarkHorizontal__ccpWn ShareButtonsExperimental_svgHatenaBookmarkBase__VXz6p" data-tooltip-for-desktop="true" data-tooltip-position="bottom" href="https://b.hatena.ne.jp/add?mode=confirm&amp;url=https://zenn.dev/yamato_snow/articles/00e11d435247b3&amp;title=Python%20%2B%20Flask%20%2B%20Selenium%20%E3%81%A7%E4%BD%9C%E3%82%8B%20SUUMO%20%E7%89%A9%E4%BB%B6%E6%83%85%E5%A0%B1%E3%82%B9%E3%82%AF%E3%83%AC%E3%82%A4%E3%83%94%E3%83%B3%E3%82%B0%E3%83%84%E3%83%BC%E3%83%AB%EF%BD%9C%E3%82%84%E3%81%BE%E3%81%A8" id="gtm-article-footer-hatena-bookmark" rel="nofollow noopener noreferrer" role="tooltip" target="_blank"><svg width="27" height="28" fill="none" viewBox="0 0 27 28"><path fill="currentColor" fill-rule="evenodd" d="M5.4999 0.729736H21.5001C24.5376 0.729736 27 3.19213 27 6.22964V22.2298C27 25.2673 24.5376 27.7297 21.5001 27.7297H5.4999C2.46239 27.7297 0 25.2673 0 22.2298V6.22964C0 3.19213 2.46239 0.729736 5.4999 0.729736ZM12.98 13.7472C13.8521 13.8136 14.5319 14.1209 15.0212 14.6673V14.6679C15.512 15.2127 15.7572 15.9444 15.7572 16.8543C15.7572 17.5126 15.62 18.0877 15.3436 18.5867C15.0692 19.084 14.6756 19.4712 14.1604 19.7433C13.7441 19.9658 13.2289 20.1278 12.6155 20.2245C12.001 20.3179 10.9966 20.3665 9.6039 20.3665H6.13656V8.09392H9.50184C10.8859 8.09392 11.8503 8.13875 12.4016 8.22623C12.9503 8.31695 13.4206 8.4703 13.8164 8.68792C14.269 8.93902 14.6129 9.27437 14.8527 9.69341C15.0865 10.1151 15.2069 10.6028 15.2069 11.1546C15.2069 11.8512 15.0309 12.4053 14.6761 12.813C14.3197 13.2261 13.756 13.5355 12.98 13.7472ZM9.96192 10.8144H9.24372H9.24318V13.2768H9.91116C10.7352 13.2768 11.2984 13.1856 11.6073 13.0058C11.9124 12.8227 12.0663 12.5273 12.0663 12.0667C12.0663 11.6061 11.9216 11.2821 11.6375 11.0947C11.3497 10.9084 10.7919 10.8144 9.96192 10.8144ZM10.4128 18.1514C11.2028 18.1514 11.7661 18.0531 12.0928 17.8523V17.8528C12.4227 17.653 12.5863 17.3209 12.5863 16.8581C12.5863 16.3408 12.4367 15.9806 12.1338 15.7765C11.8357 15.5724 11.2747 15.4703 10.463 15.4703H9.24372V18.1514H10.4128ZM19.3093 17.257C18.4502 17.257 17.7547 17.9525 17.7547 18.8111C17.7547 19.6697 18.4507 20.3658 19.3093 20.3658C20.1679 20.3658 20.8634 19.6697 20.8634 18.8111C20.8634 17.9525 20.1668 17.257 19.3093 17.257ZM17.9593 8.09318H20.6593V16.2753H17.9593V8.09318Z" clip-rule="evenodd"></path></svg></a></div></div></div><span style="display:block;height:2rem;flex-shrink:0"></span><aside class="View_authorInfo__F19rR"><div class="ProfileCard_container__YfvQl"><a class="ProfileCard_avatar__tIJpR" href="https://zenn.dev/yamato_snow"><img alt="やまと" class="AvatarImage_plain__Fgp4R " height="80" loading="lazy" referrerpolicy="no-referrer" src="./HowToscraping_files/e1164c4a45.jpeg" width="80"></a><div class="ProfileCard_name__qXamf"><a class="ProfileCard_displayName__gRUeY" href="https://zenn.dev/yamato_snow">やまと</a></div><div class="ProfileCard_content__1w905"><div class="ProfileCard_actions__2ZjZ8"><span class="ProfileCard_follow__ng60N"><button class="FollowButton_button__lapNm style-small">フォロー</button></span><a aria-label="@yamato-snow" class="GithubLink_link__3iaUH" data-tooltip-for-desktop="true" data-tooltip-position="bottom" href="https://github.com/yamato-snow" rel="nofollow noopener noreferrer" role="tooltip" target="_blank"><svg xml:space="preserve" viewBox="0 0 27 27" aria-label="GitHub"><path fill="currentColor" d="M13.4,1.2C7,1,1.8,6,1.7,12.4c0,0.1,0,0.4,0,0.5c0,5.1,3.2,9.8,8.2,11.5c0.6,0.1,0.7-0.2,0.7-0.6s0-1.8,0-2.9 c0,0-3.3,0.6-4-1.5c0,0-0.6-1.3-1.3-1.8c0,0-1.1-0.7,0.1-0.7c0.7,0.1,1.5,0.6,1.8,1.2c0.6,1.2,2.2,1.7,3.4,1h0.1 c0.1-0.6,0.4-1.2,0.7-1.6C8.7,17.1,6,16.9,6,12.3c0-1.1,0.5-2.1,1.2-2.8c0-1.1,0-2.2,0.3-3.2c1-0.4,3.3,1.3,3.3,1.3c2-0.6,4-0.6,6,0 c0,0,2.2-1.6,3.2-1.2c0.5,1,0.5,2.2,0.1,3.2c0.7,0.7,1.2,1.8,1.2,2.8c0,4.5-2.8,5-5.5,5.2c0.6,0.6,0.9,1.3,0.7,2.2c0,1.7,0,3.5,0,4 s0.2,0.6,0.7,0.6c4.9-1.7,8.2-6.2,8-11.5c0.1-6.4-5.1-11.6-11.6-11.6C13.5,1.2,13.4,1.2,13.4,1.2z"></path></svg></a><a aria-label="@keepmovelab" class="XLink_link__Sn3ha" data-tooltip-for-desktop="true" data-tooltip-position="bottom" href="https://x.com/keepmovelab" rel="nofollow noopener noreferrer" role="tooltip" target="_blank"><svg width="27" height="28" fill="none" viewBox="0 0 27 28" aria-label="X(Twitter)"><g clip-path="url(#a)"><path fill="currentColor" d="M16.0687 11.7356L26.12 0H23.7382L15.0106 10.1899L8.03988 0H0L10.5411 15.4089L0 27.7155H2.38199L11.5985 16.9546L18.9601 27.7155H27L16.0681 11.7356H16.0687ZM12.8062 15.5447L11.7382 14.0103L3.24025 1.80106H6.89884L13.7568 11.6543L14.8248 13.1887L23.7393 25.9963H20.0807L12.8062 15.5452V15.5447Z"></path></g><defs><clippath id="a"><path fill="#fff" d="M0 0H27V27.73H0z"></path></clippath></defs></svg></a></div></div></div></aside><span style="display:block;height:2rem;flex-shrink:0"></span><aside class="SendBadgeCta_container__peDjp"><div class="SendBadgeCta_content__FGxIx"><div class="SendBadgeCta_title__NFpA3">バッジを贈って著者を応援しよう</div><span style="display:block;height:0.5rem;flex-shrink:0"></span><p class="Paragraph_common__yRSrj Paragraph_sidenote-sm__zfJpo">バッジを受け取った著者にはZennから現金やAmazonギフトカードが還元されます。</p><div class="SendBadgeCta_buttonContainer__5_7_u"><button class="Button_primary__VcoA9 Button_baseStyle__Vhn6Y Button_large__jO0IW Button_fontBold__BN6Co">バッジを贈る</button></div></div><svg fill="currentColor" viewBox="0 0 318 451" class="SendBadgeCta_icon__mcUsF"><path d="M175.12 41.58V13.2a8.87 8.87 0 0 0-17.73.6V41.58a8.87 8.87 0 1 0 17.73.6ZM75 44.52 94.62 64.17c.1.11.21.22.32.32a8.87 8.87 0 0 0 12.18-12.86L87.52 32A8.87 8.87 0 0 0 75 44.52ZM253.56 44.52A8.87 8.87 0 0 0 241 32L221.37 51.63 221 52A8.87 8.87 0 0 0 233.9 64.17h0ZM18.06 262.07a28.08 28.08 0 0 0-.7 39.08l22.55 27.78 12.58 15.5 32.78 40.4A24.72 24.72 0 0 0 104.53 394H203a35.83 35.83 0 0 1 15.13 3.36 8 8 0 0 0 9-1.68h0a8.09 8.09 0 0 0-2.2-13h0a46 46 0 0 0-19.6-4.4H104.57a9.06 9.06 0 0 1-7.08-3.37L72.76 344.4 58.37 326.68l-.72-.89L39.91 303.93 29.32 290.42h0a12.35 12.35 0 0 1 0-17.46 10.33 10.33 0 0 1 1.43-1.2 12.1 12.1 0 0 1 4.76-2.15h.17a12.73 12.73 0 0 1 2.06-.21H38a12.47 12.47 0 0 1 3.53.52l.71.23c.23.08.45.18.68.27h0A12.55 12.55 0 0 1 46.76 273l11 10.68 14 13.53 21.88 21.13a23.65 23.65 0 0 0-.56 2.63 8.77 8.77 0 0 0-.21 1.6l-.06.84v3.51a3.31 3.31 0 0 1 0 .62 2.53 2.53 0 0 0 0 .55 1.79 1.79 0 0 0 .07.62c.07.18 0 .33.07.54s.08.42.1.62l.09.54.12.61.12.53a2.93 2.93 0 0 0 .15.6c0 .18.09.33.14.53s.12.43.17.6l.16.52c.06.19.13.42.19.59s.12.34.19.51l.21.58.21.51.24.57c.07.17.15.31.23.5s.17.37.26.55l.25.51.28.53.28.5.3.52.3.49c.11.16.21.33.32.5l.33.48.33.49c.12.16.24.31.35.47l.36.47.37.47c.13.14.24.28.37.44s.33.37.41.46.15.18.23.26l.15.17.43.45.4.4.46.44.4.38.5.43.41.36.53.42.42.33.56.41.42.31.61.4.41.27.66.4.4.24.72.39.38.2.8.4.33.16.94.4.23.1c.79.33 1.61.62 2.45.88a26.76 26.76 0 0 0 5.83 1.08 21.47 21.47 0 0 0 2.78.11H184.7l.48-.07.28-.06.43-.11.28-.09.42-.15.25-.11a2.93 2.93 0 0 0 .44-.21l.21-.1c.2-.11.4-.23.59-.36l.17-.12.38-.29c.2-.16.4-.34.59-.52h0c.19-.19.38-.4.56-.61l.11-.15c.13-.17.25-.35.37-.52l.15-.23.27-.49.13-.26.21-.49a.45.45 0 0 1 .1-.3 1.7 1.7 0 0 0 .16-.51 1.06 1.06 0 0 1 .07-.3c.05-.2.08-.39.11-.58v-.26a6.31 6.31 0 0 0 0-.87 10.7 10.7 0 0 0-.11-1.27 7.87 7.87 0 0 0-7.76-6.6H120.77a12.35 12.35 0 0 1-12.3-13.57 5.65 5.65 0 0 1 .16-1.07v-.23c.07-.33.15-.67.25-1h0c.11-.36.23-.68.36-1a.94.94 0 0 1 .1-.23c.12-.29.26-.58.41-.86v-.07c.16-.3.34-.58.52-.86l.16-.24.15-.22c.12-.17.25-.33.37-.48l.08-.11c.21-.25.43-.5.66-.74l.19-.19c.22-.22.44-.43.68-.63l.06-.06c.26-.22.52-.42.8-.62l.21-.15c.26-.18.53-.36.8-.52h.06c.29-.17.59-.32.9-.47l.24-.12c.29-.13.59-.26.89-.37h.07c.35-.12.67-.22 1-.31l.27-.08c.36-.08.67-.16 1-.22h.07a4.73 4.73 0 0 1 1-.14h65.95a46.51 46.51 0 0 0 12.79-1.77 43.8 43.8 0 0 0 4.85-1.75h.09c.76-.34 1.51-.69 2.25-1.07a62.92 62.92 0 0 1 29.3-7.17h3.1l1.45.08.93.08a11.73 11.73 0 0 1 1.33.12l1 .11.94.11.38.06.87.13 1.32.21.91.17 1.28.25.91.2 1.26.3.91.22 1.24.34.9.25 1.28.39.83.27c.59.19 1.17.39 1.75.6l1.25.47c.31.12.63.23.94.36H260c.89.35 1.75.72 2.62 1.1l.44.21c.71.32 1.4.66 2.09 1l.68.32c.67.36 1.34.71 2 1.08l.47.26c.81.41 1.62.92 2.41 1.41l.42.27c.64.39 1.28.81 1.91 1.23l.67.46c.58.4 1.16.81 1.73 1.23l.54.39c.73.55 1.46 1.11 2.16 1.69l.38.31c.58.47 1.15 1 1.72 1.47l.63.56c.48.46 1 .92 1.48 1.38l.55.53c.23.24 1.5 1.75 3 3.55a5.2 5.2 0 0 0 .51.55 8 8 0 0 0 11.31 0h0a8 8 0 0 0 .36-11q-1.08-1.23-2.22-2.43c-1.68-1.73-3.43-3.39-5.25-5V207.16h7a8.88 8.88 0 0 0 8.87-8.86V152.38a8.88 8.88 0 0 0-8.87-8.87H284.85c5.62-15 1.68-32.58-10.89-43.16a49.14 49.14 0 0 0-28.23-11.56c-20.31-1.46-44.09 12.21-58.31 24.38-1 .89-2.13 1.82-3.13 2.76h-38c-1-.94-2.14-1.87-3.14-2.76-14.22-12.16-38-25.84-58.33-24.38a49 49 0 0 0-28.24 11.56C44 110.93 40.12 128.51 45.69 143.51H32.91a8.88 8.88 0 0 0-8.86 8.87V198.3a8.85 8.85 0 0 0 8.86 8.86h7v46.77a20.38 20.38 0 0 0-2.06-.08A27.76 27.76 0 0 0 18.06 262ZM196 207.17h76.88v87.5c-1.46-.72-2.92-1.42-4.39-2.08a83.5 83.5 0 0 0-14.76-4.9 81.38 81.38 0 0 0-18.58-2.15 78.77 78.77 0 0 0-36.42 8.92 25.37 25.37 0 0 1-2.68 1.18Zm.05-45.91h92.74v28.17h-92.7Zm0-32c.9-.86 1.9-1.71 2.9-2.57 12-10.28 30.55-20.22 43.76-20.22.6 0 1.17.06 1.75.06a31.32 31.32 0 0 1 18.08 7.4c8.65 7.25 9.65 20.71 2.08 29.58H196.06Zm-43.71 4.42h26V297.39h-26Zm-17.78 9.86H66C58.4 134.68 59.41 121.22 68 114a31.34 31.34 0 0 1 18.09-7.47c13.28-1 33 9.41 45.5 20.16 1 .86 2 1.72 2.92 2.57ZM57.65 207.16h76.88v90.2H121.27A29 29 0 0 0 102 304.8l-19.1-18.45L57.69 262Zm-15.86-45.9h92.74v28.17H41.83Z"></path></svg></aside></div></div><div id="discuss"><div class="ArticleComments_commentsContainer__kOO0n"><section class="ArticleComments_comments__y4Azs"><div class="ArticleComments_emptyContainer__I4fw6"><h3 class="Heading_size-lg__KD3Up Heading_centered__lNLF_">Discussion</h3><img class="ArticleComments_emptyImg__FGwCr" src="./HowToscraping_files/discussion.png" width="300"></div></section><div class="ArticleComments_commentForm__b1KSY"><div class="ArticleComments_commentFormLogin__k5bW9">ログインするとコメントできます<div class="ArticleComments_commentFormLoginButtonContainer__SVIHJ"><button class="Button_primary__VcoA9 Button_baseStyle__Vhn6Y Button_medium__STW9Z Button_fontHero__Ky4oV Button_fontBold__BN6Co">Login</button></div></div></div></div></div></section><aside class="View_sidebarContainer__YwcNH"><div class="ArticleSidebar_container__jSRJw"><div><div class="ArticleSidebar_user__vJ7nz ArticleSidebar_sidebarCard__AtM_Z"><div class="SidebarUserBio_container__iWemi"><a href="https://zenn.dev/yamato_snow"><img alt="やまと" class="AvatarImage_border__pDIjF AvatarImage_plain__Fgp4R " height="60" loading="lazy" referrerpolicy="no-referrer" src="./HowToscraping_files/e1164c4a45.jpeg" width="60"></a><div class="SidebarUserBio_author__cM7pP"><a class="SidebarUserBio_name__0zFdT" href="https://zenn.dev/yamato_snow">やまと</a><div class="SidebarUserBio_actions__oFupD"><button class="FollowButton_button__lapNm style-small">フォロー</button><a aria-label="@yamato-snow" class="GithubLink_link__3iaUH" data-tooltip-for-desktop="true" data-tooltip-position="bottom" href="https://github.com/yamato-snow" rel="nofollow noopener noreferrer" role="tooltip" target="_blank"><svg xml:space="preserve" viewBox="0 0 27 27" aria-label="GitHub"><path fill="currentColor" d="M13.4,1.2C7,1,1.8,6,1.7,12.4c0,0.1,0,0.4,0,0.5c0,5.1,3.2,9.8,8.2,11.5c0.6,0.1,0.7-0.2,0.7-0.6s0-1.8,0-2.9 c0,0-3.3,0.6-4-1.5c0,0-0.6-1.3-1.3-1.8c0,0-1.1-0.7,0.1-0.7c0.7,0.1,1.5,0.6,1.8,1.2c0.6,1.2,2.2,1.7,3.4,1h0.1 c0.1-0.6,0.4-1.2,0.7-1.6C8.7,17.1,6,16.9,6,12.3c0-1.1,0.5-2.1,1.2-2.8c0-1.1,0-2.2,0.3-3.2c1-0.4,3.3,1.3,3.3,1.3c2-0.6,4-0.6,6,0 c0,0,2.2-1.6,3.2-1.2c0.5,1,0.5,2.2,0.1,3.2c0.7,0.7,1.2,1.8,1.2,2.8c0,4.5-2.8,5-5.5,5.2c0.6,0.6,0.9,1.3,0.7,2.2c0,1.7,0,3.5,0,4 s0.2,0.6,0.7,0.6c4.9-1.7,8.2-6.2,8-11.5c0.1-6.4-5.1-11.6-11.6-11.6C13.5,1.2,13.4,1.2,13.4,1.2z"></path></svg></a><a aria-label="@keepmovelab" class="XLink_link__Sn3ha" data-tooltip-for-desktop="true" data-tooltip-position="bottom" href="https://x.com/keepmovelab" rel="nofollow noopener noreferrer" role="tooltip" target="_blank"><svg width="27" height="28" fill="none" viewBox="0 0 27 28" aria-label="X(Twitter)"><g clip-path="url(#a)"><path fill="currentColor" d="M16.0687 11.7356L26.12 0H23.7382L15.0106 10.1899L8.03988 0H0L10.5411 15.4089L0 27.7155H2.38199L11.5985 16.9546L18.9601 27.7155H27L16.0681 11.7356H16.0687ZM12.8062 15.5447L11.7382 14.0103L3.24025 1.80106H6.89884L13.7568 11.6543L14.8248 13.1887L23.7393 25.9963H20.0807L12.8062 15.5452V15.5447Z"></path></g><defs><clippath id="a"><path fill="#fff" d="M0 0H27V27.73H0z"></path></clippath></defs></svg></a></div></div></div><span style="display:block;height:1rem;flex-shrink:0"></span><button class="Button_primary__VcoA9 Button_baseStyle__Vhn6Y Button_full__RIG_z Button_large__jO0IW Button_fontBold__BN6Co">バッジを贈る</button><div class="ArticleSidebar_badgeAbout__Y3cIb"><a class="TextAnchor_anchor__ZJD31 TextAnchor_anchorColoredSubtle__ZUESd ArticleSidebar_badgeAboutLink__aqdNT" href="https://zenn.dev/faq#badges">バッジを贈るとは<svg fill="currentColor" viewBox="0 0 24 24" class="TextAnchor_iconArrow__PDEji TextAnchor_iconBase__xZlCw"><path fill="none" d="M0 0h24v24H0z"></path><path d="M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"></path></svg></a></div></div></div><span style="display:block;height:1.5rem;flex-shrink:0"></span><div class="ArticleSidebar_sticky__W61mq"><div style="display:flex;gap:1.5rem;flex-direction:column;align-items:stretch;flex-wrap:nowrap"><div class="ArticleSidebarToc_toc__dUPn8"><div class="ArticleSidebarToc_tocTitle__A3VjO">目次</div><div class="ArticleToc_toc__WF75u"><ol class="ol-depth-1"><li><a href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB">はじめに</a></li><li><a href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E3%81%AA%E3%81%9C%E3%81%93%E3%81%AE%E3%83%84%E3%83%BC%E3%83%AB%E3%82%92%E4%BD%9C%E3%81%A3%E3%81%9F%E3%81%AE%E3%81%8B%EF%BC%9F">なぜこのツールを作ったのか？</a></li><li><a href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E3%81%93%E3%81%AE%E3%83%84%E3%83%BC%E3%83%AB%E3%81%A7%E3%81%A7%E3%81%8D%E3%82%8B%E3%81%93%E3%81%A8">このツールでできること</a><ol class="ol-depth-2"><li><a href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E4%B8%BB%E3%81%AA%E6%A9%9F%E8%83%BD">主な機能</a></li><li><a href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E5%8F%96%E5%BE%97%E3%81%A7%E3%81%8D%E3%82%8B%E6%83%85%E5%A0%B1%EF%BC%88%E5%85%A831%E9%A0%85%E7%9B%AE%EF%BC%89">取得できる情報（全31項目）</a></li></ol></li><li><a href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%A6%E3%81%84%E3%82%8B%E6%8A%80%E8%A1%93%E3%82%B9%E3%82%BF%E3%83%83%E3%82%AF%E3%81%AF%EF%BC%9F">使用している技術スタックは？</a><ol class="ol-depth-2"><li><a href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E3%81%AA%E3%81%9C%E3%81%93%E3%81%AE%E7%B5%84%E3%81%BF%E5%90%88%E3%82%8F%E3%81%9B%E3%82%92%E9%81%B8%E3%82%93%E3%81%A0%E3%81%AE%E3%81%8B%EF%BC%9F">なぜこの組み合わせを選んだのか？</a></li></ol></li><li><a href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E6%A7%8B%E6%88%90">プロジェクト構成</a></li><li><a href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E3%82%BB%E3%83%83%E3%83%88%E3%82%A2%E3%83%83%E3%83%97%E6%96%B9%E6%B3%95">セットアップ方法</a><ol class="ol-depth-2"><li><a href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E5%89%8D%E6%8F%90%E6%9D%A1%E4%BB%B6">前提条件</a></li><li><a href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB%E6%89%8B%E9%A0%86">インストール手順</a></li><li><a href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E4%BE%9D%E5%AD%98%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8">依存パッケージ</a></li></ol></li><li><a href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E4%BD%BF%E3%81%84%E6%96%B9">使い方</a><ol class="ol-depth-2"><li><a href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E6%96%B9%E6%B3%951%3A-url%E6%89%8B%E5%8B%95%E5%85%A5%E5%8A%9B%E3%83%A2%E3%83%BC%E3%83%89">方法1: URL手動入力モード</a></li><li><a href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E6%96%B9%E6%B3%952%3A-%E3%81%8A%E6%B0%97%E3%81%AB%E5%85%A5%E3%82%8A%E5%8F%96%E5%BE%97%E3%83%A2%E3%83%BC%E3%83%89">方法2: お気に入り取得モード</a></li></ol></li><li><a href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E3%82%B9%E3%82%AF%E3%83%AC%E3%82%A4%E3%83%94%E3%83%B3%E3%82%B0%E3%82%92%E5%A7%8B%E3%82%81%E3%82%8B%E5%89%8D%E3%81%AB%E7%9F%A5%E3%81%A3%E3%81%A6%E3%81%8A%E3%81%8F%E3%81%B9%E3%81%8D%E3%81%93%E3%81%A8">スクレイピングを始める前に知っておくべきこと</a><ol class="ol-depth-2"><li><a href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#1.-%E6%B3%95%E7%9A%84%E3%83%AA%E3%82%B9%E3%82%AF%E3%82%92%E7%90%86%E8%A7%A3%E3%81%99%E3%82%8B">1. 法的リスクを理解する</a></li><li><a href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#2.-%E4%BA%8B%E5%89%8D%E3%81%AB%E7%A2%BA%E8%AA%8D%E3%81%99%E3%81%B9%E3%81%8D%E3%81%93%E3%81%A8">2. 事前に確認すべきこと</a></li><li><a href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#3.-%E3%82%B9%E3%82%AF%E3%83%AC%E3%82%A4%E3%83%94%E3%83%B3%E3%82%B0%E3%81%AE%E3%83%9E%E3%83%8A%E3%83%BC%EF%BC%88%E3%83%99%E3%82%B9%E3%83%88%E3%83%97%E3%83%A9%E3%82%AF%E3%83%86%E3%82%A3%E3%82%B9%EF%BC%89">3. スクレイピングのマナー（ベストプラクティス）</a></li><li><a href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#4.-suumo%E3%81%A7%E3%82%B9%E3%82%AF%E3%83%AC%E3%82%A4%E3%83%94%E3%83%B3%E3%82%B0%E3%82%92%E8%A1%8C%E3%81%86%E9%9A%9B%E3%81%AE%E6%B3%A8%E6%84%8F">4. SUUMOでスクレイピングを行う際の注意</a></li></ol></li><li><a href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E4%B8%BB%E8%A6%81%E3%81%AA%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88">主要なコードのポイント</a><ol class="ol-depth-2"><li class="active"><a href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#1.-%E3%82%B9%E3%82%AF%E3%83%AC%E3%82%A4%E3%83%94%E3%83%B3%E3%82%B0%E5%87%A6%E7%90%86%EF%BC%88suumo.py%EF%BC%89" class="active">1. スクレイピング処理（suumo.py）</a></li><li><a href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#2.-selenium%E8%AA%8D%E8%A8%BC%E3%83%A2%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%AB%EF%BC%88auth.py%EF%BC%89">2. Selenium認証モジュール（auth.py）</a></li><li><a href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#3.-%E3%82%A8%E3%82%AF%E3%82%B9%E3%83%9D%E3%83%BC%E3%83%88%E5%87%A6%E7%90%86%EF%BC%88exporter.py%EF%BC%89">3. エクスポート処理（exporter.py）</a></li><li><a href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#4.-server-sent-events%EF%BC%88sse%EF%BC%89%E3%81%AB%E3%82%88%E3%82%8B%E9%80%B2%E6%8D%97%E8%A1%A8%E7%A4%BA">4. Server-Sent Events（SSE）による進捗表示</a></li><li><a href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#5.-%E3%82%B9%E3%82%AF%E3%83%AC%E3%82%A4%E3%83%94%E3%83%B3%E3%82%B0%E3%82%BF%E3%82%B9%E3%82%AF%E3%81%AE%E4%B8%A6%E5%88%97%E5%AE%9F%E8%A1%8C">5. スクレイピングタスクの並列実行</a></li></ol></li><li><a href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E5%AE%9F%E8%A3%85%E3%81%A7%E5%B7%A5%E5%A4%AB%E3%81%97%E3%81%9F%E7%82%B9%E3%83%BB%E6%B3%A8%E6%84%8F%E7%82%B9">実装で工夫した点・注意点</a><ol class="ol-depth-2"><li><a href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E3%82%B9%E3%82%AF%E3%83%AC%E3%82%A4%E3%83%94%E3%83%B3%E3%82%B0%E3%83%9E%E3%83%8A%E3%83%BC">スクレイピングマナー</a></li><li><a href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E3%82%A8%E3%83%A9%E3%83%BC%E3%83%8F%E3%83%B3%E3%83%89%E3%83%AA%E3%83%B3%E3%82%B0">エラーハンドリング</a></li><li><a href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E3%82%BF%E3%82%B9%E3%82%AF%E3%81%AE%E6%9C%89%E5%8A%B9%E6%9C%9F%E9%99%90%E7%AE%A1%E7%90%86">タスクの有効期限管理</a></li></ol></li><li><a href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E3%81%BE%E3%81%A8%E3%82%81">まとめ</a><ol class="ol-depth-2"><li><a href="https://zenn.dev/yamato_snow/articles/00e11d435247b3#%E9%87%8D%E8%A6%81%E3%81%AA%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A0%85">重要な注意事項</a></li></ol></li></ol></div></div><div class="ArticleSidebar_zennPrContainer__VFiIp"><p class="ArticleSidebar_sidenoteTitle__S2xZj">Zennからのお知らせ</p><span style="display: block; height: 1rem; flex-shrink: 0;"></span><div style="display: flex; gap: 1rem; flex-flow: column; align-items: stretch;"><article class="EventPromotionLink_container__R_ARC EventPromotionLink_mini__ltM5X"><a class="EventPromotionLink_link__KGWRW" id="google-cloud-japan-ai-hackathon-vol4-article-right" href="https://zenn.dev/hackathons/google-cloud-japan-ai-hackathon-vol4"><div style="display: flex; gap: 1rem; flex-flow: row; align-items: center;"><img alt="第4回 Agentic AI Hackathon with Google Cloud 受付開始！" class="EventPromotionLink_icon__ZxNuu" src="./HowToscraping_files/bannerIcon.png"><p class="EventPromotionLink_title__y2oFU">第4回 Agentic AI Hackathon with Google Cloud 開催中！</p></div></a></article></div></div></div></div></div></aside></div></div></div></div><div id="related-contents"><span style="display: block; height: 3rem; flex-shrink: 0;"></span><footer><div class="Container_default__13H8g Container_common__figYY"><div class="RelatedContents_title__vetXM">Read next</div><span style="display: block; height: 0.5rem; flex-shrink: 0;"></span><div class="ArticleList_listContainer__m2qg0"><div class="ArticleList_itemContainer__UNI2Y"><article class="ArticleListItem_container__qIG0Q"><a class="ArticleListItem_emoji__LQo9z" href="https://zenn.dev/yumefuku/articles/dspy-prompt-optimize"><span class="Emoji_twemoji__hcxYF"><span class="Emoji_twemojiImg__Oc6vR" style="background-image: url(&quot;https://asia-northeast1-zenn-dev-production.cloudfunctions.net/twemoji/%F0%9F%A7%A9.svg&quot;);"></span></span><span class="Emoji_nativeEmoji__GMBzX">🧩</span></a><div class="ArticleListItem_content__dMwpo"><a class="ArticleListItem_link__x5PVw" href="https://zenn.dev/yumefuku/articles/dspy-prompt-optimize"><h2 class="ArticleListItem_title__bnVSg">DSpyの基礎と構成（プログラムの実行と最適化）</h2></a><div class="ArticleListItem_user__E8I7_"><div class="ArticleListItem_avatar__iTEjn"><a href="https://zenn.dev/yumefuku"><img alt="ゆめふく" class="AvatarImage_plain__Fgp4R " height="26" loading="lazy" referrerpolicy="no-referrer" width="26" src="./HowToscraping_files/aefb8b6f22.jpeg"></a></div><div class="ArticleListItem_userInfo__aP0iX "><div class="ArticleListItem_userName__p6vjX"><a href="https://zenn.dev/yumefuku">ゆめふく</a></div><div class="ArticleListItem_meta__CKXPA"><time class="ArticleListItem_date___2_aU" datetime="2026-02-01T14:08:58+09:00">17時間前</time><span class="ArticleListItem_like__hZ1uJ"><svg xml:space="preserve" viewBox="0 0 110 110" aria-label="いいねされた数" height="14" width="14"><path fill="currentColor" d="M77.5,12.2c-7.3,0-14.4,2.8-19.8,7.7c-1.5,1.3-3.7,1.3-5.2,0c-5.4-5-12.5-7.7-19.9-7.7C17.3,12.2,5,24.5,5,39.7 c0,20.8,24.5,41,31.4,47.4c3.5,3.3,7.7,7,11.1,10.2c4.2,3.8,10.6,3.8,14.9,0c3.5-3.1,7.6-6.8,11.1-10.2c6.9-6.4,31.4-26.6,31.4-47.4 C105,24.5,92.7,12.2,77.5,12.2z M69.1,77.6c-0.9,0.8-1.6,1.5-2.3,2.1c-3.1,2.9-6.7,6.2-9.9,9.1c-1.1,1-2.7,1-3.7,0 c-3.1-2.9-6.7-6.1-9.9-9.1c-0.6-0.6-1.4-1.2-2.3-2.1C33.9,71.2,15,54.2,15,39.7c0-9.7,7.8-17.5,17.5-17.5c5.5,0.1,10.8,2.4,14.6,6.5 l5.9,6.2c1,1.1,2.8,1.2,3.9,0.2c0.1,0,0.1-0.1,0.2-0.2l5.9-6.2c3.7-4.1,9-6.5,14.6-6.5C87.1,22.2,95,30,95,39.7 C95,54.2,76.1,71.2,69.1,77.6z"></path></svg> 2</span></div></div></div></div></article></div><div class="ArticleList_itemContainer__UNI2Y"><article class="ArticleListItem_container__qIG0Q"><a class="ArticleListItem_emoji__LQo9z" href="https://zenn.dev/syu_tan/articles/001_sar-book_ceos"><span class="Emoji_twemoji__hcxYF"><span class="Emoji_twemojiImg__Oc6vR" style="background-image: url(&quot;https://asia-northeast1-zenn-dev-production.cloudfunctions.net/twemoji/%F0%9F%93%98.svg&quot;);"></span></span><span class="Emoji_nativeEmoji__GMBzX">📘</span></a><div class="ArticleListItem_content__dMwpo"><a class="ArticleListItem_link__x5PVw" href="https://zenn.dev/syu_tan/articles/001_sar-book_ceos"><h2 class="ArticleListItem_title__bnVSg">JAXA CEOS フォーマットの構造と読み込み例</h2></a><div class="ArticleListItem_user__E8I7_"><div class="ArticleListItem_avatar__iTEjn"><a href="https://zenn.dev/syu_tan"><img alt="emmyeil" class="AvatarImage_plain__Fgp4R " height="26" loading="lazy" referrerpolicy="no-referrer" width="26" src="./HowToscraping_files/018856ad0f.jpeg"></a></div><div class="ArticleListItem_userInfo__aP0iX "><div class="ArticleListItem_userName__p6vjX"><a href="https://zenn.dev/syu_tan">emmyeil</a></div><div class="ArticleListItem_meta__CKXPA"><time class="ArticleListItem_date___2_aU" datetime="2026-02-01T21:52:44+09:00">10時間前</time></div></div></div></div></article></div><div class="ArticleList_itemContainer__UNI2Y"><article class="ArticleListItem_container__qIG0Q"><a class="ArticleListItem_emoji__LQo9z" href="https://zenn.dev/toshiro3/articles/duckdb-introduction"><span class="Emoji_twemoji__hcxYF"><span class="Emoji_twemojiImg__Oc6vR" style="background-image: url(&quot;https://asia-northeast1-zenn-dev-production.cloudfunctions.net/twemoji/%F0%9F%A6%86.svg&quot;);"></span></span><span class="Emoji_nativeEmoji__GMBzX">🦆</span></a><div class="ArticleListItem_content__dMwpo"><a class="ArticleListItem_link__x5PVw" href="https://zenn.dev/toshiro3/articles/duckdb-introduction"><h2 class="ArticleListItem_title__bnVSg">【入門】DuckDBとは？MySQL/PostgreSQLとの違いを手を動かして理解する</h2></a><div class="ArticleListItem_user__E8I7_"><div class="ArticleListItem_avatar__iTEjn"><a href="https://zenn.dev/toshiro3"><img alt="toshiro3" class="AvatarImage_plain__Fgp4R " height="26" loading="lazy" referrerpolicy="no-referrer" width="26" src="./HowToscraping_files/t.png"></a></div><div class="ArticleListItem_userInfo__aP0iX "><div class="ArticleListItem_userName__p6vjX"><a href="https://zenn.dev/toshiro3">toshiro3</a></div><div class="ArticleListItem_meta__CKXPA"><time class="ArticleListItem_date___2_aU" datetime="2026-02-01T10:18:36+09:00">21時間前</time></div></div></div></div></article></div><div class="ArticleList_itemContainer__UNI2Y"><article class="ArticleListItem_container__qIG0Q"><a class="ArticleListItem_emoji__LQo9z" href="https://zenn.dev/toshiro3/articles/prefect-introduction"><span class="Emoji_twemoji__hcxYF"><span class="Emoji_twemojiImg__Oc6vR" style="background-image: url(&quot;https://asia-northeast1-zenn-dev-production.cloudfunctions.net/twemoji/%F0%9F%94%84.svg&quot;);"></span></span><span class="Emoji_nativeEmoji__GMBzX">🔄</span></a><div class="ArticleListItem_content__dMwpo"><a class="ArticleListItem_link__x5PVw" href="https://zenn.dev/toshiro3/articles/prefect-introduction"><h2 class="ArticleListItem_title__bnVSg">Prefect 3.0入門 - Docker Composeでローカル環境を構築してDagster・Airflowと比較</h2></a><div class="ArticleListItem_user__E8I7_"><div class="ArticleListItem_avatar__iTEjn"><a href="https://zenn.dev/toshiro3"><img alt="toshiro3" class="AvatarImage_plain__Fgp4R " height="26" loading="lazy" referrerpolicy="no-referrer" width="26" src="./HowToscraping_files/t.png"></a></div><div class="ArticleListItem_userInfo__aP0iX "><div class="ArticleListItem_userName__p6vjX"><a href="https://zenn.dev/toshiro3">toshiro3</a></div><div class="ArticleListItem_meta__CKXPA"><time class="ArticleListItem_date___2_aU" datetime="2026-02-02T03:02:40+09:00">4時間前</time></div></div></div></div></article></div><div class="ArticleList_itemContainer__UNI2Y"><article class="ArticleListItem_container__qIG0Q"><a class="ArticleListItem_emoji__LQo9z" href="https://zenn.dev/toshiro3/articles/airflow-3-introduction"><span class="Emoji_twemoji__hcxYF"><span class="Emoji_twemojiImg__Oc6vR" style="background-image: url(&quot;https://asia-northeast1-zenn-dev-production.cloudfunctions.net/twemoji/%F0%9F%8C%80.svg&quot;);"></span></span><span class="Emoji_nativeEmoji__GMBzX">🌀</span></a><div class="ArticleListItem_content__dMwpo"><a class="ArticleListItem_link__x5PVw" href="https://zenn.dev/toshiro3/articles/airflow-3-introduction"><h2 class="ArticleListItem_title__bnVSg">Apache Airflow 3.xをDocker Composeで動かしてみた - 環境構築からCSVパイプライン実装まで</h2></a><div class="ArticleListItem_user__E8I7_"><div class="ArticleListItem_avatar__iTEjn"><a href="https://zenn.dev/toshiro3"><img alt="toshiro3" class="AvatarImage_plain__Fgp4R " height="26" loading="lazy" referrerpolicy="no-referrer" width="26" src="./HowToscraping_files/t.png"></a></div><div class="ArticleListItem_userInfo__aP0iX "><div class="ArticleListItem_userName__p6vjX"><a href="https://zenn.dev/toshiro3">toshiro3</a></div><div class="ArticleListItem_meta__CKXPA"><time class="ArticleListItem_date___2_aU" datetime="2026-02-01T22:54:04+09:00">9時間前</time></div></div></div></div></article></div><div class="ArticleList_itemContainer__UNI2Y"><article class="ArticleListItem_container__qIG0Q"><a class="ArticleListItem_emoji__LQo9z" href="https://zenn.dev/mima_ita/articles/f2f05d05fa04cf"><span class="Emoji_twemoji__hcxYF"><span class="Emoji_twemojiImg__Oc6vR" style="background-image: url(&quot;https://asia-northeast1-zenn-dev-production.cloudfunctions.net/twemoji/%F0%9F%98%BA.svg&quot;);"></span></span><span class="Emoji_nativeEmoji__GMBzX">😺</span></a><div class="ArticleListItem_content__dMwpo"><a class="ArticleListItem_link__x5PVw" href="https://zenn.dev/mima_ita/articles/f2f05d05fa04cf"><h2 class="ArticleListItem_title__bnVSg">pandasのDataFrameの可読性を改善する</h2></a><div class="ArticleListItem_user__E8I7_"><div class="ArticleListItem_avatar__iTEjn"><a href="https://zenn.dev/mima_ita"><img alt="mima_ita" class="AvatarImage_plain__Fgp4R " height="26" loading="lazy" referrerpolicy="no-referrer" width="26" src="./HowToscraping_files/unnamed.jpg"></a></div><div class="ArticleListItem_userInfo__aP0iX "><div class="ArticleListItem_userName__p6vjX"><a href="https://zenn.dev/mima_ita">mima_ita</a></div><div class="ArticleListItem_meta__CKXPA"><time class="ArticleListItem_date___2_aU" datetime="2026-02-01T21:23:36+09:00">10時間前</time></div></div></div></div></article></div></div></div></footer></div></article><footer class="AppFooter_footer__pqSnY"><div class="Container_wide__ykGLh Container_common__figYY"><div class="AppFooter_inner__uGxbT" data-nosnippet="true"><div class="AppFooter_brandingColumn__BikTT"><a class="ZennLogo_logoLink__NJS2l" href="https://zenn.dev/"><svg viewBox="0 0 377.4 88.3" aria-label="Zenn | エンジニアのための情報共有コミュニティ" class="ZennLogo_logoSvg__yOhcg" height="20" width="85"><g fill="currentColor"><path d="M233 56.8h-39c.5 3.5 2.2 6.8 4.8 9.2 2.7 2.3 6.2 3.5 9.8 3.4 2.8 0 5.6-.5 8.2-1.7 2.5-1.1 4.8-2.8 6.5-5l8.2 9.5c-2.5 3.4-5.7 6.1-9.5 7.9-4.6 2.2-9.6 3.3-14.7 3.2-5.7.1-11.4-1.2-16.5-4-4.5-2.5-8.2-6.3-10.7-10.9s-3.8-9.8-3.7-15.1v-2.2c-.1-5.7 1.1-11.3 3.5-16.5 2.2-4.7 5.7-8.6 10.1-11.3 4.7-2.8 10.1-4.2 15.5-4.1 5.2-.1 10.3 1.1 14.9 3.7 4.1 2.5 7.4 6.2 9.4 10.5 2.2 5.1 3.3 10.5 3.2 16.1V56.8zM216.1 43.9c.1-2.9-.9-5.7-2.8-7.9-1.8-1.9-4.4-2.9-7.9-2.9-2.9-.1-5.8 1.1-7.7 3.2-2 2.6-3.3 5.7-3.6 9h22V43.9zM128.3 67.9h36.1v14.7h-56.9V72l35.8-54.3h-36.2V2.9h56.6v10.4L128.3 67.9zM248.8 50.7c0-19.1 12.7-29.2 28.2-29.2s27.9 10.1 27.9 29.2V82h-16V51.4c0-10.6-4.8-16.1-12-16.1s-12.4 5.5-12.4 16.1v30.7h-15.8L248.8 50.7 248.8 50.7zM320.3 50.7c0-19.1 12.7-29.2 28.2-29.2s27.9 10.1 27.9 29.2V82h-16V51.4c0-10.6-4.8-16.1-12-16.1S336 40.8 336 51.4v30.7h-15.8L320.3 50.7 320.3 50.7z"></path></g><path fill="#3EA8FF" d="M2.4 83.3h17c.9 0 1.7-.5 2.2-1.2L68.4 5.2C69 4.2 68.3 3 67.1 3H51c-.8 0-1.5.4-1.9 1.1L1.6 81.9C1.3 82.5 1.7 83.3 2.4 83.3zM61 82.1l22.1-35.5c.7-1.1-.1-2.5-1.4-2.5H65.7c-.6 0-1.2.3-1.5.8L41.5 81.2c-.6.9.1 2.1 1.2 2.1h16.3C59.8 83.3 60.6 82.9 61 82.1z" class="st0"></path></svg></a><p class="AppFooter_siteDescription__NWGP2">エンジニアのための<br aria-hidden="true">情報共有コミュニティ</p></div><div class="AppFooter_navColumns__ahV9g"><nav class="AppFooter_navColumn__47qTk"><h4 class="AppFooter_navColumnTitle__vVeiQ">About</h4><ul><li><div style="display:flex;gap:0.5rem;flex-direction:row;align-items:center;flex-wrap:nowrap"><a href="https://zenn.dev/about">Zennについて</a></div></li><li><a href="https://classmethod.jp/" rel="nofollow noopener noreferrer" target="_blank">運営会社</a></li><li><a href="https://info.zenn.dev/" rel="nofollow noopener noreferrer" target="_blank">お知らせ・リリース</a></li><li><div style="display:flex;gap:0.5rem;flex-direction:row;align-items:center;flex-wrap:nowrap"><a href="https://zenn.dev/events">イベント</a></div></li></ul></nav><nav class="AppFooter_navColumn__47qTk"><h4 class="AppFooter_navColumnTitle__vVeiQ">Guides</h4><ul><li><div style="display:flex;gap:0.5rem;flex-direction:row;align-items:center;flex-wrap:nowrap"><a href="https://zenn.dev/manual">使い方</a></div></li><li><div style="display:flex;gap:0.5rem;flex-direction:row;align-items:center;flex-wrap:nowrap"><a href="https://zenn.dev/biz-lp">法人向けメニュー</a><span class="NewLabel_newLabel__gxw6E NewLabel_newLabelBase__Q5W_C">New</span></div></li><li><div style="display:flex;gap:0.5rem;flex-direction:row;align-items:center;flex-wrap:nowrap"><a href="https://zenn.dev/publications">Publication / Pro</a></div></li><li><div style="display:flex;gap:0.5rem;flex-direction:row;align-items:center;flex-wrap:nowrap"><a href="https://zenn.dev/faq">よくある質問</a></div></li></ul></nav><nav class="AppFooter_navColumn__47qTk"><h4 class="AppFooter_navColumnTitle__vVeiQ">Links</h4><ul><li><a href="https://twitter.com/zenn_dev" rel="nofollow noopener noreferrer" target="_blank">X(Twitter)</a></li><li><a href="https://github.com/zenn-dev" rel="nofollow noopener noreferrer" target="_blank">GitHub</a></li><li><div style="display:flex;gap:0.5rem;flex-direction:row;align-items:center;flex-wrap:nowrap"><a href="https://zenn.dev/mediakit">メディアキット</a></div></li></ul></nav><nav class="AppFooter_navColumn__47qTk"><h4 class="AppFooter_navColumnTitle__vVeiQ">Legal</h4><ul><li><div style="display:flex;gap:0.5rem;flex-direction:row;align-items:center;flex-wrap:nowrap"><a href="https://zenn.dev/terms">利用規約</a></div></li><li><div style="display:flex;gap:0.5rem;flex-direction:row;align-items:center;flex-wrap:nowrap"><a href="https://zenn.dev/privacy">プライバシーポリシー</a></div></li><li><div style="display:flex;gap:0.5rem;flex-direction:row;align-items:center;flex-wrap:nowrap"><a href="https://zenn.dev/terms/transaction-law">特商法表記</a></div></li></ul></nav></div></div><div class="AppFooter_copyright__J_Jbe" data-nosnippet="true"><div class="AnnouncementPopUp_hiddenWrapper__ThDWT"><div aria-hidden="true" class="PopUp_popup__lIgfz AnnouncementPopUp_container__Pb5q2"><div></div></div></div><a href="https://classmethod.jp/"><svg viewBox="0 0 271 60" class="AppFooter_classmethodLogo__1RFuV" height="25"><path fill="currentColor" d="M264.636 3.1617C265.475 3.16128 266.279 3.49393 266.873 4.08651C267.466 4.67909 267.8 5.48309 267.801 6.32175V53.0703C267.801 53.5668 267.703 54.0585 267.513 54.5171C267.323 54.9758 267.045 55.3926 266.694 55.7437C266.342 56.0948 265.926 56.3733 265.467 56.5633C265.008 56.7533 264.517 56.851 264.02 56.851H6.93132C5.92861 56.851 4.96697 56.4527 4.25795 55.7437C3.54892 55.0347 3.1506 54.073 3.1506 53.0703V6.93139C3.1506 5.92868 3.54892 4.96704 4.25795 4.25802C4.96697 3.54899 5.92861 3.15067 6.93132 3.15067H225.05C225.137 3.15178 225.221 3.17053 225.3 3.20575C225.379 3.24097 225.449 3.29192 225.507 3.35546L233.987 12.76C234.28 13.0541 234.628 13.2875 235.011 13.4467C235.394 13.606 235.805 13.688 236.22 13.688C236.635 13.688 237.046 13.606 237.429 13.4467C237.812 13.2875 238.16 13.0541 238.453 12.76L246.933 3.35231C246.99 3.28778 247.061 3.23616 247.139 3.20086C247.218 3.16555 247.303 3.14737 247.39 3.14752H264.65L264.636 3.1617ZM264.636 7.17095e-05H246.1C246.006 0.000759845 245.914 0.0205359 245.828 0.058188C245.742 0.0958401 245.665 0.150575 245.602 0.219038L237.347 9.39516C237.334 9.40757 237.323 9.4213 237.313 9.43611C237.018 9.72475 236.622 9.88642 236.21 9.88642C235.797 9.88642 235.402 9.72475 235.107 9.43611C235.094 9.42426 235.082 9.41045 235.072 9.39516L226.843 0.239517C226.775 0.162922 226.691 0.10189 226.597 0.0605717C226.504 0.0192536 226.402 -0.00138099 226.3 7.17095e-05H6.93132C5.09302 7.17095e-05 3.33001 0.730333 2.03014 2.03021C0.730262 3.33008 0 5.09309 0 6.93139L0 53.0719C0 54.9102 0.730262 56.6732 2.03014 57.9731C3.33001 59.273 5.09302 60.0032 6.93132 60.0032H264.02C265.858 60.0032 267.621 59.273 268.921 57.9731C270.221 56.6732 270.951 54.9102 270.951 53.0719V6.31545C270.949 4.64114 270.283 3.03602 269.099 1.8521C267.916 0.668193 266.31 0.00215599 264.636 7.17095e-05Z"></path><path fill="currentColor" d="M29.9653 23.8863C30.0769 23.8895 30.1866 23.9161 30.2873 23.9644 30.388 24.0126 30.4775 24.0813 30.5501 24.1662 30.6226 24.251 30.6766 24.3501 30.7086 24.4571 30.7405 24.5641 30.7498 24.6766 30.7357 24.7873V28.3554C30.7357 28.85 30.4679 29.0769 29.9653 29.0769H22.6008C18.4483 29.0769 17.815 30.4789 17.815 36.1657 17.815 41.8526 18.4452 43.2546 22.6008 43.2546H29.9653C30.46 43.2546 30.7357 43.4814 30.7357 43.9351V47.5457C30.7357 48.0892 30.4679 48.316 29.9653 48.4058 27.5367 48.8538 25.0703 49.0648 22.6008 49.0359 12.982 49.0359 11.1326 46.1074 11.1326 36.1642 11.1326 26.2209 12.982 23.2955 22.6008 23.2955 25.0681 23.2729 27.5325 23.4684 29.9653 23.88M39.7637 17.6701C39.9308 17.6701 40.0911 17.7365 40.2093 17.8547 40.3274 17.9729 40.3938 18.1331 40.3938 18.3003V48.4389C40.3938 48.606 40.3274 48.7663 40.2093 48.8845 40.0911 49.0026 39.9308 49.069 39.7637 49.069H34.3872C34.297 49.0756 34.2064 49.0626 34.1216 49.0311 34.0368 48.9995 33.9598 48.9501 33.8959 48.8861 33.8319 48.8221 33.7825 48.7452 33.7509 48.6604 33.7193 48.5756 33.7064 48.485 33.713 48.3948V18.3444C33.7069 18.258 33.7187 18.1713 33.7477 18.0897 33.7766 18.008 33.8221 17.9333 33.8812 17.87 33.9403 17.8067 34.0118 17.7563 34.0913 17.722 34.1708 17.6876 34.2565 17.6699 34.3431 17.6701H39.7637ZM169.156 35.857V37.259C169.156 38.1601 168.888 38.4767 167.711 38.4767H153.533C153.623 42.541 154.709 43.2624 158.636 43.2624H166.679C166.846 43.2624 167.007 43.3288 167.125 43.447 167.243 43.5652 167.309 43.7255 167.309 43.8926V47.6733C167.32 47.8536 167.26 48.031 167.143 48.1682 167.025 48.3054 166.859 48.3917 166.679 48.409 163.831 48.8866 160.945 49.0976 158.058 49.0391 148.934 49.0391 146.716 46.4682 146.716 36.1673 146.716 25.8664 148.929 23.2955 158.058 23.2955 167.187 23.2955 169.121 25.7782 169.168 35.8507M153.499 34.0911H162.437C162.388 30.1166 161.35 29.0785 158.058 29.0785 154.765 29.0785 153.54 30.1166 153.499 34.0911ZM183.056 43.2908H181.07C179.083 43.2908 178.409 42.9332 178.409 40.9877V29.1462H182.706C182.793 29.1449 182.879 29.126 182.958 29.0907 183.037 29.0553 183.108 29.0043 183.167 28.9407 183.226 28.8771 183.271 28.8022 183.3 28.7206 183.33 28.6389 183.342 28.5522 183.337 28.4657V23.9556C183.337 23.7885 183.27 23.6282 183.152 23.51 183.034 23.3919 182.874 23.3255 182.706 23.3255H178.409V18.2971C178.407 18.1308 178.339 17.9719 178.222 17.8542 178.104 17.7366 177.945 17.6694 177.779 17.667H172.355C172.188 17.667 172.028 17.7334 171.91 17.8515 171.791 17.9697 171.725 18.13 171.725 18.2971V43.242C171.725 48.9351 175.246 49.0706 179.129 49.0706 180.418 49.0631 181.704 48.927 182.966 48.6642 183.072 48.6611 183.176 48.6356 183.272 48.5893 183.367 48.5431 183.452 48.4772 183.52 48.396 183.588 48.3147 183.638 48.22 183.667 48.118 183.696 48.0159 183.703 47.909 183.688 47.804V43.9635C183.694 43.8771 183.682 43.7904 183.653 43.7088 183.624 43.6271 183.579 43.5524 183.52 43.4891 183.46 43.4258 183.389 43.3754 183.309 43.3411 183.23 43.3067 183.144 43.289 183.058 43.2892M234.551 36.1673C234.551 46.4603 232.426 49.0391 223.034 49.0391 213.642 49.0391 211.517 46.4682 211.517 36.1673 211.517 25.8664 213.683 23.2955 223.034 23.2955 232.385 23.2955 234.551 25.8255 234.551 36.1673ZM218.248 36.1673C218.248 41.8604 218.922 43.2561 223.034 43.2561 227.146 43.2561 227.867 41.8541 227.867 36.1673 227.867 30.4805 227.193 29.0785 223.034 29.0785 218.875 29.0785 218.248 30.4805 218.248 36.1673ZM202.566 23.6594C199.378 23.1745 196.135 23.1745 192.947 23.6594V18.3034C192.947 18.1363 192.881 17.976 192.763 17.8578 192.645 17.7397 192.484 17.6733 192.317 17.6733H186.892C186.725 17.6733 186.565 17.7397 186.446 17.8578 186.328 17.976 186.262 18.1363 186.262 18.3034V48.3916C186.256 48.478 186.268 48.5647 186.296 48.6463 186.325 48.7279 186.371 48.8027 186.43 48.866 186.489 48.9292 186.561 48.9796 186.64 49.014 186.72 49.0484 186.805 49.0661 186.892 49.0658H192.317C192.484 49.0658 192.645 48.9995 192.763 48.8813 192.881 48.7631 192.947 48.6028 192.947 48.4357V36.1799C192.947 31.3595 193.084 29.091 197.733 29.091 202.382 29.091 202.595 31.3595 202.566 36.1799 202.538 41.0633 202.566 48.4389 202.566 48.4389 202.566 48.606 202.633 48.7663 202.751 48.8844 202.869 49.0026 203.029 49.069 203.196 49.069H208.622C208.789 49.069 208.949 49.0026 209.067 48.8844 209.185 48.7663 209.252 48.606 209.252 48.4389V34.9212C209.252 27.6749 207.505 24.5526 202.568 23.6515M259.138 17.4449C259.225 17.4388 259.311 17.4506 259.393 17.4796 259.475 17.5085 259.549 17.554 259.613 17.6131 259.676 17.6722 259.726 17.7437 259.761 17.8232 259.795 17.9027 259.813 17.9884 259.813 18.075V46.3831C259.813 47.6686 259.269 48.1301 257.922 48.3775 254.951 48.8327 251.949 49.065 248.943 49.0722 239.241 49.0722 237.248 46.4036 237.248 36.2492 237.248 26.0948 239.255 23.3318 248.236 23.3318 249.877 23.2852 251.519 23.3748 253.146 23.5996V18.1112C253.142 18.026 253.155 17.9408 253.185 17.8609 253.215 17.781 253.261 17.7079 253.32 17.6462 253.378 17.5845 253.449 17.5354 253.528 17.5018 253.606 17.4683 253.691 17.4511 253.776 17.4512H259.16L259.138 17.4449ZM249.066 29.1541C244.507 29.1541 243.916 30.3718 243.916 36.202 243.916 41.5312 244.28 43.2908 248.792 43.2908 250.241 43.2893 251.689 43.184 253.124 42.9758V29.1541H249.06 249.066ZM64.2297 31.0649V45.7656C64.2297 47.4496 63.9887 48.0624 61.5343 48.42 58.703 48.8207 55.8479 49.0312 52.9883 49.0501 46.2146 49.0501 42.6465 48.3286 42.5583 41.2398 42.6481 35.1402 45.8113 33.8359 51.8132 33.8359H57.5473V32.2007C57.5473 30.0347 56.1925 29.0863 53.305 29.0863H45.1245C45.0383 29.0852 44.9532 29.0666 44.8744 29.0318 44.7955 28.9969 44.7245 28.9465 44.6657 28.8835 44.6068 28.8205 44.5613 28.7463 44.5319 28.6653 44.5024 28.5843 44.4897 28.4982 44.4943 28.4121V24.7054C44.4901 24.5281 44.5524 24.3557 44.6691 24.2221 44.7857 24.0886 44.9482 24.0036 45.1245 23.9839 47.8206 23.4882 50.5594 23.2624 53.3003 23.3097 62.2385 23.3097 64.2265 26.1972 64.2265 31.0791M52.3519 38.1679C50.0079 38.1679 49.1887 38.9383 49.1887 40.8774 49.1887 43.0435 50.1796 43.6342 53.0262 43.6342 54.544 43.6442 56.0586 43.4921 57.5441 43.1805V38.1679H52.3519ZM76.6021 28.7618H85.994C86.0798 28.7594 86.1643 28.7399 86.2425 28.7047 86.3207 28.6694 86.3912 28.6189 86.4498 28.5562 86.5084 28.4935 86.554 28.4198 86.5839 28.3394 86.6138 28.2589 86.6275 28.1733 86.6241 28.0876V24.4093C86.6093 24.2197 86.5198 24.0437 86.3754 23.92 86.231 23.7963 86.0434 23.7349 85.8538 23.7492 84.3069 23.5917 82.2023 23.4263 79.6928 23.3507 78.9572 23.316 76.7643 23.3018 76.5028 23.3018 70.7688 23.3018 66.8841 24.6566 66.8841 29.896V30.6175C66.7176 32.1302 67.1073 33.6518 67.9804 34.8983 68.8535 36.1447 70.1503 37.0309 71.6289 37.3913 71.6289 37.3913 78.0167 39.6802 78.2231 39.7637 79.2202 40.2583 79.5778 40.8018 79.5778 41.4965V41.9502C79.5778 43.0781 78.6768 43.5728 76.9171 43.5728H67.5268C67.4402 43.5743 67.3548 43.5934 67.2757 43.6287 67.1966 43.6641 67.1255 43.7151 67.0667 43.7787 67.0078 43.8423 66.9624 43.9171 66.9332 43.9986 66.904 44.0802 66.8916 44.1668 66.8967 44.2533V47.9111C66.8967 48.1317 67.0337 48.5413 67.667 48.5854 69.2139 48.7429 71.3185 48.9083 73.828 48.9839 74.5636 49.0186 76.7565 49.0328 77.018 49.0328 82.752 49.0328 86.6367 47.678 86.6367 42.4386V41.7171C86.8032 40.2044 86.4135 38.6828 85.5404 37.4363 84.6673 36.1898 83.3705 35.3037 81.8919 34.9433 81.8919 34.9433 75.5041 32.6544 75.2977 32.5709 74.3006 32.0762 73.943 31.5328 73.943 30.8381V30.3749C73.943 29.247 74.8441 28.746 76.6037 28.746M98.7933 28.7618H108.185C108.271 28.7594 108.355 28.7399 108.434 28.7047 108.512 28.6694 108.582 28.6189 108.641 28.5562 108.7 28.4935 108.745 28.4198 108.775 28.3394 108.805 28.2589 108.819 28.1733 108.815 28.0876V24.4093C108.8 24.2197 108.711 24.0437 108.567 23.92 108.422 23.7963 108.235 23.7349 108.045 23.7492 106.498 23.5917 104.394 23.4263 101.884 23.3507 101.148 23.316 98.9556 23.3018 98.6941 23.3018 92.96 23.3018 89.0753 24.6566 89.0753 29.896V30.6175C88.9088 32.1302 89.2985 33.6518 90.1716 34.8983 91.0447 36.1447 92.3416 37.0309 93.8201 37.3913 93.8201 37.3913 100.208 39.6802 100.414 39.7637 101.411 40.2583 101.769 40.8018 101.769 41.4965V41.9502C101.769 43.0781 100.868 43.5728 99.1084 43.5728H89.7164C89.6298 43.5743 89.5444 43.5934 89.4653 43.6287 89.3863 43.6641 89.3152 43.7151 89.2563 43.7787 89.1974 43.8423 89.1521 43.9171 89.1229 43.9986 89.0936 44.0802 89.0812 44.1668 89.0863 44.2533V47.9111C89.0863 48.1317 89.2234 48.5413 89.8566 48.5854 91.4036 48.7429 93.5082 48.9083 96.0176 48.9839 96.7533 49.0186 98.9461 49.0328 99.2076 49.0328 104.942 49.0328 108.826 47.678 108.826 42.4386V41.7171C108.993 40.2044 108.603 38.6828 107.73 37.4363 106.857 36.1898 105.56 35.3037 104.082 34.9433 104.082 34.9433 97.6938 32.6544 97.4874 32.5709 96.4902 32.0762 96.1326 31.5328 96.1326 30.8381V30.3749C96.1326 29.247 97.0337 28.746 98.7933 28.746M134.345 23.316C132.106 23.1876 129.868 23.5785 127.806 24.4581 125.75 23.5559 123.506 23.164 121.267 23.316 113.181 23.316 111.386 25.7987 111.386 34.132V48.4137C111.386 48.5808 111.453 48.7411 111.571 48.8592 111.689 48.9774 111.849 49.0438 112.016 49.0438H117.428C117.594 49.0413 117.753 48.9742 117.87 48.8565 117.988 48.7389 118.055 48.58 118.058 48.4137V35.8444C118.058 30.3781 118.573 29.3195 121.262 29.1194 123.765 29.3053 124.384 30.2394 124.46 34.7905V48.4042C124.466 48.5709 124.536 48.7289 124.655 48.846 124.773 48.9631 124.932 49.0304 125.099 49.0343H130.51C130.678 49.0343 130.838 48.9679 130.956 48.8498 131.074 48.7316 131.141 48.5713 131.141 48.4042V34.7921C131.216 30.2331 131.835 29.299 134.338 29.1131 137.027 29.3132 137.543 30.3733 137.543 35.8381V48.4074C137.543 48.5745 137.609 48.7348 137.727 48.8529 137.845 48.9711 138.006 49.0375 138.173 49.0375H143.584C143.75 49.0354 143.909 48.9684 144.027 48.8507 144.145 48.7329 144.212 48.5738 144.214 48.4074V34.1257C144.214 25.7924 142.461 23.3097 134.334 23.3097"></path></svg></a></div></div></footer><div id="modal-portal"></div></div><script id="__NEXT_DATA__" type="application/json" nonce="">{"props":{"pageProps":{"article":{"id":494133,"postType":"Article","slug":"00e11d435247b3","commentsCount":0,"likedCount":0,"bookmarkedCount":0,"bodyLettersCount":25028,"articleType":"tech","emoji":"🏠","isSuspendingPrivate":false,"publishedAt":"2025-12-20T18:46:22.161+09:00","bodyUpdatedAt":"2025-12-08T00:03:21.243+09:00","sourceRepoUpdatedAt":"2025-12-20T18:46:22.154+09:00","pinned":false,"path":"/yamato_snow/articles/00e11d435247b3","principalType":"User","title":"Python + Flask + Selenium で作る SUUMO 物件情報スクレイピングツール","tocEnabled":true,"shouldNoindex":false,"scheduledPublishAt":null,"canSendBadge":true,"status":"published","ogImageUrl":"https://res.cloudinary.com/zenn/image/upload/s--TSDv_w0w--/c_fit%2Cg_north_west%2Cl_text:notosansjp-medium.otf_55:Python%2520%252B%2520Flask%2520%252B%2520Selenium%2520%25E3%2581%25A7%25E4%25BD%259C%25E3%2582%258B%2520SUUMO%2520%25E7%2589%25A9%25E4%25BB%25B6%25E6%2583%2585%25E5%25A0%25B1%25E3%2582%25B9%25E3%2582%25AF%25E3%2583%25AC%25E3%2582%25A4%25E3%2583%2594%25E3%2583%25B3%25E3%2582%25B0%25E3%2583%2584%25E3%2583%25BC%25E3%2583%25AB%2Cw_1010%2Cx_90%2Cy_100/g_south_west%2Cl_text:notosansjp-medium.otf_37:%25E3%2582%2584%25E3%2581%25BE%25E3%2581%25A8%2Cx_203%2Cy_121/g_south_west%2Ch_90%2Cl_fetch:aHR0cHM6Ly9zdG9yYWdlLmdvb2dsZWFwaXMuY29tL3plbm4tdXNlci11cGxvYWQvYXZhdGFyL2UxMTY0YzRhNDUuanBlZw==%2Cr_max%2Cw_90%2Cx_87%2Cy_95/v1627283836/default/og-base-w1200-v2.png?_a=BACAGSGT","bodyHtml":"\u003ch2 id=\"%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\" data-line=\"0\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\" aria-hidden=\"true\"\u003e\u003c/a\u003e はじめに\u003c/h2\u003e\n\u003cp data-line=\"2\" class=\"code-line\"\u003eSUUMOの賃貸物件URLから詳細情報を自動抽出し、Excel/CSV/JSON形式でエクスポートするWebアプリケーションを作成しました。複数の物件情報を一括取得し、比較しやすい形式で出力できるツールです。\u003c/p\u003e\n\u003cp data-line=\"4\" class=\"code-line\"\u003e\u003cstrong\u003eリポジトリ\u003c/strong\u003e: \u003ca href=\"https://github.com/yamato-snow/2025-12-07_sumo-scraping\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003ehttps://github.com/yamato-snow/2025-12-07_sumo-scraping\u003c/a\u003e\u003c/p\u003e\n\u003cp data-line=\"6\" class=\"code-line\"\u003eこの記事では、このツールの技術的なポイントを中心に解説します。BeautifulSoup4によるHTML解析、Seleniumを使ったブラウザ自動化、Server-Sent Events（SSE）によるリアルタイム進捗表示など、実務で役立つ実装パターンを紹介します。\u003c/p\u003e\n\u003ch2 id=\"%E3%81%AA%E3%81%9C%E3%81%93%E3%81%AE%E3%83%84%E3%83%BC%E3%83%AB%E3%82%92%E4%BD%9C%E3%81%A3%E3%81%9F%E3%81%AE%E3%81%8B%EF%BC%9F\" data-line=\"8\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E3%81%AA%E3%81%9C%E3%81%93%E3%81%AE%E3%83%84%E3%83%BC%E3%83%AB%E3%82%92%E4%BD%9C%E3%81%A3%E3%81%9F%E3%81%AE%E3%81%8B%EF%BC%9F\" aria-hidden=\"true\"\u003e\u003c/a\u003e なぜこのツールを作ったのか？\u003c/h2\u003e\n\u003cp data-line=\"10\" class=\"code-line\"\u003e引越し先を探すとき、SUUMOで気になる物件を何件も見つけても、比較するのは大変です。\u003c/p\u003e\n\u003cul data-line=\"12\" class=\"code-line\"\u003e\n\u003cli data-line=\"12\" class=\"code-line\"\u003eタブを大量に開いて行ったり来たりする\u003c/li\u003e\n\u003cli data-line=\"13\" class=\"code-line\"\u003e手作業でExcelに転記して比較表を作る\u003c/li\u003e\n\u003cli data-line=\"14\" class=\"code-line\"\u003e敷金・礼金・管理費など細かい条件を見落とす\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp data-line=\"16\" class=\"code-line\"\u003eこれらの手間を解消するため、物件URLを入力するだけで必要な情報を自動抽出し、Excel/CSV/JSON形式で出力できるツールを作りました。\u003c/p\u003e\n\u003cp data-line=\"18\" class=\"code-line\"\u003eさらに、SUUMOアカウントでログインして「お気に入り」に保存した物件を一括取得する機能も追加しています。\u003c/p\u003e\n\u003ch2 id=\"%E3%81%93%E3%81%AE%E3%83%84%E3%83%BC%E3%83%AB%E3%81%A7%E3%81%A7%E3%81%8D%E3%82%8B%E3%81%93%E3%81%A8\" data-line=\"20\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E3%81%93%E3%81%AE%E3%83%84%E3%83%BC%E3%83%AB%E3%81%A7%E3%81%A7%E3%81%8D%E3%82%8B%E3%81%93%E3%81%A8\" aria-hidden=\"true\"\u003e\u003c/a\u003e このツールでできること\u003c/h2\u003e\n\u003ch3 id=\"%E4%B8%BB%E3%81%AA%E6%A9%9F%E8%83%BD\" data-line=\"22\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E4%B8%BB%E3%81%AA%E6%A9%9F%E8%83%BD\" aria-hidden=\"true\"\u003e\u003c/a\u003e 主な機能\u003c/h3\u003e\n\u003col data-line=\"24\" class=\"code-line\"\u003e\n\u003cli data-line=\"24\" class=\"code-line\"\u003e\n\u003cstrong\u003e物件情報の自動抽出\u003c/strong\u003e - SUUMOの物件URLから詳細情報を取得\u003c/li\u003e\n\u003cli data-line=\"25\" class=\"code-line\"\u003e\n\u003cstrong\u003eお気に入り一括取得\u003c/strong\u003e - SUUMOアカウントでログインして保存済み物件を自動取得\u003c/li\u003e\n\u003cli data-line=\"26\" class=\"code-line\"\u003e\n\u003cstrong\u003e複数フォーマットでエクスポート\u003c/strong\u003e - Excel/CSV/JSON 3形式に対応\u003c/li\u003e\n\u003cli data-line=\"27\" class=\"code-line\"\u003e\n\u003cstrong\u003eリアルタイム進捗表示\u003c/strong\u003e - Server-Sent Events で処理状況をリアルタイム表示\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3 id=\"%E5%8F%96%E5%BE%97%E3%81%A7%E3%81%8D%E3%82%8B%E6%83%85%E5%A0%B1%EF%BC%88%E5%85%A831%E9%A0%85%E7%9B%AE%EF%BC%89\" data-line=\"29\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E5%8F%96%E5%BE%97%E3%81%A7%E3%81%8D%E3%82%8B%E6%83%85%E5%A0%B1%EF%BC%88%E5%85%A831%E9%A0%85%E7%9B%AE%EF%BC%89\" aria-hidden=\"true\"\u003e\u003c/a\u003e 取得できる情報（全31項目）\u003c/h3\u003e\n\u003ctable data-line=\"31\" class=\"code-line\"\u003e\n\u003cthead data-line=\"31\" class=\"code-line\"\u003e\n\u003ctr data-line=\"31\" class=\"code-line\"\u003e\n\u003cth\u003eカテゴリ\u003c/th\u003e\n\u003cth\u003e取得項目\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody data-line=\"33\" class=\"code-line\"\u003e\n\u003ctr data-line=\"33\" class=\"code-line\"\u003e\n\u003ctd\u003e\u003cstrong\u003e基本情報\u003c/strong\u003e\u003c/td\u003e\n\u003ctd\u003eURL、物件名、所在地\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr data-line=\"34\" class=\"code-line\"\u003e\n\u003ctd\u003e\u003cstrong\u003e費用\u003c/strong\u003e\u003c/td\u003e\n\u003ctd\u003e賃料・初期費用、管理費・共益費、敷金、礼金、保証金、敷引・償却\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr data-line=\"35\" class=\"code-line\"\u003e\n\u003ctd\u003e\u003cstrong\u003e物件詳細\u003c/strong\u003e\u003c/td\u003e\n\u003ctd\u003e間取り、専有面積、向き、建物種別、築年数\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr data-line=\"36\" class=\"code-line\"\u003e\n\u003ctd\u003e\u003cstrong\u003eアクセス\u003c/strong\u003e\u003c/td\u003e\n\u003ctd\u003e最寄り駅（最大3つ）、徒歩時間\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr data-line=\"37\" class=\"code-line\"\u003e\n\u003ctd\u003e\u003cstrong\u003eその他\u003c/strong\u003e\u003c/td\u003e\n\u003ctd\u003e損保、駐車場、仲介手数料、保証会社、ほか初期費用、ほか諸費用、備考\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%A6%E3%81%84%E3%82%8B%E6%8A%80%E8%A1%93%E3%82%B9%E3%82%BF%E3%83%83%E3%82%AF%E3%81%AF%EF%BC%9F\" data-line=\"39\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%A6%E3%81%84%E3%82%8B%E6%8A%80%E8%A1%93%E3%82%B9%E3%82%BF%E3%83%83%E3%82%AF%E3%81%AF%EF%BC%9F\" aria-hidden=\"true\"\u003e\u003c/a\u003e 使用している技術スタックは？\u003c/h2\u003e\n\u003ctable data-line=\"41\" class=\"code-line\"\u003e\n\u003cthead data-line=\"41\" class=\"code-line\"\u003e\n\u003ctr data-line=\"41\" class=\"code-line\"\u003e\n\u003cth\u003e領域\u003c/th\u003e\n\u003cth\u003e技術\u003c/th\u003e\n\u003cth\u003e役割\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody data-line=\"43\" class=\"code-line\"\u003e\n\u003ctr data-line=\"43\" class=\"code-line\"\u003e\n\u003ctd\u003e\u003cstrong\u003eBackend\u003c/strong\u003e\u003c/td\u003e\n\u003ctd\u003eFlask 3.x\u003c/td\u003e\n\u003ctd\u003eWebフレームワーク\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr data-line=\"44\" class=\"code-line\"\u003e\n\u003ctd\u003e\u003cstrong\u003eFrontend\u003c/strong\u003e\u003c/td\u003e\n\u003ctd\u003eBootstrap 5 + Vanilla JS\u003c/td\u003e\n\u003ctd\u003eUI\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr data-line=\"45\" class=\"code-line\"\u003e\n\u003ctd\u003e\u003cstrong\u003eスクレイピング\u003c/strong\u003e\u003c/td\u003e\n\u003ctd\u003eBeautifulSoup4 + Requests\u003c/td\u003e\n\u003ctd\u003eHTML解析・HTTP通信\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr data-line=\"46\" class=\"code-line\"\u003e\n\u003ctd\u003e\u003cstrong\u003eブラウザ自動化\u003c/strong\u003e\u003c/td\u003e\n\u003ctd\u003eSelenium + webdriver-manager\u003c/td\u003e\n\u003ctd\u003eログイン処理\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr data-line=\"47\" class=\"code-line\"\u003e\n\u003ctd\u003e\u003cstrong\u003eデータ出力\u003c/strong\u003e\u003c/td\u003e\n\u003ctd\u003epandas + openpyxl\u003c/td\u003e\n\u003ctd\u003eExcel/CSV/JSON出力\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"%E3%81%AA%E3%81%9C%E3%81%93%E3%81%AE%E7%B5%84%E3%81%BF%E5%90%88%E3%82%8F%E3%81%9B%E3%82%92%E9%81%B8%E3%82%93%E3%81%A0%E3%81%AE%E3%81%8B%EF%BC%9F\" data-line=\"49\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E3%81%AA%E3%81%9C%E3%81%93%E3%81%AE%E7%B5%84%E3%81%BF%E5%90%88%E3%82%8F%E3%81%9B%E3%82%92%E9%81%B8%E3%82%93%E3%81%A0%E3%81%AE%E3%81%8B%EF%BC%9F\" aria-hidden=\"true\"\u003e\u003c/a\u003e なぜこの組み合わせを選んだのか？\u003c/h3\u003e\n\u003cp data-line=\"51\" class=\"code-line\"\u003e\u003cstrong\u003eFlask\u003c/strong\u003e を選んだ理由は、シンプルさです。Djangoのような大規模フレームワークはこの規模のツールにはオーバースペックです。APIエンドポイントの定義、SSEの実装、ファイルダウンロードなど、必要な機能をシンプルに実装できます。\u003c/p\u003e\n\u003cp data-line=\"53\" class=\"code-line\"\u003e\u003cstrong\u003eBeautifulSoup4\u003c/strong\u003e は、HTMLの解析においてCSSセレクタとDOM操作の両方に対応しており、直感的に記述できます。Scrapy のようなフレームワークは今回のようなシンプルな用途には過剰です。\u003c/p\u003e\n\u003cp data-line=\"55\" class=\"code-line\"\u003e\u003cstrong\u003eSelenium\u003c/strong\u003e は、ログイン処理に必要です。SUUMOのお気に入り機能を利用するにはログインが必要であり、JavaScriptで動的に生成されるページを扱うにはブラウザ自動化が必要になります。\u003c/p\u003e\n\u003ch2 id=\"%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E6%A7%8B%E6%88%90\" data-line=\"57\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E6%A7%8B%E6%88%90\" aria-hidden=\"true\"\u003e\u003c/a\u003e プロジェクト構成\u003c/h2\u003e\n\u003cdiv class=\"code-block-container\"\u003e\u003cpre class=\"shiki github-dark\" style=\"background-color:#151e2c;color:#e1e4e8\"\u003e\u003ccode class=\"code-line\" data-line=\"59\"\u003e\u003cspan class=\"line\"\u003e\u003cspan\u003eProject_Suumo/\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003e├── app/                    # Flaskアプリケーション\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003e│   ├── __init__.py         # アプリファクトリ\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003e│   ├── routes.py           # APIエンドポイント定義\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003e│   ├── scraper/            # スクレイピングモジュール\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003e│   │   ├── suumo.py        # 物件情報スクレイパー\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003e│   │   └── auth.py         # Selenium認証モジュール\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003e│   ├── exporters/          # エクスポートモジュール\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003e│   │   └── exporter.py     # Excel/CSV/JSON出力\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003e│   ├── templates/          # HTMLテンプレート\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003e│   │   ├── base.html\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003e│   │   └── index.html\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003e│   └── static/css/         # スタイルシート\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003e├── config.py               # Flask設定\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003e├── run.py                  # エントリーポイント\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003e├── requirements.txt        # 依存パッケージ\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003e└── tests/                  # テストコード\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"%E3%82%BB%E3%83%83%E3%83%88%E3%82%A2%E3%83%83%E3%83%97%E6%96%B9%E6%B3%95\" data-line=\"79\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E3%82%BB%E3%83%83%E3%83%88%E3%82%A2%E3%83%83%E3%83%97%E6%96%B9%E6%B3%95\" aria-hidden=\"true\"\u003e\u003c/a\u003e セットアップ方法\u003c/h2\u003e\n\u003ch3 id=\"%E5%89%8D%E6%8F%90%E6%9D%A1%E4%BB%B6\" data-line=\"81\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E5%89%8D%E6%8F%90%E6%9D%A1%E4%BB%B6\" aria-hidden=\"true\"\u003e\u003c/a\u003e 前提条件\u003c/h3\u003e\n\u003cul data-line=\"83\" class=\"code-line\"\u003e\n\u003cli data-line=\"83\" class=\"code-line\"\u003ePython 3.11以上\u003c/li\u003e\n\u003cli data-line=\"84\" class=\"code-line\"\u003eGoogle Chrome（お気に入り取得機能を使う場合）\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB%E6%89%8B%E9%A0%86\" data-line=\"86\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB%E6%89%8B%E9%A0%86\" aria-hidden=\"true\"\u003e\u003c/a\u003e インストール手順\u003c/h3\u003e\n\u003cdiv class=\"code-block-container\"\u003e\u003cpre class=\"shiki github-dark\" style=\"background-color:#151e2c;color:#e1e4e8\"\u003e\u003ccode class=\"code-line\" data-line=\"88\"\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#a0aab5\"\u003e# 1. リポジトリをクローン\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#B392F0\"\u003egit\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e clone\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e https://github.com/yamato-snow/2025-12-07_sumo-scraping.git\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#79B8FF\"\u003ecd\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e 2025-12-07_sumo-scraping\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#a0aab5\"\u003e# 2. 仮想環境をセットアップ\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#B392F0\"\u003epython\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e -m\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e venv\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e .venv\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#79B8FF\"\u003esource\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e .venv/bin/activate\u003c/span\u003e\u003cspan style=\"color:#a0aab5\"\u003e  # macOS/Linux\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#a0aab5\"\u003e# .venv\\Scripts\\activate   # Windows\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#a0aab5\"\u003e# 3. 依存関係をインストール\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#B392F0\"\u003epip\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e install\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e -r\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e requirements.txt\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#a0aab5\"\u003e# 4. アプリを起動\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#B392F0\"\u003epython\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e run.py\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp data-line=\"105\" class=\"code-line\"\u003eブラウザで \u003ca href=\"http://localhost:5001\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003ehttp://localhost:5001\u003c/a\u003e にアクセスすると、Webインターフェースが表示されます。\u003c/p\u003e\n\u003ch3 id=\"%E4%BE%9D%E5%AD%98%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8\" data-line=\"107\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E4%BE%9D%E5%AD%98%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8\" aria-hidden=\"true\"\u003e\u003c/a\u003e 依存パッケージ\u003c/h3\u003e\n\u003cdiv class=\"code-block-container\"\u003e\u003cpre class=\"shiki github-dark\" style=\"background-color:#151e2c;color:#e1e4e8\"\u003e\u003ccode class=\"code-line\" data-line=\"109\"\u003e\u003cspan class=\"line\"\u003e\u003cspan\u003e# Flask Web Framework\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003eflask\u0026gt;=3.0.0\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003eflask-cors\u0026gt;=4.0.0\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003e# Data Processing\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003epandas\u0026gt;=2.0.0\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003eopenpyxl\u0026gt;=3.1.0\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003e# Web Scraping\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003ebeautifulsoup4\u0026gt;=4.12.0\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003erequests\u0026gt;=2.31.0\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003eselenium\u0026gt;=4.15.0\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003ewebdriver-manager\u0026gt;=4.0.0\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003e# Testing\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003epytest\u0026gt;=7.0.0\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"%E4%BD%BF%E3%81%84%E6%96%B9\" data-line=\"128\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E4%BD%BF%E3%81%84%E6%96%B9\" aria-hidden=\"true\"\u003e\u003c/a\u003e 使い方\u003c/h2\u003e\n\u003ch3 id=\"%E6%96%B9%E6%B3%951%3A-url%E6%89%8B%E5%8B%95%E5%85%A5%E5%8A%9B%E3%83%A2%E3%83%BC%E3%83%89\" data-line=\"130\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E6%96%B9%E6%B3%951%3A-url%E6%89%8B%E5%8B%95%E5%85%A5%E5%8A%9B%E3%83%A2%E3%83%BC%E3%83%89\" aria-hidden=\"true\"\u003e\u003c/a\u003e 方法1: URL手動入力モード\u003c/h3\u003e\n\u003col data-line=\"132\" class=\"code-line\"\u003e\n\u003cli data-line=\"132\" class=\"code-line\"\u003eテキストエリアにSUUMO物件URLを1行ずつ入力\u003c/li\u003e\n\u003cli data-line=\"133\" class=\"code-line\"\u003e出力形式（Excel/CSV/JSON）を選択\u003c/li\u003e\n\u003cli data-line=\"134\" class=\"code-line\"\u003e「スクレイピング開始」ボタンをクリック\u003c/li\u003e\n\u003cli data-line=\"135\" class=\"code-line\"\u003e処理完了後、ダウンロードボタンから結果を取得\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3 id=\"%E6%96%B9%E6%B3%952%3A-%E3%81%8A%E6%B0%97%E3%81%AB%E5%85%A5%E3%82%8A%E5%8F%96%E5%BE%97%E3%83%A2%E3%83%BC%E3%83%89\" data-line=\"137\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E6%96%B9%E6%B3%952%3A-%E3%81%8A%E6%B0%97%E3%81%AB%E5%85%A5%E3%82%8A%E5%8F%96%E5%BE%97%E3%83%A2%E3%83%BC%E3%83%89\" aria-hidden=\"true\"\u003e\u003c/a\u003e 方法2: お気に入り取得モード\u003c/h3\u003e\n\u003col data-line=\"139\" class=\"code-line\"\u003e\n\u003cli data-line=\"139\" class=\"code-line\"\u003e「お気に入りから取得」タブを選択\u003c/li\u003e\n\u003cli data-line=\"140\" class=\"code-line\"\u003eSUUMOアカウントのメールアドレスとパスワードを入力\u003c/li\u003e\n\u003cli data-line=\"141\" class=\"code-line\"\u003e「お気に入りを取得」ボタンをクリック\u003c/li\u003e\n\u003cli data-line=\"142\" class=\"code-line\"\u003e取得されたURLが自動でテキストエリアに入力される\u003c/li\u003e\n\u003cli data-line=\"143\" class=\"code-line\"\u003e以降は方法1と同様\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"%E3%82%B9%E3%82%AF%E3%83%AC%E3%82%A4%E3%83%94%E3%83%B3%E3%82%B0%E3%82%92%E5%A7%8B%E3%82%81%E3%82%8B%E5%89%8D%E3%81%AB%E7%9F%A5%E3%81%A3%E3%81%A6%E3%81%8A%E3%81%8F%E3%81%B9%E3%81%8D%E3%81%93%E3%81%A8\" data-line=\"145\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E3%82%B9%E3%82%AF%E3%83%AC%E3%82%A4%E3%83%94%E3%83%B3%E3%82%B0%E3%82%92%E5%A7%8B%E3%82%81%E3%82%8B%E5%89%8D%E3%81%AB%E7%9F%A5%E3%81%A3%E3%81%A6%E3%81%8A%E3%81%8F%E3%81%B9%E3%81%8D%E3%81%93%E3%81%A8\" aria-hidden=\"true\"\u003e\u003c/a\u003e スクレイピングを始める前に知っておくべきこと\u003c/h2\u003e\n\u003cp data-line=\"147\" class=\"code-line\"\u003eスクレイピングは便利な技術ですが、法的リスクや倫理的な問題を理解せずに行うと、トラブルに発展する可能性があります。\u003cstrong\u003e必ず以下の内容を理解した上で実行してください。\u003c/strong\u003e\u003c/p\u003e\n\u003ch3 id=\"1.-%E6%B3%95%E7%9A%84%E3%83%AA%E3%82%B9%E3%82%AF%E3%82%92%E7%90%86%E8%A7%A3%E3%81%99%E3%82%8B\" data-line=\"149\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#1.-%E6%B3%95%E7%9A%84%E3%83%AA%E3%82%B9%E3%82%AF%E3%82%92%E7%90%86%E8%A7%A3%E3%81%99%E3%82%8B\" aria-hidden=\"true\"\u003e\u003c/a\u003e 1. 法的リスクを理解する\u003c/h3\u003e\n\u003cp data-line=\"151\" class=\"code-line\"\u003eスクレイピングに関連する主な法律は以下の3つです。\u003c/p\u003e\n\u003ch4 id=\"%E4%B8%8D%E6%AD%A3%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E7%A6%81%E6%AD%A2%E6%B3%95\" data-line=\"153\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E4%B8%8D%E6%AD%A3%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E7%A6%81%E6%AD%A2%E6%B3%95\" aria-hidden=\"true\"\u003e\u003c/a\u003e 不正アクセス禁止法\u003c/h4\u003e\n\u003cp data-line=\"155\" class=\"code-line\"\u003eアクセス制限がかけられているシステムに、その制限を回避してアクセスする行為は違法です。\u003c/p\u003e\n\u003cul data-line=\"157\" class=\"code-line\"\u003e\n\u003cli data-line=\"157\" class=\"code-line\"\u003e\n\u003cstrong\u003eログイン認証の突破\u003c/strong\u003e: 本ツールのお気に入り取得機能は、ユーザー自身のアカウントでログインする機能です。他人のアカウントを使用したり、認証を回避する行為は違法です\u003c/li\u003e\n\u003cli data-line=\"158\" class=\"code-line\"\u003e\n\u003cstrong\u003eCAPTCHA回避\u003c/strong\u003e: CAPTCHA（画像認証）を自動的に突破する行為は不正アクセスとみなされる可能性があります\u003c/li\u003e\n\u003cli data-line=\"159\" class=\"code-line\"\u003e\n\u003cstrong\u003eレート制限の回避\u003c/strong\u003e: サーバー側で設定されているアクセス制限を意図的に回避する行為も問題になり得ます\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"%E8%91%97%E4%BD%9C%E6%A8%A9%E6%B3%95\" data-line=\"161\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E8%91%97%E4%BD%9C%E6%A8%A9%E6%B3%95\" aria-hidden=\"true\"\u003e\u003c/a\u003e 著作権法\u003c/h4\u003e\n\u003cp data-line=\"163\" class=\"code-line\"\u003eウェブサイトのコンテンツは著作物として保護されています。\u003c/p\u003e\n\u003cul data-line=\"165\" class=\"code-line\"\u003e\n\u003cli data-line=\"165\" class=\"code-line\"\u003e\n\u003cstrong\u003e私的利用の範囲\u003c/strong\u003e: 個人的に情報を整理・比較する目的であれば、著作権法の「私的使用のための複製」に該当する可能性があります\u003c/li\u003e\n\u003cli data-line=\"166\" class=\"code-line\"\u003e\n\u003cstrong\u003e再配布・商用利用は禁止\u003c/strong\u003e: 取得したデータを第三者に配布したり、商用目的で利用することは著作権侵害になります\u003c/li\u003e\n\u003cli data-line=\"167\" class=\"code-line\"\u003e\n\u003cstrong\u003eデータベースの著作権\u003c/strong\u003e: 物件情報の集合体としてのデータベースにも著作権が発生する場合があります\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"%E6%A5%AD%E5%8B%99%E5%A6%A8%E5%AE%B3%E7%BD%AA%EF%BC%88%E5%81%BD%E8%A8%88%E6%A5%AD%E5%8B%99%E5%A6%A8%E5%AE%B3%E3%83%BB%E9%9B%BB%E5%AD%90%E8%A8%88%E7%AE%97%E6%A9%9F%E6%90%8D%E5%A3%8A%E7%AD%89%E6%A5%AD%E5%8B%99%E5%A6%A8%E5%AE%B3%EF%BC%89\" data-line=\"169\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E6%A5%AD%E5%8B%99%E5%A6%A8%E5%AE%B3%E7%BD%AA%EF%BC%88%E5%81%BD%E8%A8%88%E6%A5%AD%E5%8B%99%E5%A6%A8%E5%AE%B3%E3%83%BB%E9%9B%BB%E5%AD%90%E8%A8%88%E7%AE%97%E6%A9%9F%E6%90%8D%E5%A3%8A%E7%AD%89%E6%A5%AD%E5%8B%99%E5%A6%A8%E5%AE%B3%EF%BC%89\" aria-hidden=\"true\"\u003e\u003c/a\u003e 業務妨害罪（偽計業務妨害・電子計算機損壊等業務妨害）\u003c/h4\u003e\n\u003cp data-line=\"171\" class=\"code-line\"\u003eサーバーに過度な負荷をかけ、サービスの運営を妨害する行為は犯罪です。\u003c/p\u003e\n\u003cul data-line=\"173\" class=\"code-line\"\u003e\n\u003cli data-line=\"173\" class=\"code-line\"\u003e\n\u003cstrong\u003e大量リクエスト\u003c/strong\u003e: 短時間に大量のリクエストを送信し、サーバーをダウンさせる行為\u003c/li\u003e\n\u003cli data-line=\"174\" class=\"code-line\"\u003e\n\u003cstrong\u003e継続的な高負荷\u003c/strong\u003e: 長時間にわたって高頻度でアクセスし続ける行為\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp data-line=\"176\" class=\"code-line\"\u003e\u003cstrong\u003e過去の判例\u003c/strong\u003e: 2010年の岡崎市立中央図書館事件では、図書館のウェブサイトに対する自動アクセスが業務妨害として問題になりました（最終的に不起訴）。技術的には問題のないアクセス頻度でも、相手側のシステムによっては問題視される可能性があります。\u003c/p\u003e\n\u003ch3 id=\"2.-%E4%BA%8B%E5%89%8D%E3%81%AB%E7%A2%BA%E8%AA%8D%E3%81%99%E3%81%B9%E3%81%8D%E3%81%93%E3%81%A8\" data-line=\"178\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#2.-%E4%BA%8B%E5%89%8D%E3%81%AB%E7%A2%BA%E8%AA%8D%E3%81%99%E3%81%B9%E3%81%8D%E3%81%93%E3%81%A8\" aria-hidden=\"true\"\u003e\u003c/a\u003e 2. 事前に確認すべきこと\u003c/h3\u003e\n\u003cp data-line=\"180\" class=\"code-line\"\u003eスクレイピングを実行する前に、必ず以下を確認してください。\u003c/p\u003e\n\u003ch4 id=\"robots.txt-%E3%81%AE%E7%A2%BA%E8%AA%8D\" data-line=\"182\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#robots.txt-%E3%81%AE%E7%A2%BA%E8%AA%8D\" aria-hidden=\"true\"\u003e\u003c/a\u003e robots.txt の確認\u003c/h4\u003e\n\u003cp data-line=\"184\" class=\"code-line\"\u003e\u003ccode\u003erobots.txt\u003c/code\u003eは、ウェブサイトがクローラー（自動アクセスプログラム）に対してアクセス可否を示すファイルです。\u003c/p\u003e\n\u003cp data-line=\"186\" class=\"code-line\"\u003e**SUUMOのrobots.txt（\u003ca href=\"https://suumo.jp/robots.txt%EF%BC%89%E3%81%AE%E4%B8%BB%E3%81%AA%E5%86%85%E5%AE%B9**:\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003ehttps://suumo.jp/robots.txt）の主な内容**:\u003c/a\u003e\u003c/p\u003e\n\u003cp data-line=\"188\" class=\"code-line\"\u003eSUUMOのrobots.txtは非常に詳細で、約200行以上のDisallow指定があります。\u003c/p\u003e\n\u003cdiv class=\"code-block-container\"\u003e\u003cpre class=\"shiki github-dark\" style=\"background-color:#151e2c;color:#e1e4e8\"\u003e\u003ccode class=\"code-line\" data-line=\"190\"\u003e\u003cspan class=\"line\"\u003e\u003cspan\u003eUser-agent: *\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003e# 編集・管理関連\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003eDisallow: /edit/rewrite/\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003eDisallow: /edit/include\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003eDisallow: /edit/ssi\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003eDisallow: /edit/error/error.html\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003e# モバイル\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003eDisallow: /mb/\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003e# 内部パーツ（JS/CSS/API）\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003eDisallow: /jj/kaisha/top/JJ052FA001/\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003eDisallow: /jj/chintai/common/JJ901FI396/\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003eDisallow: /jj/common/parts/JJ901FI402/\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003e# ... 多数のjjパスがDisallow\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003e# 賃貸関連の特定パス\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003eDisallow: /chintai/bc_*/printout/          # 印刷ページ\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003eDisallow: /chintai/*/__JJ_FR301FC001       # 内部機能\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003eDisallow: /chintai/*/__JJ_FR301FC005\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003eDisallow: /chintai/*/__JJ_FR301FB001\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003eDisallow: /map/chintai/                     # 地図機能\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003e# SP（スマホ）API\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003eDisallow: /sp/chintai/api/bukken/count/\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003eDisallow: /sp/chintai/api/bukken/ninkido/hankyoCount/\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003eDisallow: /sp/chintai/map/bukken/points/\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003e# クエリパラメータ\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003eDisallow: /*?*sort=\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003eDisallow: /*?rnekTmp=\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003eDisallow: /*?rnTmp=\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003eDisallow: /*?cinm=\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003eUser-agent: bingbot\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003eCrawl-delay: 30        # 30秒の待機を推奨\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003eAllow: /journal/\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003eUser-agent: Googlebot\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003eAllow: /journal/\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003e# ... 他は*と同様のDisallow\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp data-line=\"234\" class=\"code-line\"\u003e\u003cstrong\u003eSUUMOのrobots.txtの重要ポイント\u003c/strong\u003e:\u003c/p\u003e\n\u003ctable data-line=\"236\" class=\"code-line\"\u003e\n\u003cthead data-line=\"236\" class=\"code-line\"\u003e\n\u003ctr data-line=\"236\" class=\"code-line\"\u003e\n\u003cth\u003e項目\u003c/th\u003e\n\u003cth\u003e内容\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody data-line=\"238\" class=\"code-line\"\u003e\n\u003ctr data-line=\"238\" class=\"code-line\"\u003e\n\u003ctd\u003e\u003cstrong\u003eDisallowされているパス\u003c/strong\u003e\u003c/td\u003e\n\u003ctd\u003e\n\u003ccode\u003e/edit/\u003c/code\u003e、\u003ccode\u003e/mb/\u003c/code\u003e、\u003ccode\u003e/jj/\u003c/code\u003e配下の多数のパス、印刷ページ、API、内部機能\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr data-line=\"239\" class=\"code-line\"\u003e\n\u003ctd\u003e\u003cstrong\u003e賃貸物件詳細ページ\u003c/strong\u003e\u003c/td\u003e\n\u003ctd\u003e\n\u003ccode\u003e/chintai/tokyo/sc_xxxxx/\u003c/code\u003eのような通常の物件ページは\u003cstrong\u003e明示的にDisallowされていない\u003c/strong\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr data-line=\"240\" class=\"code-line\"\u003e\n\u003ctd\u003e\u003cstrong\u003eCrawl-delay\u003c/strong\u003e\u003c/td\u003e\n\u003ctd\u003ebingbotには\u003cstrong\u003e30秒の待機\u003c/strong\u003eが指定されている\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr data-line=\"241\" class=\"code-line\"\u003e\n\u003ctd\u003e\u003cstrong\u003e許可されているパス\u003c/strong\u003e\u003c/td\u003e\n\u003ctd\u003e\n\u003ccode\u003e/journal/\u003c/code\u003e（Googlebot、bingbot等に許可）\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp data-line=\"243\" class=\"code-line\"\u003e\u003cstrong\u003e重要な注意点\u003c/strong\u003e:\u003c/p\u003e\n\u003col data-line=\"245\" class=\"code-line\"\u003e\n\u003cli data-line=\"245\" class=\"code-line\"\u003e\n\u003cp data-line=\"245\" class=\"code-line\"\u003e\u003cstrong\u003eCrawl-delay: 30\u003c/strong\u003e - bingbotには30秒の待機が指定されています。これはSUUMOがクローラーに対して「30秒間隔でアクセスしてほしい」という意思表示です。一般的なスクレイピングでも、この値を参考に十分な間隔を空けるべきです。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli data-line=\"247\" class=\"code-line\"\u003e\n\u003cp data-line=\"247\" class=\"code-line\"\u003e\u003cstrong\u003e物件詳細ページについて\u003c/strong\u003e - 通常の物件詳細ページ（\u003ccode\u003e/chintai/tokyo/sc_xxxxx/\u003c/code\u003eなど）は明示的にDisallowされていませんが、これは「許可されている」という意味ではありません。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli data-line=\"249\" class=\"code-line\"\u003e\n\u003cp data-line=\"249\" class=\"code-line\"\u003e\u003cstrong\u003e法的拘束力\u003c/strong\u003e - \u003ccode\u003erobots.txt\u003c/code\u003eは法的拘束力はなく、あくまでサイト運営者の意思表示です。ただし、無視してスクレイピングを行うと、利用規約違反やIPブロックの対象になる可能性があります。\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch4 id=\"%E5%88%A9%E7%94%A8%E8%A6%8F%E7%B4%84%E3%81%AE%E7%A2%BA%E8%AA%8D\" data-line=\"251\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E5%88%A9%E7%94%A8%E8%A6%8F%E7%B4%84%E3%81%AE%E7%A2%BA%E8%AA%8D\" aria-hidden=\"true\"\u003e\u003c/a\u003e 利用規約の確認\u003c/h4\u003e\n\u003cp data-line=\"253\" class=\"code-line\"\u003eSUUMOの\u003ca href=\"https://suumo.jp/edit/kiyaku/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e利用規約\u003c/a\u003eでは、以下の点が明記されています。\u003c/p\u003e\n\u003cp data-line=\"255\" class=\"code-line\"\u003e\u003cstrong\u003e第2条（著作権）\u003c/strong\u003e:\u003c/p\u003e\n\u003cblockquote data-line=\"256\" class=\"code-line\"\u003e\n\u003cp data-line=\"256\" class=\"code-line\"\u003e本サイトを通じて提供されるすべてのコンテンツについて、当社の事前の承諾なく\u003cstrong\u003e著作権法で定めるユーザー個人の私的利用の範囲を超える使用をしてはならない\u003c/strong\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp data-line=\"258\" class=\"code-line\"\u003e\u003cstrong\u003e第3条（禁止行為）\u003c/strong\u003e:\u003c/p\u003e\n\u003cblockquote data-line=\"259\" class=\"code-line\"\u003e\n\u003cp data-line=\"259\" class=\"code-line\"\u003e(2) 他のユーザーまたは第三者の著作権、肖像権、その他知的財産権を侵害する行為\u003cbr\u003e\n(7) \u003cstrong\u003e商業目的で利用する行為\u003c/strong\u003e（当社が認める場合を除く）\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp data-line=\"262\" class=\"code-line\"\u003e\u003cstrong\u003eSUUMOの利用規約のポイント\u003c/strong\u003e:\u003c/p\u003e\n\u003cul data-line=\"263\" class=\"code-line\"\u003e\n\u003cli data-line=\"263\" class=\"code-line\"\u003eスクレイピング自体を明示的に禁止する条項は見当たらない\u003c/li\u003e\n\u003cli data-line=\"264\" class=\"code-line\"\u003eただし「\u003cstrong\u003e私的利用の範囲を超える使用\u003c/strong\u003e」は禁止されている\u003c/li\u003e\n\u003cli data-line=\"265\" class=\"code-line\"\u003e「\u003cstrong\u003e商業目的での利用\u003c/strong\u003e」は明確に禁止されている\u003c/li\u003e\n\u003cli data-line=\"266\" class=\"code-line\"\u003e著作権侵害となる行為は禁止されている\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp data-line=\"268\" class=\"code-line\"\u003eつまり、\u003cstrong\u003e個人的な物件比較のために数件〜数十件の情報を取得する程度であれば「私的利用の範囲」と解釈できる可能性がありますが、大量のデータ収集や商用利用は明確に利用規約違反\u003c/strong\u003eとなります\u003c/p\u003e\n\u003caside class=\"msg alert\"\u003e\u003cspan class=\"msg-symbol\"\u003e!\u003c/span\u003e\u003cdiv class=\"msg-content\"\u003e\n\u003cp data-line=\"271\" class=\"code-line\"\u003e\u003cstrong\u003e免責事項\u003c/strong\u003e: 本ツールは技術的な学習・研究目的で作成されています。実際にスクレイピングを行う場合は、必ずご自身で利用規約を確認し、自己責任で判断してください。利用規約に違反した場合のトラブルについて、作者は一切の責任を負いません。\u003c/p\u003e\n\u003c/div\u003e\u003c/aside\u003e\n\u003ch3 id=\"3.-%E3%82%B9%E3%82%AF%E3%83%AC%E3%82%A4%E3%83%94%E3%83%B3%E3%82%B0%E3%81%AE%E3%83%9E%E3%83%8A%E3%83%BC%EF%BC%88%E3%83%99%E3%82%B9%E3%83%88%E3%83%97%E3%83%A9%E3%82%AF%E3%83%86%E3%82%A3%E3%82%B9%EF%BC%89\" data-line=\"274\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#3.-%E3%82%B9%E3%82%AF%E3%83%AC%E3%82%A4%E3%83%94%E3%83%B3%E3%82%B0%E3%81%AE%E3%83%9E%E3%83%8A%E3%83%BC%EF%BC%88%E3%83%99%E3%82%B9%E3%83%88%E3%83%97%E3%83%A9%E3%82%AF%E3%83%86%E3%82%A3%E3%82%B9%EF%BC%89\" aria-hidden=\"true\"\u003e\u003c/a\u003e 3. スクレイピングのマナー（ベストプラクティス）\u003c/h3\u003e\n\u003cp data-line=\"276\" class=\"code-line\"\u003e法的・倫理的に問題のないスクレイピングを行うためのガイドラインです。\u003c/p\u003e\n\u003ch4 id=\"%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E9%96%93%E9%9A%94%E3%82%92%E5%8D%81%E5%88%86%E3%81%AB%E7%A9%BA%E3%81%91%E3%82%8B\" data-line=\"278\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E9%96%93%E9%9A%94%E3%82%92%E5%8D%81%E5%88%86%E3%81%AB%E7%A9%BA%E3%81%91%E3%82%8B\" aria-hidden=\"true\"\u003e\u003c/a\u003e アクセス間隔を十分に空ける\u003c/h4\u003e\n\u003cdiv class=\"code-block-container\"\u003e\u003cpre class=\"shiki github-dark\" style=\"background-color:#151e2c;color:#e1e4e8\"\u003e\u003ccode class=\"code-line\" data-line=\"280\"\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#a0aab5\"\u003e# 悪い例：待機なし\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003efor\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e url \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003ein\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e urls:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    scrape(url)  \u003c/span\u003e\u003cspan style=\"color:#a0aab5\"\u003e# サーバーに過大な負荷\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#a0aab5\"\u003e# 良い例：十分な間隔を空ける\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003eimport\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e time\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003efor\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e url \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003ein\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e urls:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    scrape(url)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    time.sleep(\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e5\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e)  \u003c/span\u003e\u003cspan style=\"color:#a0aab5\"\u003e# 5秒以上待機を推奨\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp data-line=\"292\" class=\"code-line\"\u003e\u003cstrong\u003e推奨間隔の目安\u003c/strong\u003e:\u003c/p\u003e\n\u003ctable data-line=\"294\" class=\"code-line\"\u003e\n\u003cthead data-line=\"294\" class=\"code-line\"\u003e\n\u003ctr data-line=\"294\" class=\"code-line\"\u003e\n\u003cth\u003eサイトの指定\u003c/th\u003e\n\u003cth\u003e推奨間隔\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody data-line=\"296\" class=\"code-line\"\u003e\n\u003ctr data-line=\"296\" class=\"code-line\"\u003e\n\u003ctd\u003eCrawl-delay指定あり\u003c/td\u003e\n\u003ctd\u003e指定値以上（SUUMOは30秒）\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr data-line=\"297\" class=\"code-line\"\u003e\n\u003ctd\u003eCrawl-delay指定なし\u003c/td\u003e\n\u003ctd\u003e最低5秒以上\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr data-line=\"298\" class=\"code-line\"\u003e\n\u003ctd\u003e保守的に運用する場合\u003c/td\u003e\n\u003ctd\u003e10〜30秒\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003caside class=\"msg message\"\u003e\u003cspan class=\"msg-symbol\"\u003e!\u003c/span\u003e\u003cdiv class=\"msg-content\"\u003e\n\u003cp data-line=\"301\" class=\"code-line\"\u003e\u003cstrong\u003eSUUMOの場合\u003c/strong\u003e: robots.txtでbingbotに対して\u003ccode\u003eCrawl-delay: 30\u003c/code\u003eが指定されています。これはSUUMOがクローラーに「30秒間隔でアクセスしてほしい」と明示している値です。本ツールでは最低2秒の間隔を設定していますが、より安全に運用する場合は\u003cstrong\u003e10〜30秒の間隔\u003c/strong\u003eを推奨します。\u003c/p\u003e\n\u003c/div\u003e\u003c/aside\u003e\n\u003ch4 id=\"%E5%90%8C%E6%99%82%E6%8E%A5%E7%B6%9A%E6%95%B0%E3%82%92%E5%88%B6%E9%99%90%E3%81%99%E3%82%8B\" data-line=\"304\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E5%90%8C%E6%99%82%E6%8E%A5%E7%B6%9A%E6%95%B0%E3%82%92%E5%88%B6%E9%99%90%E3%81%99%E3%82%8B\" aria-hidden=\"true\"\u003e\u003c/a\u003e 同時接続数を制限する\u003c/h4\u003e\n\u003cp data-line=\"306\" class=\"code-line\"\u003e複数スレッドで同時にアクセスする場合は、同時接続数を制限してください。\u003c/p\u003e\n\u003cdiv class=\"code-block-container\"\u003e\u003cpre class=\"shiki github-dark\" style=\"background-color:#151e2c;color:#e1e4e8\"\u003e\u003ccode class=\"code-line\" data-line=\"308\"\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003efrom\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e concurrent.futures \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003eimport\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e ThreadPoolExecutor\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#a0aab5\"\u003e# 同時接続数を2〜4に制限\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003eexecutor \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e ThreadPoolExecutor(\u003c/span\u003e\u003cspan style=\"color:#FFAB70\"\u003emax_workers\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e2\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"%E9%81%A9%E5%88%87%E3%81%AAuser-agent%E3%82%92%E8%A8%AD%E5%AE%9A%E3%81%99%E3%82%8B\" data-line=\"315\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E9%81%A9%E5%88%87%E3%81%AAuser-agent%E3%82%92%E8%A8%AD%E5%AE%9A%E3%81%99%E3%82%8B\" aria-hidden=\"true\"\u003e\u003c/a\u003e 適切なUser-Agentを設定する\u003c/h4\u003e\n\u003cp data-line=\"317\" class=\"code-line\"\u003e自分が何者かを明示することは、最低限のマナーです。\u003c/p\u003e\n\u003cdiv class=\"code-block-container\"\u003e\u003cpre class=\"shiki github-dark\" style=\"background-color:#151e2c;color:#e1e4e8\"\u003e\u003ccode class=\"code-line\" data-line=\"319\"\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003eheaders \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e    'User-Agent'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e: \u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'Mozilla/5.0 (compatible; MyBot/1.0; +http://example.com/bot)'\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e}\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E6%99%82%E9%96%93%E5%B8%AF%E3%81%AB%E9%85%8D%E6%85%AE%E3%81%99%E3%82%8B\" data-line=\"325\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E6%99%82%E9%96%93%E5%B8%AF%E3%81%AB%E9%85%8D%E6%85%AE%E3%81%99%E3%82%8B\" aria-hidden=\"true\"\u003e\u003c/a\u003e アクセス時間帯に配慮する\u003c/h4\u003e\n\u003cul data-line=\"327\" class=\"code-line\"\u003e\n\u003cli data-line=\"327\" class=\"code-line\"\u003e深夜〜早朝（サーバー負荷が低い時間帯）にアクセスする\u003c/li\u003e\n\u003cli data-line=\"328\" class=\"code-line\"\u003eサービスの繁忙期（引越しシーズンなど）は避ける\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"%E5%BF%85%E8%A6%81%E6%9C%80%E5%B0%8F%E9%99%90%E3%81%AE%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E3%81%BF%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B\" data-line=\"330\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E5%BF%85%E8%A6%81%E6%9C%80%E5%B0%8F%E9%99%90%E3%81%AE%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E3%81%BF%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B\" aria-hidden=\"true\"\u003e\u003c/a\u003e 必要最小限のデータのみ取得する\u003c/h4\u003e\n\u003cul data-line=\"332\" class=\"code-line\"\u003e\n\u003cli data-line=\"332\" class=\"code-line\"\u003e不要なページにはアクセスしない\u003c/li\u003e\n\u003cli data-line=\"333\" class=\"code-line\"\u003e一度取得したデータはキャッシュして再利用する\u003c/li\u003e\n\u003cli data-line=\"334\" class=\"code-line\"\u003e全ページを網羅的に取得するような行為は避ける\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"4.-suumo%E3%81%A7%E3%82%B9%E3%82%AF%E3%83%AC%E3%82%A4%E3%83%94%E3%83%B3%E3%82%B0%E3%82%92%E8%A1%8C%E3%81%86%E9%9A%9B%E3%81%AE%E6%B3%A8%E6%84%8F\" data-line=\"336\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#4.-suumo%E3%81%A7%E3%82%B9%E3%82%AF%E3%83%AC%E3%82%A4%E3%83%94%E3%83%B3%E3%82%B0%E3%82%92%E8%A1%8C%E3%81%86%E9%9A%9B%E3%81%AE%E6%B3%A8%E6%84%8F\" aria-hidden=\"true\"\u003e\u003c/a\u003e 4. SUUMOでスクレイピングを行う際の注意\u003c/h3\u003e\n\u003ch4 id=\"%E6%9C%AC%E3%83%84%E3%83%BC%E3%83%AB%E3%81%AE%E6%83%B3%E5%AE%9A%E3%83%A6%E3%83%BC%E3%82%B9%E3%82%B1%E3%83%BC%E3%82%B9\" data-line=\"338\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E6%9C%AC%E3%83%84%E3%83%BC%E3%83%AB%E3%81%AE%E6%83%B3%E5%AE%9A%E3%83%A6%E3%83%BC%E3%82%B9%E3%82%B1%E3%83%BC%E3%82%B9\" aria-hidden=\"true\"\u003e\u003c/a\u003e 本ツールの想定ユースケース\u003c/h4\u003e\n\u003col data-line=\"340\" class=\"code-line\"\u003e\n\u003cli data-line=\"340\" class=\"code-line\"\u003e\n\u003cstrong\u003e個人的な物件比較\u003c/strong\u003e: 自分が検討している数件〜数十件の物件情報を整理する\u003c/li\u003e\n\u003cli data-line=\"341\" class=\"code-line\"\u003e\n\u003cstrong\u003eお気に入り物件の一括管理\u003c/strong\u003e: 自分のアカウントに保存した物件を一括でダウンロードする\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch4 id=\"%E4%BB%A5%E4%B8%8B%E3%81%AE%E8%A1%8C%E7%82%BA%E3%81%AF%E7%B5%B6%E5%AF%BE%E3%81%AB%E9%81%BF%E3%81%91%E3%81%A6%E3%81%8F%E3%81%A0%E3%81%95%E3%81%84\" data-line=\"343\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E4%BB%A5%E4%B8%8B%E3%81%AE%E8%A1%8C%E7%82%BA%E3%81%AF%E7%B5%B6%E5%AF%BE%E3%81%AB%E9%81%BF%E3%81%91%E3%81%A6%E3%81%8F%E3%81%A0%E3%81%95%E3%81%84\" aria-hidden=\"true\"\u003e\u003c/a\u003e 以下の行為は絶対に避けてください\u003c/h4\u003e\n\u003cul data-line=\"345\" class=\"code-line\"\u003e\n\u003cli data-line=\"345\" class=\"code-line\"\u003e全物件データの網羅的な収集\u003c/li\u003e\n\u003cli data-line=\"346\" class=\"code-line\"\u003e取得したデータの第三者への販売・配布\u003c/li\u003e\n\u003cli data-line=\"347\" class=\"code-line\"\u003e競合サービスの構築を目的としたデータ収集\u003c/li\u003e\n\u003cli data-line=\"348\" class=\"code-line\"\u003e大量のアカウントを作成しての自動アクセス\u003c/li\u003e\n\u003cli data-line=\"349\" class=\"code-line\"\u003eIPアドレスを偽装しての大量アクセス\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"%E4%B8%BB%E8%A6%81%E3%81%AA%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88\" data-line=\"351\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E4%B8%BB%E8%A6%81%E3%81%AA%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88\" aria-hidden=\"true\"\u003e\u003c/a\u003e 主要なコードのポイント\u003c/h2\u003e\n\u003cp data-line=\"353\" class=\"code-line\"\u003eここからは、実装の詳細を解説します。\u003c/p\u003e\n\u003ch3 id=\"1.-%E3%82%B9%E3%82%AF%E3%83%AC%E3%82%A4%E3%83%94%E3%83%B3%E3%82%B0%E5%87%A6%E7%90%86%EF%BC%88suumo.py%EF%BC%89\" data-line=\"355\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#1.-%E3%82%B9%E3%82%AF%E3%83%AC%E3%82%A4%E3%83%94%E3%83%B3%E3%82%B0%E5%87%A6%E7%90%86%EF%BC%88suumo.py%EF%BC%89\" aria-hidden=\"true\"\u003e\u003c/a\u003e 1. スクレイピング処理（suumo.py）\u003c/h3\u003e\n\u003cp data-line=\"357\" class=\"code-line\"\u003e物件情報のスクレイピングを担当するモジュールです。\u003c/p\u003e\n\u003ch4 id=\"propertydata-%E3%83%87%E3%83%BC%E3%82%BF%E3%82%AF%E3%83%A9%E3%82%B9\" data-line=\"359\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#propertydata-%E3%83%87%E3%83%BC%E3%82%BF%E3%82%AF%E3%83%A9%E3%82%B9\" aria-hidden=\"true\"\u003e\u003c/a\u003e PropertyData データクラス\u003c/h4\u003e\n\u003cp data-line=\"361\" class=\"code-line\"\u003e\u003ccode\u003edataclass\u003c/code\u003eを使って、物件情報を型安全に管理しています。\u003c/p\u003e\n\u003cdiv class=\"code-block-container\"\u003e\u003cpre class=\"shiki github-dark\" style=\"background-color:#151e2c;color:#e1e4e8\"\u003e\u003ccode class=\"code-line\" data-line=\"363\"\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003efrom\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e dataclasses \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003eimport\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e dataclass, field\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003efrom\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e typing \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003eimport\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e Dict, Any, List\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#B392F0\"\u003e@dataclass\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003eclass\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003e PropertyData\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e    \"\"\"Data class for property information\"\"\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    url: \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003estr\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e \"\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    property_name: \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003estr\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e \"\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    rent_cost: \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003estr\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e \"\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    management_fee: \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003estr\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e \"\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    deposit: \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003estr\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e \"\"\u003c/span\u003e\u003cspan style=\"color:#a0aab5\"\u003e      # 敷金\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    key_money: \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003estr\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e \"\"\u003c/span\u003e\u003cspan style=\"color:#a0aab5\"\u003e    # 礼金\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    guarantee_money: \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003estr\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e \"\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    depreciation: \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003estr\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e \"\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    layout: \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003estr\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e \"\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    area: \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003estr\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e \"\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    direction: \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003estr\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e \"\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    building_type: \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003estr\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e \"\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    age: \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003estr\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e \"\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    access_info: List[\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003estr\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e] \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e field(\u003c/span\u003e\u003cspan style=\"color:#FFAB70\"\u003edefault_factory\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003elist\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    location: \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003estr\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e \"\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    features: \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003estr\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e \"\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    table_data: Dict[\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003estr\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003estr\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e] \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e field(\u003c/span\u003e\u003cspan style=\"color:#FFAB70\"\u003edefault_factory\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003edict\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e    def\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003e to_dict\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(self) -\u0026gt; Dict[\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003estr\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e, Any]:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e        \"\"\"Convert to dictionary for Excel export\"\"\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e        return\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e            'URL'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e: \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e.url,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e            '物件名'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e: \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e.property_name,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e            '賃料・初期費用'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e: \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e.rent_cost,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e            '管理費・共益費'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e: \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e.management_fee,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e            '敷金'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e: \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e.deposit,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e            '礼金'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e: \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e.key_money,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#a0aab5\"\u003e            # ... 以下省略\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e        }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp data-line=\"401\" class=\"code-line\"\u003e\u003ccode\u003edataclass\u003c/code\u003eを使うメリットは以下の通りです。\u003c/p\u003e\n\u003cul data-line=\"403\" class=\"code-line\"\u003e\n\u003cli data-line=\"403\" class=\"code-line\"\u003e\n\u003ccode\u003e__init__\u003c/code\u003e、\u003ccode\u003e__repr__\u003c/code\u003e、\u003ccode\u003e__eq__\u003c/code\u003eが自動生成される\u003c/li\u003e\n\u003cli data-line=\"404\" class=\"code-line\"\u003e型ヒントによりIDEの補完が効く\u003c/li\u003e\n\u003cli data-line=\"405\" class=\"code-line\"\u003eデフォルト値の設定が簡単\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"url%E6%A4%9C%E8%A8%BC\" data-line=\"407\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#url%E6%A4%9C%E8%A8%BC\" aria-hidden=\"true\"\u003e\u003c/a\u003e URL検証\u003c/h4\u003e\n\u003cp data-line=\"409\" class=\"code-line\"\u003eSUUMOのURLかどうかを正規表現でチェックしています。\u003c/p\u003e\n\u003cdiv class=\"code-block-container\"\u003e\u003cpre class=\"shiki github-dark\" style=\"background-color:#151e2c;color:#e1e4e8\"\u003e\u003ccode class=\"code-line\" data-line=\"411\"\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003eimport\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e re\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003eclass\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003e SuumoScraper\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#79B8FF\"\u003e    SUUMO_URL_PATTERN\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e re.compile(\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003er\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e^\u003c/span\u003e\u003cspan style=\"color:#DBEDFF\"\u003ehttps\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e?\u003c/span\u003e\u003cspan style=\"color:#DBEDFF\"\u003e://suumo\u003c/span\u003e\u003cspan style=\"color:#85E89D;font-weight:bold\"\u003e\\.\u003c/span\u003e\u003cspan style=\"color:#DBEDFF\"\u003ejp/\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e(?:\u003c/span\u003e\u003cspan style=\"color:#DBEDFF\"\u003echintai\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e|\u003c/span\u003e\u003cspan style=\"color:#DBEDFF\"\u003ejuhan\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#DBEDFF\"\u003e/\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#B392F0\"\u003e    @\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003estaticmethod\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e    def\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003e validate_url\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(url: \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003estr\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e) -\u0026gt; \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003ebool\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e        \"\"\"Validate if URL is a SUUMO property URL\"\"\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e        if\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e not\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e url:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e            return\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e False\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e        return\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e bool\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(SuumoScraper.\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eSUUMO_URL_PATTERN\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e.match(url))\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp data-line=\"425\" class=\"code-line\"\u003e\u003ccode\u003echintai\u003c/code\u003e（賃貸）と\u003ccode\u003ejuhan\u003c/code\u003e（中古住宅）の両方に対応しています。\u003c/p\u003e\n\u003ch4 id=\"html%E8%A7%A3%E6%9E%90%E3%81%AE%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88\" data-line=\"427\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#html%E8%A7%A3%E6%9E%90%E3%81%AE%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88\" aria-hidden=\"true\"\u003e\u003c/a\u003e HTML解析のポイント\u003c/h4\u003e\n\u003cp data-line=\"429\" class=\"code-line\"\u003eBeautifulSoup4を使ったHTML解析の実装例です。\u003c/p\u003e\n\u003cdiv class=\"code-block-container\"\u003e\u003cpre class=\"shiki github-dark\" style=\"background-color:#151e2c;color:#e1e4e8\"\u003e\u003ccode class=\"code-line\" data-line=\"431\"\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003efrom\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e bs4 \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003eimport\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e BeautifulSoup\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003eimport\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e requests\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003eclass\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003e SuumoScraper\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#79B8FF\"\u003e    DEFAULT_HEADERS\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e        'User-Agent'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e: \u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36'\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#79B8FF\"\u003e    REQUEST_TIMEOUT\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e 10\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e    def\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e __init__\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(self):\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#79B8FF\"\u003e        self\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e.session \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e requests.Session()\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#79B8FF\"\u003e        self\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e.session.headers.update(\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eDEFAULT_HEADERS\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e    def\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003e scrape_property\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(self, url: \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003estr\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e) -\u0026gt; Optional[PropertyData]:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e        \"\"\"Extract property information from a single URL\"\"\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e        if\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e not\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e self\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e.validate_url(url):\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e            return\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e None\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e        response \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e self\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e.session.get(url, \u003c/span\u003e\u003cspan style=\"color:#FFAB70\"\u003etimeout\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eREQUEST_TIMEOUT\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e        if\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e response.status_code \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e!=\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e 200\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e            return\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e None\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e        soup \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e BeautifulSoup(response.content, \u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'html.parser'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#a0aab5\"\u003e        # 各情報を抽出\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e        property_data \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e PropertyData(\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#FFAB70\"\u003e            url\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003eurl,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#FFAB70\"\u003e            property_name\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e._extract_property_name(soup),\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#FFAB70\"\u003e            rent_cost\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e._extract_rent_cost(soup),\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#a0aab5\"\u003e            # ... 以下省略\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e        )\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e        return\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e property_data\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp data-line=\"466\" class=\"code-line\"\u003e\u003cstrong\u003eポイント\u003c/strong\u003e:\u003c/p\u003e\n\u003cul data-line=\"468\" class=\"code-line\"\u003e\n\u003cli data-line=\"468\" class=\"code-line\"\u003e\n\u003ccode\u003erequests.Session()\u003c/code\u003eを使うことで、接続の再利用やCookieの維持が可能\u003c/li\u003e\n\u003cli data-line=\"469\" class=\"code-line\"\u003e\n\u003ccode\u003eUser-Agent\u003c/code\u003eを設定しないとブロックされる場合がある\u003c/li\u003e\n\u003cli data-line=\"470\" class=\"code-line\"\u003eタイムアウトを設定してハングアップを防止\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"%E6%83%85%E5%A0%B1%E6%8A%BD%E5%87%BA%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89\" data-line=\"472\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E6%83%85%E5%A0%B1%E6%8A%BD%E5%87%BA%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89\" aria-hidden=\"true\"\u003e\u003c/a\u003e 情報抽出メソッド\u003c/h4\u003e\n\u003cp data-line=\"474\" class=\"code-line\"\u003eSUUMOのHTML構造に合わせてCSSセレクタで情報を抽出します。\u003c/p\u003e\n\u003cdiv class=\"code-block-container\"\u003e\u003cpre class=\"shiki github-dark\" style=\"background-color:#151e2c;color:#e1e4e8\"\u003e\u003ccode class=\"code-line\" data-line=\"476\"\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003edef\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003e _extract_property_name\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(self, soup: BeautifulSoup) -\u0026gt; \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003estr\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e    \"\"\"Extract property name\"\"\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    tag \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e soup.find(\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'h1'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#FFAB70\"\u003eclass_\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'section_h1-header-title'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e    return\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e self\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e.clean_text(tag.text) \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003eif\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e tag \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003eelse\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e '物件名が見つかりません'\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003edef\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003e _extract_deposit_key_money\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(self, soup: BeautifulSoup) -\u0026gt; \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003etuple\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e    \"\"\"Extract deposit and key money separately\"\"\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    tag \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e soup.find(\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'div'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#FFAB70\"\u003eclass_\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'property_data-title'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#FFAB70\"\u003estring\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'敷金/礼金'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e    if\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e tag:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e        body_tag \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e tag.find_next(\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'div'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#FFAB70\"\u003eclass_\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'property_data-body'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e        if\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e body_tag:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e            text \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e self\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e.clean_text(body_tag.text)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#a0aab5\"\u003e            # \"敷金 / 礼金\" 形式をパース（例: \"- / 6.45万円\"）\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e            if\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e '/'\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e in\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e text:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e                parts \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e text.split(\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'/'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e                deposit \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e parts[\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e].strip() \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003eif\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e len\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(parts) \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e\u0026gt;\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e 0\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e else\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e '-'\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e                key_money \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e parts[\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e].strip() \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003eif\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e len\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(parts) \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e\u0026gt;\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e 1\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e else\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e '-'\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e                return\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e (deposit, key_money)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e    return\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e (\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'情報なし'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'情報なし'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp data-line=\"498\" class=\"code-line\"\u003e\u003ccode\u003efind_next()\u003c/code\u003eを使って、特定のラベル要素の次にある値要素を取得するパターンは、HTMLテーブルの解析でよく使います。\u003c/p\u003e\n\u003ch4 id=\"%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E6%B1%8E%E7%94%A8%E6%8A%BD%E5%87%BA\" data-line=\"500\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E6%B1%8E%E7%94%A8%E6%8A%BD%E5%87%BA\" aria-hidden=\"true\"\u003e\u003c/a\u003e テーブルデータの汎用抽出\u003c/h4\u003e\n\u003cp data-line=\"502\" class=\"code-line\"\u003eSUUMOの物件ページには複数のテーブルがあり、それらを汎用的に抽出するメソッドです。\u003c/p\u003e\n\u003cdiv class=\"code-block-container\"\u003e\u003cpre class=\"shiki github-dark\" style=\"background-color:#151e2c;color:#e1e4e8\"\u003e\u003ccode class=\"code-line\" data-line=\"504\"\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003edef\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003e _extract_table_data\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(self, soup: BeautifulSoup) -\u0026gt; Dict[\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003estr\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003estr\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e]:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e    \"\"\"Extract table data\"\"\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    extracted_data: Dict[\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003estr\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003estr\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e] \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e {}\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e    for\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e row \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003ein\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e soup.select(\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'tr'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e):\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e        headers \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e row.find_all(\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'th'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e        values \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e row.find_all(\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'td'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e        if\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e len\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(headers) \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e==\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e 2\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e and\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e len\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(values) \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e\u0026gt;=\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e 2\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#a0aab5\"\u003e            # 2列テーブルの場合\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e            key1 \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e headers[\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e].get_text(\u003c/span\u003e\u003cspan style=\"color:#FFAB70\"\u003estrip\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eTrue\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e            key2 \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e headers[\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e].get_text(\u003c/span\u003e\u003cspan style=\"color:#FFAB70\"\u003estrip\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eTrue\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e            value1 \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e values[\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e].get_text(\u003c/span\u003e\u003cspan style=\"color:#FFAB70\"\u003estrip\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eTrue\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e            value2 \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e values[\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e].get_text(\u003c/span\u003e\u003cspan style=\"color:#FFAB70\"\u003estrip\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eTrue\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e            extracted_data[key1] \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e value1\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e            extracted_data[key2] \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e value2\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e        elif\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e len\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(headers) \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e==\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e 1\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e and\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e len\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(values) \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e\u0026gt;=\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e 1\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#a0aab5\"\u003e            # 1列テーブルの場合\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e            key \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e headers[\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e].get_text(\u003c/span\u003e\u003cspan style=\"color:#FFAB70\"\u003estrip\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eTrue\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e            if\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e values[\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e].find(\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'li'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e):\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#a0aab5\"\u003e                # リスト形式の場合は結合\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e                value \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e ' '\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e.join(li.get_text(\u003c/span\u003e\u003cspan style=\"color:#FFAB70\"\u003estrip\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eTrue\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e) \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003efor\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e li \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003ein\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e values[\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e].find_all(\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'li'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e))\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e            else\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e                value \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e values[\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e].get_text(\u003c/span\u003e\u003cspan style=\"color:#FFAB70\"\u003estrip\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eTrue\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e            extracted_data[key] \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e value\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e    return\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e extracted_data\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp data-line=\"534\" class=\"code-line\"\u003eこのメソッドにより、テーブル形式で表示されている情報（損保、駐車場、仲介手数料など）を一括で取得できます。\u003c/p\u003e\n\u003ch3 id=\"2.-selenium%E8%AA%8D%E8%A8%BC%E3%83%A2%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%AB%EF%BC%88auth.py%EF%BC%89\" data-line=\"536\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#2.-selenium%E8%AA%8D%E8%A8%BC%E3%83%A2%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%AB%EF%BC%88auth.py%EF%BC%89\" aria-hidden=\"true\"\u003e\u003c/a\u003e 2. Selenium認証モジュール（auth.py）\u003c/h3\u003e\n\u003cp data-line=\"538\" class=\"code-line\"\u003eSUUMOへのログインとお気に入り物件の取得を担当します。\u003c/p\u003e\n\u003ch4 id=\"webdriver%E3%81%AE%E8%A8%AD%E5%AE%9A\" data-line=\"540\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#webdriver%E3%81%AE%E8%A8%AD%E5%AE%9A\" aria-hidden=\"true\"\u003e\u003c/a\u003e WebDriverの設定\u003c/h4\u003e\n\u003cdiv class=\"code-block-container\"\u003e\u003cpre class=\"shiki github-dark\" style=\"background-color:#151e2c;color:#e1e4e8\"\u003e\u003ccode class=\"code-line\" data-line=\"542\"\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003efrom\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e selenium \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003eimport\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e webdriver\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003efrom\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e selenium.webdriver.chrome.options \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003eimport\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e Options\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003efrom\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e selenium.webdriver.chrome.service \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003eimport\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e Service\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003efrom\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e webdriver_manager.chrome \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003eimport\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e ChromeDriverManager\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003eclass\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003e SuumoAuth\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e    def\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003e _create_driver\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(self) -\u0026gt; webdriver.Chrome:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e        \"\"\"Create WebDriver\"\"\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e        options \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e Options()\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e        if\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e self\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e.headless:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e            options.add_argument(\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e\"--headless=new\"\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e        options.add_argument(\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e\"--incognito\"\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e        options.add_argument(\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e\"--no-sandbox\"\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e        options.add_argument(\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e\"--disable-dev-shm-usage\"\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e        options.add_argument(\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e\"--disable-gpu\"\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e        options.add_argument(\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e\"--window-size=1920,1080\"\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e        options.add_argument(\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e            \"--user-agent=Mozilla/5.0 (Windows NT 10.0; Win64; x64) \"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e            \"AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e        )\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e        service \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e Service(ChromeDriverManager().install())\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e        return\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e webdriver.Chrome(\u003c/span\u003e\u003cspan style=\"color:#FFAB70\"\u003eservice\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003eservice, \u003c/span\u003e\u003cspan style=\"color:#FFAB70\"\u003eoptions\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003eoptions)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp data-line=\"570\" class=\"code-line\"\u003e\u003cstrong\u003e設定のポイント\u003c/strong\u003e:\u003c/p\u003e\n\u003cul data-line=\"572\" class=\"code-line\"\u003e\n\u003cli data-line=\"572\" class=\"code-line\"\u003e\n\u003ccode\u003e--headless=new\u003c/code\u003e: 新しいヘッドレスモード（Chrome 112以降）\u003c/li\u003e\n\u003cli data-line=\"573\" class=\"code-line\"\u003e\n\u003ccode\u003e--no-sandbox\u003c/code\u003e: Docker環境などで必要\u003c/li\u003e\n\u003cli data-line=\"574\" class=\"code-line\"\u003e\n\u003ccode\u003e--disable-dev-shm-usage\u003c/code\u003e: 共有メモリ問題の回避\u003c/li\u003e\n\u003cli data-line=\"575\" class=\"code-line\"\u003e\n\u003ccode\u003ewebdriver-manager\u003c/code\u003e: ChromeDriverのバージョン管理を自動化\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"%E3%83%AD%E3%82%B0%E3%82%A4%E3%83%B3%E5%87%A6%E7%90%86\" data-line=\"577\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E3%83%AD%E3%82%B0%E3%82%A4%E3%83%B3%E5%87%A6%E7%90%86\" aria-hidden=\"true\"\u003e\u003c/a\u003e ログイン処理\u003c/h4\u003e\n\u003cdiv class=\"code-block-container\"\u003e\u003cpre class=\"shiki github-dark\" style=\"background-color:#151e2c;color:#e1e4e8\"\u003e\u003ccode class=\"code-line\" data-line=\"579\"\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003efrom\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e selenium.webdriver.common.by \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003eimport\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e By\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003efrom\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e selenium.webdriver.common.keys \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003eimport\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e Keys\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003efrom\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e selenium.webdriver.support.ui \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003eimport\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e WebDriverWait\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003efrom\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e selenium.webdriver.support \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003eimport\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e expected_conditions \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003eas\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e EC\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003edef\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003e login\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(self, email: \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003estr\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e, password: \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003estr\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e) -\u0026gt; \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003ebool\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e    \"\"\"Login to SUUMO\"\"\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#79B8FF\"\u003e    self\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e.driver \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e self\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e._create_driver()\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#79B8FF\"\u003e    self\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e.driver.get(\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eLOGIN_URL\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#a0aab5\"\u003e    # メールアドレスを入力\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    email_input \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e WebDriverWait(\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e.driver, \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eELEMENT_TIMEOUT\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e).until(\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#79B8FF\"\u003e        EC\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e.presence_of_element_located((By.\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eID\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e\"mainEmail\"\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e))\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    )\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    email_input.clear()\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    email_input.send_keys(email)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#a0aab5\"\u003e    # パスワードを入力してログイン\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    password_input \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e WebDriverWait(\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e.driver, \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eELEMENT_TIMEOUT\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e).until(\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#79B8FF\"\u003e        EC\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e.presence_of_element_located((By.\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eID\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e\"passwordText\"\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e))\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    )\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    password_input.clear()\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    password_input.send_keys(password)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    password_input.send_keys(Keys.\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eRETURN\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e)  \u003c/span\u003e\u003cspan style=\"color:#a0aab5\"\u003e# Enterキーでログイン\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#a0aab5\"\u003e    # ログイン完了を待機\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    time.sleep(\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eself\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eLOGIN_WAIT_TIME\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#a0aab5\"\u003e    # ログイン成功の確認\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e    if\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e \"login\"\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e in\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e self\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e.driver.current_url.lower():\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#a0aab5\"\u003e        # まだログインページにいる場合はエラー\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e        error_elements \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e self\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e.driver.find_elements(By.\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eCLASS_NAME\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e\"error\"\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e        if\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e error_elements:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e            raise\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e SuumoAuthError(\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003ef\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e\"Login failed: \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003eerror_elements[\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e].text\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e\"\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e    return\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e True\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp data-line=\"618\" class=\"code-line\"\u003e\u003cstrong\u003eポイント\u003c/strong\u003e:\u003c/p\u003e\n\u003cul data-line=\"620\" class=\"code-line\"\u003e\n\u003cli data-line=\"620\" class=\"code-line\"\u003e\n\u003ccode\u003eWebDriverWait\u003c/code\u003eと\u003ccode\u003eexpected_conditions\u003c/code\u003eを使った明示的な待機\u003c/li\u003e\n\u003cli data-line=\"621\" class=\"code-line\"\u003e\n\u003ccode\u003etime.sleep()\u003c/code\u003eは避けたいところですが、ログイン処理後のリダイレクト待機には必要な場合がある\u003c/li\u003e\n\u003cli data-line=\"622\" class=\"code-line\"\u003eエラーハンドリングで失敗時の原因を明確に\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"context-manager%E5%AF%BE%E5%BF%9C\" data-line=\"624\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#context-manager%E5%AF%BE%E5%BF%9C\" aria-hidden=\"true\"\u003e\u003c/a\u003e Context Manager対応\u003c/h4\u003e\n\u003cp data-line=\"626\" class=\"code-line\"\u003e\u003ccode\u003ewith\u003c/code\u003e文で使えるようにすることで、リソースの確実な解放を保証します。\u003c/p\u003e\n\u003cdiv class=\"code-block-container\"\u003e\u003cpre class=\"shiki github-dark\" style=\"background-color:#151e2c;color:#e1e4e8\"\u003e\u003ccode class=\"code-line\" data-line=\"628\"\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003edef\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e __enter__\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(self):\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e    return\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e self\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003edef\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e __exit__\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(self, exc_type, exc_val, exc_tb):\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#79B8FF\"\u003e    self\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e.close()\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e    return\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e False\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003edef\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003e close\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(self):\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e    \"\"\"Close WebDriver\"\"\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e    if\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e self\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e.driver:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e        try\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#79B8FF\"\u003e            self\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e.driver.quit()\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e        finally\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#79B8FF\"\u003e            self\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e.driver \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e None\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp data-line=\"645\" class=\"code-line\"\u003e使用例:\u003c/p\u003e\n\u003cdiv class=\"code-block-container\"\u003e\u003cpre class=\"shiki github-dark\" style=\"background-color:#151e2c;color:#e1e4e8\"\u003e\u003ccode class=\"code-line\" data-line=\"647\"\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003ewith\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e SuumoAuth(\u003c/span\u003e\u003cspan style=\"color:#FFAB70\"\u003eheadless\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eTrue\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e) \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003eas\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e auth:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    auth.login(email, password)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    urls \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e auth.get_favorite_urls()\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#a0aab5\"\u003e# 自動的にWebDriverが閉じられる\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"3.-%E3%82%A8%E3%82%AF%E3%82%B9%E3%83%9D%E3%83%BC%E3%83%88%E5%87%A6%E7%90%86%EF%BC%88exporter.py%EF%BC%89\" data-line=\"654\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#3.-%E3%82%A8%E3%82%AF%E3%82%B9%E3%83%9D%E3%83%BC%E3%83%88%E5%87%A6%E7%90%86%EF%BC%88exporter.py%EF%BC%89\" aria-hidden=\"true\"\u003e\u003c/a\u003e 3. エクスポート処理（exporter.py）\u003c/h3\u003e\n\u003cp data-line=\"656\" class=\"code-line\"\u003epandas を使ったデータ出力の実装です。\u003c/p\u003e\n\u003cdiv class=\"code-block-container\"\u003e\u003cpre class=\"shiki github-dark\" style=\"background-color:#151e2c;color:#e1e4e8\"\u003e\u003ccode class=\"code-line\" data-line=\"658\"\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003eimport\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e io\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003eimport\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e json\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003efrom\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e enum \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003eimport\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e Enum\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003eimport\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e pandas \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003eas\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e pd\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003eclass\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003e ExportFormat\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003eEnum\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e):\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e    \"\"\"Export format enum\"\"\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#79B8FF\"\u003e    EXCEL\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e \"excel\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#79B8FF\"\u003e    CSV\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e \"csv\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#79B8FF\"\u003e    JSON\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e \"json\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003eclass\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003e DataExporter\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#B392F0\"\u003e    @\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003estaticmethod\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e    def\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003e export_to_excel\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(data: List[Dict[\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003estr\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e, Any]]) -\u0026gt; io.BytesIO:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e        \"\"\"Export data to Excel format\"\"\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e        df \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e pd.DataFrame(data)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e        output \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e io.BytesIO()\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e        with\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e pd.ExcelWriter(output, \u003c/span\u003e\u003cspan style=\"color:#FFAB70\"\u003eengine\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'openpyxl'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e) \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003eas\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e writer:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e            df.to_excel(writer, \u003c/span\u003e\u003cspan style=\"color:#FFAB70\"\u003eindex\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#FFAB70\"\u003esheet_name\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'Property Data'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e        output.seek(\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e        return\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e output\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#B392F0\"\u003e    @\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003estaticmethod\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e    def\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003e export_to_csv\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(data: List[Dict[\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003estr\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e, Any]], encoding: \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003estr\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e 'utf-8-sig'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e) -\u0026gt; io.BytesIO:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e        \"\"\"Export data to CSV format\"\"\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e        df \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e pd.DataFrame(data)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e        output \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e io.BytesIO()\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e        df.to_csv(output, \u003c/span\u003e\u003cspan style=\"color:#FFAB70\"\u003eindex\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#FFAB70\"\u003eencoding\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003eencoding)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e        output.seek(\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e        return\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e output\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#B392F0\"\u003e    @\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003estaticmethod\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e    def\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003e export_to_json\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(data: List[Dict[\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003estr\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e, Any]], indent: \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eint\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e 2\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e) -\u0026gt; io.BytesIO:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e        \"\"\"Export data to JSON format\"\"\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e        output \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e io.BytesIO()\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e        json_str \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e json.dumps(data, \u003c/span\u003e\u003cspan style=\"color:#FFAB70\"\u003eensure_ascii\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#FFAB70\"\u003eindent\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003eindent)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e        output.write(json_str.encode(\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'utf-8'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e))\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e        output.seek(\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e        return\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e output\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp data-line=\"700\" class=\"code-line\"\u003e\u003cstrong\u003eポイント\u003c/strong\u003e:\u003c/p\u003e\n\u003cul data-line=\"702\" class=\"code-line\"\u003e\n\u003cli data-line=\"702\" class=\"code-line\"\u003e\n\u003ccode\u003eio.BytesIO\u003c/code\u003eを使うことで、一時ファイルを作成せずにメモリ上でファイルを生成\u003c/li\u003e\n\u003cli data-line=\"703\" class=\"code-line\"\u003eCSVは\u003ccode\u003eutf-8-sig\u003c/code\u003e（BOM付きUTF-8）でExcelでの文字化けを防止\u003c/li\u003e\n\u003cli data-line=\"704\" class=\"code-line\"\u003eJSONは\u003ccode\u003eensure_ascii=False\u003c/code\u003eで日本語をそのまま出力\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"4.-server-sent-events%EF%BC%88sse%EF%BC%89%E3%81%AB%E3%82%88%E3%82%8B%E9%80%B2%E6%8D%97%E8%A1%A8%E7%A4%BA\" data-line=\"706\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#4.-server-sent-events%EF%BC%88sse%EF%BC%89%E3%81%AB%E3%82%88%E3%82%8B%E9%80%B2%E6%8D%97%E8%A1%A8%E7%A4%BA\" aria-hidden=\"true\"\u003e\u003c/a\u003e 4. Server-Sent Events（SSE）による進捗表示\u003c/h3\u003e\n\u003cp data-line=\"708\" class=\"code-line\"\u003eリアルタイム進捗表示の実装です。WebSocketよりも実装がシンプルで、一方向の通知に適しています。\u003c/p\u003e\n\u003ch4 id=\"%E3%83%90%E3%83%83%E3%82%AF%E3%82%A8%E3%83%B3%E3%83%89%E5%AE%9F%E8%A3%85%EF%BC%88routes.py%EF%BC%89\" data-line=\"710\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E3%83%90%E3%83%83%E3%82%AF%E3%82%A8%E3%83%B3%E3%83%89%E5%AE%9F%E8%A3%85%EF%BC%88routes.py%EF%BC%89\" aria-hidden=\"true\"\u003e\u003c/a\u003e バックエンド実装（routes.py）\u003c/h4\u003e\n\u003cdiv class=\"code-block-container\"\u003e\u003cpre class=\"shiki github-dark\" style=\"background-color:#151e2c;color:#e1e4e8\"\u003e\u003ccode class=\"code-line\" data-line=\"712\"\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003efrom\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e concurrent.futures \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003eimport\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e ThreadPoolExecutor\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003efrom\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e flask \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003eimport\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e Response, jsonify\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003eimport\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e threading\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003eimport\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e json\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#a0aab5\"\u003e# タスク管理\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003etasks: Dict[\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003estr\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e, Dict[\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003estr\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e, Any]] \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e {}\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003etasks_lock \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e threading.Lock()\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003eexecutor \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e ThreadPoolExecutor(\u003c/span\u003e\u003cspan style=\"color:#FFAB70\"\u003emax_workers\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e4\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#B392F0\"\u003e@api_bp.route\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'/scrape'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#FFAB70\"\u003emethods\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'POST'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e])\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003edef\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003e start_scrape\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e():\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e    \"\"\"Start scraping\"\"\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#a0aab5\"\u003e    # ... URL検証等の処理 ...\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#a0aab5\"\u003e    # タスクIDを生成\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    task_id \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e str\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(uuid.uuid4())\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#a0aab5\"\u003e    # タスク情報を初期化\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    tasks[task_id] \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e        'status'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e: \u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'pending'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e        'urls'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e: urls,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e        'progress'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e: \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e        'total'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e: \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003elen\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(urls),\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e        'current_url'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e: \u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e''\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e        'results'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e: [],\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e        'errors'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e: [],\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#a0aab5\"\u003e    # バックグラウンドでスクレイピング実行\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    executor.submit(run_scraping_task, task_id)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e    return\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e jsonify({\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'task_id'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e: task_id, \u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'total'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e: \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003elen\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(urls)})\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#B392F0\"\u003e@api_bp.route\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'/scrape/stream/\u0026lt;task_id\u0026gt;'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003edef\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003e scrape_stream\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(task_id: \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003estr\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e):\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e    \"\"\"Server-Sent Events for scraping progress\"\"\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e    if\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e task_id \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003enot\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e in\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e tasks:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e        return\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e jsonify({\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'error'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e: \u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'Task not found'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e}), \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e404\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e    def\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003e generate\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e() -\u0026gt; Generator[\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003estr\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eNone\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eNone\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e]:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e        last_progress \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e -\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e1\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e        while\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e True\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e            task \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e tasks.get(task_id)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e            if\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e not\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e task:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e                yield\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e format_sse({\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'type'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e: \u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'error'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'message'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e: \u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'Task not found'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e})\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e                break\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#a0aab5\"\u003e            # 進捗が更新されたら送信\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e            if\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e task[\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'progress'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e] \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e!=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e last_progress \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003eor\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e task[\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'status'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e] \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003ein\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e [\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'completed'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'error'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e]:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e                last_progress \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e task[\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'progress'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e]\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e                data \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e                    'type'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e: \u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'progress'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e                    'status'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e: task[\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'status'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e],\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e                    'progress'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e: task[\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'progress'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e],\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e                    'total'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e: task[\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'total'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e],\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e                    'current_url'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e: task[\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'current_url'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e],\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e                    'errors'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e: task[\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'errors'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e]\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e                }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e                yield\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e format_sse(data)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e                if\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e task[\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'status'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e] \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003ein\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e [\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'completed'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'error'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e]:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e                    break\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e            time.sleep(\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e0.5\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e    return\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e Response(\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e        generate(),\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#FFAB70\"\u003e        mimetype\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'text/event-stream'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#FFAB70\"\u003e        headers\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e            'Cache-Control'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e: \u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'no-cache'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e            'Connection'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e: \u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'keep-alive'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e            'X-Accel-Buffering'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e: \u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'no'\u003c/span\u003e\u003cspan style=\"color:#a0aab5\"\u003e  # Nginx用\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e        }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    )\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003edef\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003e format_sse\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(data: Dict[\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003estr\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e, Any]) -\u0026gt; \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003estr\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e    \"\"\"Format data for SSE\"\"\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e    return\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e f\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e\"data: \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003ejson.dumps(data, \u003c/span\u003e\u003cspan style=\"color:#FFAB70\"\u003eensure_ascii\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eFalse\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e}\\n\\n\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp data-line=\"799\" class=\"code-line\"\u003e\u003cstrong\u003eSSEのポイント\u003c/strong\u003e:\u003c/p\u003e\n\u003cul data-line=\"801\" class=\"code-line\"\u003e\n\u003cli data-line=\"801\" class=\"code-line\"\u003e\n\u003ccode\u003eContent-Type: text/event-stream\u003c/code\u003eで接続を維持\u003c/li\u003e\n\u003cli data-line=\"802\" class=\"code-line\"\u003eデータは\u003ccode\u003edata: \u003c/code\u003eプレフィックスと\u003ccode\u003e\\n\\n\u003c/code\u003e（2つの改行）で区切る\u003c/li\u003e\n\u003cli data-line=\"803\" class=\"code-line\"\u003e\n\u003ccode\u003eX-Accel-Buffering: no\u003c/code\u003eでNginxのバッファリングを無効化\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"%E3%83%95%E3%83%AD%E3%83%B3%E3%83%88%E3%82%A8%E3%83%B3%E3%83%89%E5%AE%9F%E8%A3%85\" data-line=\"805\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E3%83%95%E3%83%AD%E3%83%B3%E3%83%88%E3%82%A8%E3%83%B3%E3%83%89%E5%AE%9F%E8%A3%85\" aria-hidden=\"true\"\u003e\u003c/a\u003e フロントエンド実装\u003c/h4\u003e\n\u003cdiv class=\"code-block-container\"\u003e\u003cpre class=\"shiki github-dark\" style=\"background-color:#151e2c;color:#e1e4e8\"\u003e\u003ccode class=\"code-line\" data-line=\"807\"\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003econst\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e eventSource\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e new\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003e EventSource\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e`/api/scrape/stream/${\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003etaskId\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e}`\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003eeventSource.\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003eonmessage\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e function\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#FFAB70\"\u003eevent\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e    const\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e data\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e JSON\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003eparse\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(event.data);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e    if\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e (data.type \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e===\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e 'progress'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#a0aab5\"\u003e        // プログレスバーを更新\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e        const\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e percentage\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e (data.progress \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e/\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e data.total) \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e 100\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e        progressBar.style.width \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e `${\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003epercentage\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e}%`\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e        progressBar.textContent \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e `${\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003edata\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003eprogress\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e}/${\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003edata\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003etotal\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e}`\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#a0aab5\"\u003e        // 現在処理中のURLを表示\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e        currentUrlText.textContent \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e data.current_url;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e        if\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e (data.status \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e===\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e 'completed'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e            eventSource.\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003eclose\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#a0aab5\"\u003e            // ダウンロードボタンを有効化\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e        }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e};\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003eeventSource.\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003eonerror\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e function\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#FFAB70\"\u003eerror\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    eventSource.\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003eclose\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#a0aab5\"\u003e    // エラー処理\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e};\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"5.-%E3%82%B9%E3%82%AF%E3%83%AC%E3%82%A4%E3%83%94%E3%83%B3%E3%82%B0%E3%82%BF%E3%82%B9%E3%82%AF%E3%81%AE%E4%B8%A6%E5%88%97%E5%AE%9F%E8%A1%8C\" data-line=\"835\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#5.-%E3%82%B9%E3%82%AF%E3%83%AC%E3%82%A4%E3%83%94%E3%83%B3%E3%82%B0%E3%82%BF%E3%82%B9%E3%82%AF%E3%81%AE%E4%B8%A6%E5%88%97%E5%AE%9F%E8%A1%8C\" aria-hidden=\"true\"\u003e\u003c/a\u003e 5. スクレイピングタスクの並列実行\u003c/h3\u003e\n\u003cdiv class=\"code-block-container\"\u003e\u003cpre class=\"shiki github-dark\" style=\"background-color:#151e2c;color:#e1e4e8\"\u003e\u003ccode class=\"code-line\" data-line=\"837\"\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003efrom\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e concurrent.futures \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003eimport\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e ThreadPoolExecutor\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003eexecutor \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e ThreadPoolExecutor(\u003c/span\u003e\u003cspan style=\"color:#FFAB70\"\u003emax_workers\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e4\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003edef\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003e run_scraping_task\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(task_id: \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003estr\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e) -\u0026gt; \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eNone\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e    \"\"\"Run scraping in background\"\"\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    task \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e tasks.get(task_id)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e    if\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e not\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e task:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e        return\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    task[\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'status'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e] \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e 'running'\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    scraper \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e SuumoScraper()\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e    for\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e i, url \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003ein\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e enumerate\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(task[\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'urls'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e]):\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e        task[\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'current_url'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e] \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e url\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e        task[\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'progress'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e] \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e i\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e        try\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e            result \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e scraper.scrape_property(url)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e            if\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e result:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e                task[\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'results'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e].append(result)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e            else\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e                task[\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'errors'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e].append({\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e                    'url'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e: url,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e                    'error'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e: \u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'Could not get property info'\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e                })\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e        except\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e SuumoScraperError \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003eas\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e e:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e            task[\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'errors'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e].append({\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e                'url'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e: url,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e                'error'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e: \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003estr\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e            })\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#a0aab5\"\u003e        # 最後のURL以外は待機（スクレイピングマナー）\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e        if\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e i \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e len\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(task[\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'urls'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e]) \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e 1\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e            time.sleep(task[\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'delay'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e])\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    task[\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'status'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e] \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e 'completed'\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    task[\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'progress'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e] \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e len\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(task[\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'urls'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e])\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp data-line=\"878\" class=\"code-line\"\u003e\u003cstrong\u003eポイント\u003c/strong\u003e:\u003c/p\u003e\n\u003cul data-line=\"880\" class=\"code-line\"\u003e\n\u003cli data-line=\"880\" class=\"code-line\"\u003e\n\u003ccode\u003eThreadPoolExecutor\u003c/code\u003eで複数タスクを並列管理\u003c/li\u003e\n\u003cli data-line=\"881\" class=\"code-line\"\u003e各URL処理間に2秒のディレイを設けてサーバー負荷を軽減\u003c/li\u003e\n\u003cli data-line=\"882\" class=\"code-line\"\u003eエラーが発生しても処理を継続し、最終的にまとめてレポート\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"%E5%AE%9F%E8%A3%85%E3%81%A7%E5%B7%A5%E5%A4%AB%E3%81%97%E3%81%9F%E7%82%B9%E3%83%BB%E6%B3%A8%E6%84%8F%E7%82%B9\" data-line=\"884\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E5%AE%9F%E8%A3%85%E3%81%A7%E5%B7%A5%E5%A4%AB%E3%81%97%E3%81%9F%E7%82%B9%E3%83%BB%E6%B3%A8%E6%84%8F%E7%82%B9\" aria-hidden=\"true\"\u003e\u003c/a\u003e 実装で工夫した点・注意点\u003c/h2\u003e\n\u003ch3 id=\"%E3%82%B9%E3%82%AF%E3%83%AC%E3%82%A4%E3%83%94%E3%83%B3%E3%82%B0%E3%83%9E%E3%83%8A%E3%83%BC\" data-line=\"886\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E3%82%B9%E3%82%AF%E3%83%AC%E3%82%A4%E3%83%94%E3%83%B3%E3%82%B0%E3%83%9E%E3%83%8A%E3%83%BC\" aria-hidden=\"true\"\u003e\u003c/a\u003e スクレイピングマナー\u003c/h3\u003e\n\u003cul data-line=\"888\" class=\"code-line\"\u003e\n\u003cli data-line=\"888\" class=\"code-line\"\u003e各URL処理間に2秒の待機時間を設定（設定で1〜10秒に変更可能）\u003c/li\u003e\n\u003cli data-line=\"889\" class=\"code-line\"\u003e同時リクエスト数を制限\u003c/li\u003e\n\u003cli data-line=\"890\" class=\"code-line\"\u003e適切なUser-Agentを設定\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"code-block-container\"\u003e\u003cpre class=\"shiki github-dark\" style=\"background-color:#151e2c;color:#e1e4e8\"\u003e\u003ccode class=\"code-line\" data-line=\"892\"\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#a0aab5\"\u003e# routes.py\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#79B8FF\"\u003eMIN_DELAY\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e 1\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#79B8FF\"\u003eMAX_DELAY\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e 10\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#a0aab5\"\u003e# 待機時間のバリデーション\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003etry\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    delay \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e int\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(delay)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e    if\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e delay \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e MIN_DELAY\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e or\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e delay \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e\u0026gt;\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e MAX_DELAY\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e        return\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e jsonify({\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e            'error'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e: \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003ef\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'Delay must be between \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e{MIN_DELAY}\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e and \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e{MAX_DELAY}\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e seconds'\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e        }), \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e400\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003eexcept\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e (\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eTypeError\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eValueError\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e):\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    delay \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e 2\u003c/span\u003e\u003cspan style=\"color:#a0aab5\"\u003e  # デフォルト値\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"%E3%82%A8%E3%83%A9%E3%83%BC%E3%83%8F%E3%83%B3%E3%83%89%E3%83%AA%E3%83%B3%E3%82%B0\" data-line=\"908\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E3%82%A8%E3%83%A9%E3%83%BC%E3%83%8F%E3%83%B3%E3%83%89%E3%83%AA%E3%83%B3%E3%82%B0\" aria-hidden=\"true\"\u003e\u003c/a\u003e エラーハンドリング\u003c/h3\u003e\n\u003cp data-line=\"910\" class=\"code-line\"\u003eカスタム例外を定義して、エラーの種類を明確にしています。\u003c/p\u003e\n\u003cdiv class=\"code-block-container\"\u003e\u003cpre class=\"shiki github-dark\" style=\"background-color:#151e2c;color:#e1e4e8\"\u003e\u003ccode class=\"code-line\" data-line=\"912\"\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003eclass\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003e SuumoScraperError\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eException\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e):\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e    \"\"\"Custom exception for scraping errors\"\"\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e    pass\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003eclass\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003e SuumoAuthError\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eException\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e):\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e    \"\"\"Custom exception for authentication errors\"\"\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e    pass\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003eclass\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003e ExportError\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eException\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e):\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e    \"\"\"Custom exception for export errors\"\"\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e    pass\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp data-line=\"926\" class=\"code-line\"\u003eこれにより、APIレスポンスで適切なHTTPステータスコードを返せます。\u003c/p\u003e\n\u003cdiv class=\"code-block-container\"\u003e\u003cpre class=\"shiki github-dark\" style=\"background-color:#151e2c;color:#e1e4e8\"\u003e\u003ccode class=\"code-line\" data-line=\"928\"\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003etry\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    urls \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e get_favorites_with_login(email, password, \u003c/span\u003e\u003cspan style=\"color:#FFAB70\"\u003eheadless\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eTrue\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e    return\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e jsonify({\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'urls'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e: urls, \u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'count'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e: \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003elen\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(urls)})\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003eexcept\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e SuumoAuthError \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003eas\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e e:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e    return\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e jsonify({\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'error'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e: \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003estr\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(e)}), \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e401\u003c/span\u003e\u003cspan style=\"color:#a0aab5\"\u003e  # 認証エラー\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003eexcept\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e Exception\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e as\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e e:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e    return\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e jsonify({\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'error'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e: \u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'Failed to get favorites'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e}), \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e500\u003c/span\u003e\u003cspan style=\"color:#a0aab5\"\u003e  # サーバーエラー\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"%E3%82%BF%E3%82%B9%E3%82%AF%E3%81%AE%E6%9C%89%E5%8A%B9%E6%9C%9F%E9%99%90%E7%AE%A1%E7%90%86\" data-line=\"938\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E3%82%BF%E3%82%B9%E3%82%AF%E3%81%AE%E6%9C%89%E5%8A%B9%E6%9C%9F%E9%99%90%E7%AE%A1%E7%90%86\" aria-hidden=\"true\"\u003e\u003c/a\u003e タスクの有効期限管理\u003c/h3\u003e\n\u003cp data-line=\"940\" class=\"code-line\"\u003e長時間放置されたタスクを自動削除してメモリリークを防止します。\u003c/p\u003e\n\u003cdiv class=\"code-block-container\"\u003e\u003cpre class=\"shiki github-dark\" style=\"background-color:#151e2c;color:#e1e4e8\"\u003e\u003ccode class=\"code-line\" data-line=\"942\"\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003efrom\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e datetime \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003eimport\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e datetime, timedelta\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#79B8FF\"\u003eTASK_EXPIRY_HOURS\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e 1\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003edef\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003e cleanup_old_tasks\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e():\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e    \"\"\"Remove tasks older than TASK_EXPIRY_HOURS\"\"\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    expiry_time \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e datetime.now() \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e timedelta(\u003c/span\u003e\u003cspan style=\"color:#FFAB70\"\u003ehours\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eTASK_EXPIRY_HOURS\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e    with\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e tasks_lock:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e        expired \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e [\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e            task_id \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003efor\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e task_id, task \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003ein\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e tasks.items()\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e            if\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e task.get(\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'completed_at'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e) \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003eand\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e            datetime.fromisoformat(task[\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e'completed_at'\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e]) \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e expiry_time\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e        ]\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e        for\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e task_id \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003ein\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e expired:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#F97583\"\u003e            del\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e tasks[task_id]\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"%E3%81%BE%E3%81%A8%E3%82%81\" data-line=\"960\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E3%81%BE%E3%81%A8%E3%82%81\" aria-hidden=\"true\"\u003e\u003c/a\u003e まとめ\u003c/h2\u003e\n\u003cp data-line=\"962\" class=\"code-line\"\u003eこのツールを通じて、以下の技術を実践的に学べます。\u003c/p\u003e\n\u003cul data-line=\"964\" class=\"code-line\"\u003e\n\u003cli data-line=\"964\" class=\"code-line\"\u003e\n\u003cstrong\u003eBeautifulSoup4\u003c/strong\u003e によるHTML解析とCSSセレクタの活用\u003c/li\u003e\n\u003cli data-line=\"965\" class=\"code-line\"\u003e\n\u003cstrong\u003eSelenium\u003c/strong\u003e を使ったブラウザ自動化とログイン処理\u003c/li\u003e\n\u003cli data-line=\"966\" class=\"code-line\"\u003e\n\u003cstrong\u003eFlask\u003c/strong\u003e でのAPIエンドポイント設計\u003c/li\u003e\n\u003cli data-line=\"967\" class=\"code-line\"\u003e\n\u003cstrong\u003eServer-Sent Events\u003c/strong\u003e によるリアルタイム通信\u003c/li\u003e\n\u003cli data-line=\"968\" class=\"code-line\"\u003e\n\u003cstrong\u003eThreadPoolExecutor\u003c/strong\u003e を使った並列処理\u003c/li\u003e\n\u003cli data-line=\"969\" class=\"code-line\"\u003e\n\u003cstrong\u003epandas\u003c/strong\u003e によるデータ出力\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp data-line=\"971\" class=\"code-line\"\u003e実際に動くコードを読みながら、ぜひ自分のプロジェクトにも応用してみてください。\u003c/p\u003e\n\u003cp data-line=\"973\" class=\"code-line\"\u003e\u003cstrong\u003eリポジトリ\u003c/strong\u003e: \u003ca href=\"https://github.com/yamato-snow/2025-12-07_sumo-scraping\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003ehttps://github.com/yamato-snow/2025-12-07_sumo-scraping\u003c/a\u003e\u003c/p\u003e\n\u003ch3 id=\"%E9%87%8D%E8%A6%81%E3%81%AA%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A0%85\" data-line=\"975\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E9%87%8D%E8%A6%81%E3%81%AA%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A0%85\" aria-hidden=\"true\"\u003e\u003c/a\u003e 重要な注意事項\u003c/h3\u003e\n\u003caside class=\"msg alert\"\u003e\u003cspan class=\"msg-symbol\"\u003e!\u003c/span\u003e\u003cdiv class=\"msg-content\"\u003e\n\u003cp data-line=\"978\" class=\"code-line\"\u003e\u003cstrong\u003e法的リスクについて\u003c/strong\u003e\u003c/p\u003e\n\u003cp data-line=\"980\" class=\"code-line\"\u003eスクレイピングは、やり方によっては法律に抵触する可能性があります。本ツールを使用する前に、必ず「スクレイピングを始める前に知っておくべきこと」セクションを熟読してください。\u003c/p\u003e\n\u003cul data-line=\"982\" class=\"code-line\"\u003e\n\u003cli data-line=\"982\" class=\"code-line\"\u003e\n\u003cstrong\u003e不正アクセス禁止法\u003c/strong\u003e: アクセス制限の回避は違法です\u003c/li\u003e\n\u003cli data-line=\"983\" class=\"code-line\"\u003e\n\u003cstrong\u003e著作権法\u003c/strong\u003e: 取得データの再配布・商用利用は著作権侵害です\u003c/li\u003e\n\u003cli data-line=\"984\" class=\"code-line\"\u003e\n\u003cstrong\u003e業務妨害罪\u003c/strong\u003e: サーバーへの過度な負荷は犯罪になり得ます\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\u003c/aside\u003e\n\u003cp data-line=\"987\" class=\"code-line\"\u003e\u003cstrong\u003e利用上の注意\u003c/strong\u003e:\u003c/p\u003e\n\u003cul data-line=\"989\" class=\"code-line\"\u003e\n\u003cli data-line=\"989\" class=\"code-line\"\u003e\n\u003cstrong\u003e利用規約の遵守\u003c/strong\u003e: SUUMOの利用規約を必ず確認し、遵守してください\u003c/li\u003e\n\u003cli data-line=\"990\" class=\"code-line\"\u003e\n\u003cstrong\u003erobots.txt の確認\u003c/strong\u003e: \u003ccode\u003ehttps://suumo.jp/robots.txt\u003c/code\u003e を確認してください\u003c/li\u003e\n\u003cli data-line=\"991\" class=\"code-line\"\u003e\n\u003cstrong\u003eスクレイピングマナー\u003c/strong\u003e: 各リクエスト間に最低2秒以上の間隔を空けてください\u003c/li\u003e\n\u003cli data-line=\"992\" class=\"code-line\"\u003e\n\u003cstrong\u003eHTML構造変更\u003c/strong\u003e: SUUMOのHTML構造が変更された場合、セレクタの更新が必要になる可能性があります\u003c/li\u003e\n\u003cli data-line=\"993\" class=\"code-line\"\u003e\n\u003cstrong\u003e利用目的\u003c/strong\u003e: 本ツールは個人的な物件比較・学習目的での使用を想定しています\u003c/li\u003e\n\u003cli data-line=\"994\" class=\"code-line\"\u003e\n\u003cstrong\u003e自己責任\u003c/strong\u003e: 本ツールの使用によって生じたいかなる損害についても、作者は責任を負いません\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp data-line=\"996\" class=\"code-line\"\u003e\u003cstrong\u003eこのツールを使用してはいけない場合\u003c/strong\u003e:\u003c/p\u003e\n\u003cul data-line=\"998\" class=\"code-line\"\u003e\n\u003cli data-line=\"998\" class=\"code-line\"\u003e商用目的でのデータ収集\u003c/li\u003e\n\u003cli data-line=\"999\" class=\"code-line\"\u003e大量のデータを網羅的に収集する目的\u003c/li\u003e\n\u003cli data-line=\"1000\" class=\"code-line\"\u003e取得したデータを第三者に提供・販売する目的\u003c/li\u003e\n\u003cli data-line=\"1001\" class=\"code-line\"\u003eSUUMOの利用規約に違反する行為\u003c/li\u003e\n\u003c/ul\u003e\n","toc":[{"id":"%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB","text":"はじめに","level":2,"children":[]},{"id":"%E3%81%AA%E3%81%9C%E3%81%93%E3%81%AE%E3%83%84%E3%83%BC%E3%83%AB%E3%82%92%E4%BD%9C%E3%81%A3%E3%81%9F%E3%81%AE%E3%81%8B%EF%BC%9F","text":"なぜこのツールを作ったのか？","level":2,"children":[]},{"id":"%E3%81%93%E3%81%AE%E3%83%84%E3%83%BC%E3%83%AB%E3%81%A7%E3%81%A7%E3%81%8D%E3%82%8B%E3%81%93%E3%81%A8","text":"このツールでできること","level":2,"children":[{"id":"%E4%B8%BB%E3%81%AA%E6%A9%9F%E8%83%BD","text":"主な機能","level":3,"children":[]},{"id":"%E5%8F%96%E5%BE%97%E3%81%A7%E3%81%8D%E3%82%8B%E6%83%85%E5%A0%B1%EF%BC%88%E5%85%A831%E9%A0%85%E7%9B%AE%EF%BC%89","text":"取得できる情報（全31項目）","level":3,"children":[]}]},{"id":"%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%A6%E3%81%84%E3%82%8B%E6%8A%80%E8%A1%93%E3%82%B9%E3%82%BF%E3%83%83%E3%82%AF%E3%81%AF%EF%BC%9F","text":"使用している技術スタックは？","level":2,"children":[{"id":"%E3%81%AA%E3%81%9C%E3%81%93%E3%81%AE%E7%B5%84%E3%81%BF%E5%90%88%E3%82%8F%E3%81%9B%E3%82%92%E9%81%B8%E3%82%93%E3%81%A0%E3%81%AE%E3%81%8B%EF%BC%9F","text":"なぜこの組み合わせを選んだのか？","level":3,"children":[]}]},{"id":"%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E6%A7%8B%E6%88%90","text":"プロジェクト構成","level":2,"children":[]},{"id":"%E3%82%BB%E3%83%83%E3%83%88%E3%82%A2%E3%83%83%E3%83%97%E6%96%B9%E6%B3%95","text":"セットアップ方法","level":2,"children":[{"id":"%E5%89%8D%E6%8F%90%E6%9D%A1%E4%BB%B6","text":"前提条件","level":3,"children":[]},{"id":"%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB%E6%89%8B%E9%A0%86","text":"インストール手順","level":3,"children":[]},{"id":"%E4%BE%9D%E5%AD%98%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8","text":"依存パッケージ","level":3,"children":[]}]},{"id":"%E4%BD%BF%E3%81%84%E6%96%B9","text":"使い方","level":2,"children":[{"id":"%E6%96%B9%E6%B3%951%3A-url%E6%89%8B%E5%8B%95%E5%85%A5%E5%8A%9B%E3%83%A2%E3%83%BC%E3%83%89","text":"方法1: URL手動入力モード","level":3,"children":[]},{"id":"%E6%96%B9%E6%B3%952%3A-%E3%81%8A%E6%B0%97%E3%81%AB%E5%85%A5%E3%82%8A%E5%8F%96%E5%BE%97%E3%83%A2%E3%83%BC%E3%83%89","text":"方法2: お気に入り取得モード","level":3,"children":[]}]},{"id":"%E3%82%B9%E3%82%AF%E3%83%AC%E3%82%A4%E3%83%94%E3%83%B3%E3%82%B0%E3%82%92%E5%A7%8B%E3%82%81%E3%82%8B%E5%89%8D%E3%81%AB%E7%9F%A5%E3%81%A3%E3%81%A6%E3%81%8A%E3%81%8F%E3%81%B9%E3%81%8D%E3%81%93%E3%81%A8","text":"スクレイピングを始める前に知っておくべきこと","level":2,"children":[{"id":"1.-%E6%B3%95%E7%9A%84%E3%83%AA%E3%82%B9%E3%82%AF%E3%82%92%E7%90%86%E8%A7%A3%E3%81%99%E3%82%8B","text":"1. 法的リスクを理解する","level":3,"children":[]},{"id":"2.-%E4%BA%8B%E5%89%8D%E3%81%AB%E7%A2%BA%E8%AA%8D%E3%81%99%E3%81%B9%E3%81%8D%E3%81%93%E3%81%A8","text":"2. 事前に確認すべきこと","level":3,"children":[]},{"id":"3.-%E3%82%B9%E3%82%AF%E3%83%AC%E3%82%A4%E3%83%94%E3%83%B3%E3%82%B0%E3%81%AE%E3%83%9E%E3%83%8A%E3%83%BC%EF%BC%88%E3%83%99%E3%82%B9%E3%83%88%E3%83%97%E3%83%A9%E3%82%AF%E3%83%86%E3%82%A3%E3%82%B9%EF%BC%89","text":"3. スクレイピングのマナー（ベストプラクティス）","level":3,"children":[]},{"id":"4.-suumo%E3%81%A7%E3%82%B9%E3%82%AF%E3%83%AC%E3%82%A4%E3%83%94%E3%83%B3%E3%82%B0%E3%82%92%E8%A1%8C%E3%81%86%E9%9A%9B%E3%81%AE%E6%B3%A8%E6%84%8F","text":"4. SUUMOでスクレイピングを行う際の注意","level":3,"children":[]}]},{"id":"%E4%B8%BB%E8%A6%81%E3%81%AA%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88","text":"主要なコードのポイント","level":2,"children":[{"id":"1.-%E3%82%B9%E3%82%AF%E3%83%AC%E3%82%A4%E3%83%94%E3%83%B3%E3%82%B0%E5%87%A6%E7%90%86%EF%BC%88suumo.py%EF%BC%89","text":"1. スクレイピング処理（suumo.py）","level":3,"children":[]},{"id":"2.-selenium%E8%AA%8D%E8%A8%BC%E3%83%A2%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%AB%EF%BC%88auth.py%EF%BC%89","text":"2. Selenium認証モジュール（auth.py）","level":3,"children":[]},{"id":"3.-%E3%82%A8%E3%82%AF%E3%82%B9%E3%83%9D%E3%83%BC%E3%83%88%E5%87%A6%E7%90%86%EF%BC%88exporter.py%EF%BC%89","text":"3. エクスポート処理（exporter.py）","level":3,"children":[]},{"id":"4.-server-sent-events%EF%BC%88sse%EF%BC%89%E3%81%AB%E3%82%88%E3%82%8B%E9%80%B2%E6%8D%97%E8%A1%A8%E7%A4%BA","text":"4. Server-Sent Events（SSE）による進捗表示","level":3,"children":[]},{"id":"5.-%E3%82%B9%E3%82%AF%E3%83%AC%E3%82%A4%E3%83%94%E3%83%B3%E3%82%B0%E3%82%BF%E3%82%B9%E3%82%AF%E3%81%AE%E4%B8%A6%E5%88%97%E5%AE%9F%E8%A1%8C","text":"5. スクレイピングタスクの並列実行","level":3,"children":[]}]},{"id":"%E5%AE%9F%E8%A3%85%E3%81%A7%E5%B7%A5%E5%A4%AB%E3%81%97%E3%81%9F%E7%82%B9%E3%83%BB%E6%B3%A8%E6%84%8F%E7%82%B9","text":"実装で工夫した点・注意点","level":2,"children":[{"id":"%E3%82%B9%E3%82%AF%E3%83%AC%E3%82%A4%E3%83%94%E3%83%B3%E3%82%B0%E3%83%9E%E3%83%8A%E3%83%BC","text":"スクレイピングマナー","level":3,"children":[]},{"id":"%E3%82%A8%E3%83%A9%E3%83%BC%E3%83%8F%E3%83%B3%E3%83%89%E3%83%AA%E3%83%B3%E3%82%B0","text":"エラーハンドリング","level":3,"children":[]},{"id":"%E3%82%BF%E3%82%B9%E3%82%AF%E3%81%AE%E6%9C%89%E5%8A%B9%E6%9C%9F%E9%99%90%E7%AE%A1%E7%90%86","text":"タスクの有効期限管理","level":3,"children":[]}]},{"id":"%E3%81%BE%E3%81%A8%E3%82%81","text":"まとめ","level":2,"children":[{"id":"%E9%87%8D%E8%A6%81%E3%81%AA%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A0%85","text":"重要な注意事項","level":3,"children":[]}]}],"badges":[],"contest":null},"user":{"id":142660,"username":"yamato_snow","name":"やまと","avatarSmallUrl":"https://res.cloudinary.com/zenn/image/fetch/s--o8IQWmTU--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_70/https://storage.googleapis.com/zenn-user-upload/avatar/e1164c4a45.jpeg?_a=BACAGSGT","avatarUrl":"https://storage.googleapis.com/zenn-user-upload/avatar/e1164c4a45.jpeg","bio":"","autolinkedBio":"","githubUsername":"yamato-snow","twitterUsername":"keepmovelab","isSupportOpen":true,"tokusyoContact":null,"tokusyoName":null,"websiteUrl":"","websiteDomain":null,"totalLikedCount":487,"gaTrackingId":"G-YDV6ES0EM4","hatenaId":null,"isInvoiceIssuer":false,"awards":[{"eventSlug":"challenge2025","eventTitle":"2025年の最も大きなチャレンジ","eventType":"contest","prizeRank":"participant","prizeDisplayName":"参加賞","article":{"id":482763,"postType":"Article","slug":"260b3360354709","commentsCount":0,"likedCount":3,"bookmarkedCount":2,"bodyLettersCount":27841,"articleType":"idea","emoji":"🔒","isSuspendingPrivate":false,"publishedAt":"2025-11-15T17:39:21.177+09:00","bodyUpdatedAt":"2025-11-15T17:49:55.604+09:00","sourceRepoUpdatedAt":"2025-11-15T17:49:55.596+09:00","pinned":false,"path":"/yamato_snow/articles/260b3360354709","principalType":"User","title":"【社内SE向け】Claude Code for VS Codeは企業で使える?IPAガイドラインとセキュリティ仕様を徹底調査","user":{"id":142660,"username":"yamato_snow","name":"やまと","avatarSmallUrl":"https://res.cloudinary.com/zenn/image/fetch/s--o8IQWmTU--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_70/https://storage.googleapis.com/zenn-user-upload/avatar/e1164c4a45.jpeg?_a=BACAGSGT"},"publication":null,"publicationArticleOverride":null}}]},"topics":[{"id":38,"name":"flask","taggingsCount":348,"imageUrl":"https://storage.googleapis.com/zenn-user-upload/topics/dabd99d16d.png","displayName":"Flask"},{"id":95,"name":"python","taggingsCount":17063,"imageUrl":"https://storage.googleapis.com/zenn-user-upload/topics/ebddf7c6bb.png","displayName":"Python"},{"id":375,"name":"selenium","taggingsCount":265,"imageUrl":"https://storage.googleapis.com/zenn-user-upload/topics/990b70ad16.jpeg","displayName":"Selenium"},{"id":839,"name":"beautifulsoup","taggingsCount":35,"imageUrl":"https://storage.googleapis.com/zenn-user-upload/topics/0e1b3cc2ea.png","displayName":"Beautiful Soup"},{"id":1508,"name":"スクレイピング","taggingsCount":263,"imageUrl":"https://zenn.dev/images/topic.png","displayName":"スクレイピング"}],"isMine":false,"isPreview":false,"draftRevealScope":"private","githubRepository":null,"currentUserLiked":false,"currentUserBookmarked":false,"comments":[],"commentedUsers":[],"positiveCommentsCount":0,"publication":null,"publicationArticleOverride":null,"locale":null}},"page":"/[username]/articles/[slug]","query":{"username":"yamato_snow","slug":"00e11d435247b3"},"buildId":"yPO3E_Q3Qf6uqMxRigavH","assetPrefix":"https://static.zenn.studio","isFallback":false,"isExperimentalCompile":false,"dynamicIds":[63209],"gip":true,"scriptLoader":[]}</script><next-route-announcer><p aria-live="assertive" id="__next-route-announcer__" role="alert" style="border: 0px; clip: rect(0px, 0px, 0px, 0px); height: 1px; margin: -1px; overflow: hidden; padding: 0px; position: absolute; top: 0px; width: 1px; white-space: nowrap; overflow-wrap: normal;"></p></next-route-announcer><script src="./HowToscraping_files/77001-fdb71e7f2de72c30.js"></script><script src="./HowToscraping_files/[username]-3d574d6cf166e12c.js"></script><script src="./HowToscraping_files/[slug]-ab55b6f497bfd0c5.js"></script></body></html>